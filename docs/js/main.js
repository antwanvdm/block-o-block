!function(e){var t={};function s(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,s),r.l=!0,r.exports}s.m=e,s.c=t,s.d=function(e,t,i){s.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:i})},s.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s(s.s=1)}([function(e){e.exports={functionalities:{dataService:!0},dataService:{baseUrl:"https://api.mlab.com/api/1",apiKey:"X17utv1FH2dFTeUo4yhNGL54sA7CY2jS",databaseName:"typescript_scores",collectionName:"scores"}}},function(e,t,s){"use strict";s.r(t);class i{constructor(e,t,s,i=""){this.x=t,this.y=s,this.el=document.createElement("div");let r=document.getElementById("main");if(null===r)throw new Error("<main> element doesn't exist!");if(this.el.style.transform=`translate(${this.x}px, ${this.y}px)`,this.el.classList.add(e),""===i)r.appendChild(this.el);else{let e=document.querySelector(`.${i}`);if(null===e)throw new Error(`<.${i}> element doesn't exist!`);e.appendChild(this.el)}}getClientReact(){return this.el.getBoundingClientRect()}}class r extends i{constructor(){super("score",10,10,"gui"),this.score=0,this.el.innerHTML=`score: ${this.score.toString()}`}get(){return this.score}update(e,t=!1){this.score=t?e:this.score+e,this.el.innerHTML=`score: ${this.score.toString()}`}}class n{static addEventListener(e,t){n.functionMap[e]=t,window.addEventListener(e.split(".")[0],n.functionMap[e])}static removeEventListener(e){window.removeEventListener(e.split(".")[0],n.functionMap[e]),delete n.functionMap[e]}}n.functionMap={};class h extends i{constructor(){super("messagescreen",0,0,"gui"),this.height=200,this.width=400,this.isActive=!1,this.messages={"game:start":"Welcome to Block-o-Block, it's time to catch them blocks!<br/><br/>Use your arrow keys to move your player around and press space to start.","game:end":"You made it, your final score is __SCORE__ out of max __MAX_SCORE__ points.<br/><br/>Thanks for playing, press space to restart the madness","level:success":"YEAH! Level completed! Press space to proceed to the next level","level:failed":"AAH! Level failed! Press space to restart this level"},this.x=window.outerWidth/2-this.width/2,this.y=document.documentElement.clientHeight/2-this.height/2,this.el.style.width=`${this.width}px`,this.el.style.height=`${this.height}px`,this.el.style.transform=`translate(${this.x}px, ${this.y}px)`,this.show("game:start"),n.addEventListener("keyup.messagescreen",e=>this.keyBoardHandler(e))}keyBoardHandler(e){32===e.keyCode&&!0===this.isActive&&window.dispatchEvent(new Event(`${this.currentEvent}:click`))}show(e,t={}){let s=this.messages[e];for(let e in t)s=s.replace(e,t[e]);this.el.innerHTML=s,this.el.classList.add("show"),this.currentEvent=e,this.isActive=!0}hide(){this.el.classList.remove("show"),this.isActive=!1}}class o extends i{constructor(){super("gui",0,0),this.score=new r,this.messageScreen=new h,window.addEventListener("level:scoreUpdate",e=>this.score.update(e.detail.score))}levelDone(e){this.messageScreen.show(e)}newLevel(){this.messageScreen.hide()}gameEnd(e){this.messageScreen.show("game:end",{__SCORE__:this.score.get().toString(),__MAX_SCORE__:e.toString()})}restart(){this.messageScreen.show("game:start"),this.score.update(0,!0)}getScore(){return this.score.get()}}class a{static getRandomColor(){let e=Math.round,t=Math.random;return`rgba(${e(255*t())},${e(255*t())},${e(255*t())},1)`}static getRandomInt(e,t){return Math.floor(Math.random()*(t-e+1))+e}static checkCollision(e,t){return e.left<=t.right&&t.left<=e.right&&e.top<=t.bottom&&t.top<=e.bottom}}class l extends i{constructor(e,t,s,i){super("block",0,0,"level"),this.destination={x:0,y:0},this.speed=t,this.width=s,this.height=i,this.color=e,this.el.style.backgroundImage=`repeating-linear-gradient(${a.getRandomInt(0,360)}deg, #000000, #000000 ${a.getRandomInt(2,10)}px, ${this.color} 10px, ${this.color} ${a.getRandomInt(20,40)}px)`,this.el.style.width=`${this.width}px`,this.el.style.height=`${this.height}px`,this.x=a.getRandomInt(0,window.outerWidth-this.width),this.y=a.getRandomInt(0,document.documentElement.clientHeight-this.height),this.el.style.transform=`translate(${this.x}px, ${this.y}px)`}destroy(){this.el.remove()}update(){this.x>this.destination.x-this.speed&&this.x<this.destination.x+this.speed&&(this.destination.x=a.getRandomInt(0,window.outerWidth-this.width)),this.y>this.destination.y-this.speed&&this.y<this.destination.y+this.speed&&(this.destination.y=a.getRandomInt(0,document.documentElement.clientHeight-this.height)),this.destination.x>=this.x?this.x+=this.speed:this.x-=this.speed,this.destination.y>=this.y?this.y+=this.speed:this.y-=this.speed,this.el.style.transform=`translate(${this.x}px, ${this.y}px)`}}class d extends i{constructor(){super("player",0,0,"level"),this.height=10,this.width=10,this.growthFactor=1.5,this.speed=2,this.speedIncreaseFactor=.2,this.keysAllowed=[37,38,39,40],this.keysPressed=[],this.x=window.outerWidth/2-this.width/2,this.y=document.documentElement.clientHeight/2-this.height/2,this.el.style.width=`${this.width}px`,this.el.style.height=`${this.height}px`,this.el.style.borderRadius=`${this.width}px`,n.addEventListener("keydown.player",e=>this.keyDownHandler(e)),n.addEventListener("keyup.player",e=>this.keyUpHandler(e))}keyDownHandler(e){let t=e.keyCode;this.keysAllowed.indexOf(t)>-1&&-1===this.keysPressed.indexOf(t)&&this.keysPressed.push(t)}keyUpHandler(e){let t=e.keyCode,s=this.keysPressed.indexOf(t);this.keysAllowed.indexOf(t)>-1&&s>-1&&this.keysPressed.splice(s,1)}update(){this.keysPressed.forEach(e=>{switch(e){case 37:this.x-=this.speed;break;case 38:this.y-=this.speed;break;case 39:this.x+=this.speed;break;case 40:this.y+=this.speed;break;default:return}}),this.x<0&&(this.x=0),this.y<0&&(this.y=0),this.x>window.outerWidth-this.width&&(this.x=window.outerWidth-this.width),this.y>document.documentElement.clientHeight-this.height&&(this.y=document.documentElement.clientHeight-this.height),this.el.style.transform=`translate(${this.x}px, ${this.y}px)`}blockCaught(e){this.speed+=this.speedIncreaseFactor,this.width+=this.growthFactor,this.height+=this.growthFactor,this.el.style.height=`${this.height}px`,this.el.style.width=`${this.width}px`,this.el.style.borderRadius=`${this.width}px`,this.el.style.backgroundColor=e.color}destroy(){n.removeEventListener("keydown.player"),n.removeEventListener("keyup.player")}}class c extends i{constructor(){super("timer",10,40,"level"),this.seconds=10,this.el.innerHTML=`time: ${this.seconds}`,this.intervalId=setInterval(()=>this.update(),1e3)}update(){this.seconds--,this.el.innerHTML=`time: ${this.seconds}`,0===this.seconds&&window.dispatchEvent(new Event("timer:done"))}destroy(){clearInterval(this.intervalId)}}class p extends i{constructor(e,t){super("level",0,0),this.blocks=[],this.failed=!1,this.totalBlocks=e,this.scorePerBlock=t,this.player=new d,this.timer=new c;for(let e=0;e<this.totalBlocks;e++)this.blocks.push(new l(a.getRandomColor(),a.getRandomInt(1,5),a.getRandomInt(10,150),a.getRandomInt(10,150)));n.addEventListener("timer:done",()=>{this.failed=!0,this.destroy("level:failed")})}update(){this.player.update(),this.blocks.forEach((e,t)=>{e.update(),a.checkCollision(this.player.getClientReact(),e.getClientReact())&&!1===this.failed&&(this.player.blockCaught(e),e.destroy(),this.blocks.splice(t,1),window.dispatchEvent(new CustomEvent("level:scoreUpdate",{detail:{score:this.scorePerBlock}})),0===this.blocks.length&&this.destroy("level:success"))})}destroy(e){this.timer.destroy(),this.player.destroy(),this.blocks.forEach((e,t)=>{e.destroy(),this.blocks.splice(t,1)}),n.removeEventListener("timer:done"),window.dispatchEvent(new Event(e)),this.el.remove()}}var u=s(0);class m{constructor(){this.endPointList=`/databases/${u.dataService.databaseName}/collections/${u.dataService.collectionName}?apiKey=${u.dataService.apiKey}`,this.endPointSave=`/databases/${u.dataService.databaseName}/collections/${u.dataService.collectionName}?apiKey=${u.dataService.apiKey}`}saveScore(e){if(!1===u.functionalities.dataService)return this.disabled();let t=`${u.dataService.baseUrl}${this.endPointSave}`;return fetch(t,{body:JSON.stringify({score:e}),headers:{"content-type":"application/json"},method:"POST",mode:"cors"}).then(e=>e.json())}getScores(){if(!1===u.functionalities.dataService)return this.disabled();let e=`${u.dataService.baseUrl}${this.endPointList}`;return fetch(e,{mode:"cors"}).then(e=>e.json())}disabled(){return new Promise(e=>{e({error:"Dataservice is disabled"})})}}window.addEventListener("load",()=>new class{constructor(){this.levelsPerGame=10,this.currentLevelsPlayed=0,this.elementsPerLevel=5,this.elementsIncreasePerLevel=5,this.scorePerElement=10,this.gui=new o,this.maxScore=this.calculateMaxScore(),this.gameLoop(),this.dataService=new m,this.dataService.getScores().then(e=>{console.log("Current scores",e)}),["level:success","level:failed"].map(e=>{window.addEventListener(e,e=>this.update(e.type))}),["game:start:click","level:success:click","level:failed:click"].map(e=>{window.addEventListener(e,()=>this.startNewLevel())}),window.addEventListener("game:end:click",()=>this.restart())}calculateMaxScore(){let e=0;for(let t=0;t<this.levelsPerGame;t++)e+=(this.elementsPerLevel+(0===t?0:this.elementsIncreasePerLevel*t))*this.scorePerElement;return e}gameLoop(){void 0!==this.level&&this.level.update(),requestAnimationFrame(()=>this.gameLoop())}update(e){if(this.currentLevelsPlayed++,this.currentLevelsPlayed===this.levelsPerGame)return this.gui.gameEnd(this.maxScore),void this.saveScore();this.gui.levelDone(e)}startNewLevel(){this.level&&!1===this.level.failed&&(this.elementsPerLevel+=this.elementsIncreasePerLevel),delete this.level,this.gui.newLevel(),this.level=new p(this.elementsPerLevel,this.scorePerElement)}restart(){this.gui.restart(),this.currentLevelsPlayed=0,this.elementsPerLevel=5}saveScore(){let e=this.gui.getScore();this.dataService.saveScore(e).then(e=>{console.log("Response after saving score",e)})}})}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vZGV2L2hlbHBlcnMvZG9tZWxlbWVudC50cyIsIndlYnBhY2s6Ly8vLi9kZXYvZ3VpL3Njb3JlLnRzIiwid2VicGFjazovLy8uL2Rldi9oZWxwZXJzL3dpbmRvd2V2ZW50aGFuZGxlci50cyIsIndlYnBhY2s6Ly8vLi9kZXYvZ3VpL21lc3NhZ2VzY3JlZW4udHMiLCJ3ZWJwYWNrOi8vLy4vZGV2L2d1aS9ndWkudHMiLCJ3ZWJwYWNrOi8vLy4vZGV2L2hlbHBlcnMvdXRpbHMudHMiLCJ3ZWJwYWNrOi8vLy4vZGV2L2xldmVsL2Jsb2NrLnRzIiwid2VicGFjazovLy8uL2Rldi9sZXZlbC9wbGF5ZXIudHMiLCJ3ZWJwYWNrOi8vLy4vZGV2L2xldmVsL3RpbWVyLnRzIiwid2VicGFjazovLy8uL2Rldi9sZXZlbC9sZXZlbC50cyIsIndlYnBhY2s6Ly8vLi9kZXYvZGF0YXNlcnZpY2UudHMiLCJ3ZWJwYWNrOi8vLy4vZGV2L21haW4udHMiLCJ3ZWJwYWNrOi8vLy4vZGV2L2dhbWUudHMiXSwibmFtZXMiOlsiaW5zdGFsbGVkTW9kdWxlcyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImV4cG9ydHMiLCJtb2R1bGUiLCJpIiwibCIsIm1vZHVsZXMiLCJjYWxsIiwibSIsImMiLCJkIiwibmFtZSIsImdldHRlciIsIm8iLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImNvbmZpZ3VyYWJsZSIsImVudW1lcmFibGUiLCJnZXQiLCJyIiwidmFsdWUiLCJuIiwiX19lc01vZHVsZSIsIm9iamVjdCIsInByb3BlcnR5IiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJwIiwicyIsIkRvbUVsZW1lbnQiLCJbb2JqZWN0IE9iamVjdF0iLCJ0eXBlIiwieCIsInkiLCJwYXJlbnRDbGFzcyIsInRoaXMiLCJlbCIsImRvY3VtZW50IiwiY3JlYXRlRWxlbWVudCIsIm1haW4iLCJnZXRFbGVtZW50QnlJZCIsIkVycm9yIiwic3R5bGUiLCJ0cmFuc2Zvcm0iLCJjbGFzc0xpc3QiLCJhZGQiLCJhcHBlbmRDaGlsZCIsInBhcmVudEVsIiwicXVlcnlTZWxlY3RvciIsImdldEJvdW5kaW5nQ2xpZW50UmVjdCIsInNjb3JlX1Njb3JlIiwic3VwZXIiLCJzY29yZSIsImlubmVySFRNTCIsInRvU3RyaW5nIiwicmVzZXQiLCJXaW5kb3dFdmVudEhhbmRsZXIiLCJldmVudCIsImZ1bmMiLCJmdW5jdGlvbk1hcCIsIndpbmRvdyIsImFkZEV2ZW50TGlzdGVuZXIiLCJzcGxpdCIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJtZXNzYWdlc2NyZWVuX01lc3NhZ2VTY3JlZW4iLCJoZWlnaHQiLCJ3aWR0aCIsImlzQWN0aXZlIiwibWVzc2FnZXMiLCJnYW1lOnN0YXJ0IiwiZ2FtZTplbmQiLCJsZXZlbDpzdWNjZXNzIiwibGV2ZWw6ZmFpbGVkIiwib3V0ZXJXaWR0aCIsImRvY3VtZW50RWxlbWVudCIsImNsaWVudEhlaWdodCIsInNob3ciLCJlIiwia2V5Qm9hcmRIYW5kbGVyIiwia2V5Q29kZSIsImRpc3BhdGNoRXZlbnQiLCJFdmVudCIsImN1cnJlbnRFdmVudCIsInJlcGxhY2VtZW50cyIsIm1lc3NhZ2UiLCJyZXBsYWNlbWVudCIsInJlcGxhY2UiLCJyZW1vdmUiLCJndWlfR1VJIiwibWVzc2FnZVNjcmVlbiIsInVwZGF0ZSIsImRldGFpbCIsImhpZGUiLCJtYXhTY29yZSIsIl9fU0NPUkVfXyIsIl9fTUFYX1NDT1JFX18iLCJVdGlscyIsIk1hdGgiLCJyb3VuZCIsInJhbmRvbSIsIm1pbiIsIm1heCIsImZsb29yIiwiYSIsImIiLCJsZWZ0IiwicmlnaHQiLCJ0b3AiLCJib3R0b20iLCJibG9ja19CbG9jayIsImNvbG9yIiwic3BlZWQiLCJkZXN0aW5hdGlvbiIsImJhY2tncm91bmRJbWFnZSIsImdldFJhbmRvbUludCIsInBsYXllcl9QbGF5ZXIiLCJncm93dGhGYWN0b3IiLCJzcGVlZEluY3JlYXNlRmFjdG9yIiwia2V5c0FsbG93ZWQiLCJrZXlzUHJlc3NlZCIsImJvcmRlclJhZGl1cyIsImtleURvd25IYW5kbGVyIiwia2V5VXBIYW5kbGVyIiwia2V5IiwiaW5kZXhPZiIsInB1c2giLCJrZXlQcmVzc2VkUG9zaXRpb24iLCJzcGxpY2UiLCJmb3JFYWNoIiwiYmxvY2siLCJiYWNrZ3JvdW5kQ29sb3IiLCJ0aW1lcl9UaW1lciIsInNlY29uZHMiLCJpbnRlcnZhbElkIiwic2V0SW50ZXJ2YWwiLCJjbGVhckludGVydmFsIiwibGV2ZWxfTGV2ZWwiLCJ0b3RhbEJsb2NrcyIsInNjb3JlUGVyQmxvY2siLCJibG9ja3MiLCJmYWlsZWQiLCJwbGF5ZXIiLCJ0aW1lciIsImdldFJhbmRvbUNvbG9yIiwiZGVzdHJveSIsImluZGV4IiwiY2hlY2tDb2xsaXNpb24iLCJnZXRDbGllbnRSZWFjdCIsImJsb2NrQ2F1Z2h0IiwiQ3VzdG9tRXZlbnQiLCJsZW5ndGgiLCJldmVudFR5cGUiLCJkYXRhc2VydmljZV9EYXRhU2VydmljZSIsImVuZFBvaW50TGlzdCIsImNvbmZpZyIsImRhdGFTZXJ2aWNlIiwiZGF0YWJhc2VOYW1lIiwiY29sbGVjdGlvbk5hbWUiLCJhcGlLZXkiLCJlbmRQb2ludFNhdmUiLCJmdW5jdGlvbmFsaXRpZXMiLCJkaXNhYmxlZCIsInVybCIsImJhc2VVcmwiLCJmZXRjaCIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwiaGVhZGVycyIsImNvbnRlbnQtdHlwZSIsIm1ldGhvZCIsIm1vZGUiLCJ0aGVuIiwicmVzcG9uc2UiLCJqc29uIiwiUHJvbWlzZSIsInJlc29sdmUiLCJlcnJvciIsImxldmVsc1BlckdhbWUiLCJjdXJyZW50TGV2ZWxzUGxheWVkIiwiZWxlbWVudHNQZXJMZXZlbCIsImVsZW1lbnRzSW5jcmVhc2VQZXJMZXZlbCIsInNjb3JlUGVyRWxlbWVudCIsImd1aSIsImNhbGN1bGF0ZU1heFNjb3JlIiwiZ2FtZUxvb3AiLCJnZXRTY29yZXMiLCJkYXRhIiwiY29uc29sZSIsImxvZyIsIm1hcCIsInN0YXJ0TmV3TGV2ZWwiLCJyZXN0YXJ0IiwibGV2ZWwiLCJyZXF1ZXN0QW5pbWF0aW9uRnJhbWUiLCJnYW1lRW5kIiwic2F2ZVNjb3JlIiwibGV2ZWxEb25lIiwibmV3TGV2ZWwiLCJnZXRTY29yZSJdLCJtYXBwaW5ncyI6ImFBQ0EsSUFBQUEsS0FHQSxTQUFBQyxFQUFBQyxHQUdBLEdBQUFGLEVBQUFFLEdBQ0EsT0FBQUYsRUFBQUUsR0FBQUMsUUFHQSxJQUFBQyxFQUFBSixFQUFBRSxJQUNBRyxFQUFBSCxFQUNBSSxHQUFBLEVBQ0FILFlBVUEsT0FOQUksRUFBQUwsR0FBQU0sS0FBQUosRUFBQUQsUUFBQUMsSUFBQUQsUUFBQUYsR0FHQUcsRUFBQUUsR0FBQSxFQUdBRixFQUFBRCxRQUtBRixFQUFBUSxFQUFBRixFQUdBTixFQUFBUyxFQUFBVixFQUdBQyxFQUFBVSxFQUFBLFNBQUFSLEVBQUFTLEVBQUFDLEdBQ0FaLEVBQUFhLEVBQUFYLEVBQUFTLElBQ0FHLE9BQUFDLGVBQUFiLEVBQUFTLEdBQ0FLLGNBQUEsRUFDQUMsWUFBQSxFQUNBQyxJQUFBTixLQU1BWixFQUFBbUIsRUFBQSxTQUFBakIsR0FDQVksT0FBQUMsZUFBQWIsRUFBQSxjQUFpRGtCLE9BQUEsS0FJakRwQixFQUFBcUIsRUFBQSxTQUFBbEIsR0FDQSxJQUFBUyxFQUFBVCxLQUFBbUIsV0FDQSxXQUEyQixPQUFBbkIsRUFBQSxTQUMzQixXQUFpQyxPQUFBQSxHQUVqQyxPQURBSCxFQUFBVSxFQUFBRSxFQUFBLElBQUFBLEdBQ0FBLEdBSUFaLEVBQUFhLEVBQUEsU0FBQVUsRUFBQUMsR0FBc0QsT0FBQVYsT0FBQVcsVUFBQUMsZUFBQW5CLEtBQUFnQixFQUFBQyxJQUd0RHhCLEVBQUEyQixFQUFBLEdBSUEzQixJQUFBNEIsRUFBQSwrUENuRWNDLEVBS1ZDLFlBQVlDLEVBQWNDLEVBQVdDLEVBQVdDLEVBQXNCLElBQ2xFQyxLQUFLSCxFQUFJQSxFQUNURyxLQUFLRixFQUFJQSxFQUVURSxLQUFLQyxHQUFLQyxT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aUNBRzNCbEosS0FBSzhKLE1BQ1o5SixLQUFLb0osSUFBSWUsV0FFVG5LLEtBQUs4SixNQUFRLElBQUl6RCxFQUFNckcsS0FBS2lKLGlCQUFrQmpKLEtBQUttSixpQkFNL0N4SixVQUNKSyxLQUFLb0osSUFBSVMsVUFDVDdKLEtBQUtnSixvQkFBc0IsRUFDM0JoSixLQUFLaUosaUJBQW1CLEVBTXBCdEosWUFDSixJQUFJc0IsRUFBUWpCLEtBQUtvSixJQUFJZ0IsV0FDckJwSyxLQUFLd0gsWUFBWXlDLFVBQVVoSixHQUFPd0gsS0FBTWUsSUFDcENDLFFBQVFDLElBQUksOEJBQStCRiIsImZpbGUiOiJtYWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcblxuIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbiBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbiBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pIHtcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbiBcdFx0fVxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0aTogbW9kdWxlSWQsXG4gXHRcdFx0bDogZmFsc2UsXG4gXHRcdFx0ZXhwb3J0czoge31cbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubCA9IHRydWU7XG5cbiBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbiBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuIFx0fVxuXG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcblxuIFx0Ly8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHtcbiBcdFx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7XG4gXHRcdFx0XHRjb25maWd1cmFibGU6IGZhbHNlLFxuIFx0XHRcdFx0ZW51bWVyYWJsZTogdHJ1ZSxcbiBcdFx0XHRcdGdldDogZ2V0dGVyXG4gXHRcdFx0fSk7XG4gXHRcdH1cbiBcdH07XG5cbiBcdC8vIGRlZmluZSBfX2VzTW9kdWxlIG9uIGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uciA9IGZ1bmN0aW9uKGV4cG9ydHMpIHtcbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywgeyB2YWx1ZTogdHJ1ZSB9KTtcbiBcdH07XG5cbiBcdC8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSBmdW5jdGlvbihtb2R1bGUpIHtcbiBcdFx0dmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDpcbiBcdFx0XHRmdW5jdGlvbiBnZXRNb2R1bGVFeHBvcnRzKCkgeyByZXR1cm4gbW9kdWxlOyB9O1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCAnYScsIGdldHRlcik7XG4gXHRcdHJldHVybiBnZXR0ZXI7XG4gXHR9O1xuXG4gXHQvLyBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGxcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iamVjdCwgcHJvcGVydHkpIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KTsgfTtcblxuIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbiBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7XG5cblxuIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXyhfX3dlYnBhY2tfcmVxdWlyZV9fLnMgPSAxKTtcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIERvbUVsZW1lbnQge1xuICAgIHByb3RlY3RlZCBlbDogSFRNTEVsZW1lbnQ7XG4gICAgcHJvdGVjdGVkIHg6IG51bWJlcjtcbiAgICBwcm90ZWN0ZWQgeTogbnVtYmVyO1xuXG4gICAgY29uc3RydWN0b3IodHlwZTogc3RyaW5nLCB4OiBudW1iZXIsIHk6IG51bWJlciwgcGFyZW50Q2xhc3M6IHN0cmluZyA9ICcnKSB7XG4gICAgICAgIHRoaXMueCA9IHg7XG4gICAgICAgIHRoaXMueSA9IHk7XG5cbiAgICAgICAgdGhpcy5lbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICBsZXQgbWFpbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYWluJyk7XG4gICAgICAgIGlmIChtYWluID09PSBudWxsKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCI8bWFpbj4gZWxlbWVudCBkb2Vzbid0IGV4aXN0IVwiKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuZWwuc3R5bGUudHJhbnNmb3JtID0gYHRyYW5zbGF0ZSgke3RoaXMueH1weCwgJHt0aGlzLnl9cHgpYDtcbiAgICAgICAgdGhpcy5lbC5jbGFzc0xpc3QuYWRkKHR5cGUpO1xuXG4gICAgICAgIGlmIChwYXJlbnRDbGFzcyA9PT0gJycpIHtcbiAgICAgICAgICAgIG1haW4uYXBwZW5kQ2hpbGQodGhpcy5lbCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBsZXQgcGFyZW50RWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAuJHtwYXJlbnRDbGFzc31gKTtcbiAgICAgICAgICAgIGlmIChwYXJlbnRFbCA9PT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgPC4ke3BhcmVudENsYXNzfT4gZWxlbWVudCBkb2Vzbid0IGV4aXN0IWApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcGFyZW50RWwuYXBwZW5kQ2hpbGQodGhpcy5lbCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBAcmV0dXJucyBDbGllbnRSZWN0XG4gICAgICovXG4gICAgcHVibGljIGdldENsaWVudFJlYWN0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5lbC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICB9XG59XG4iLCJpbXBvcnQgRG9tRWxlbWVudCBmcm9tIFwiLi4vaGVscGVycy9kb21lbGVtZW50XCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFNjb3JlIGV4dGVuZHMgRG9tRWxlbWVudCB7XG4gICAgcHJpdmF0ZSBzY29yZTogbnVtYmVyID0gMDtcblxuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICBzdXBlcignc2NvcmUnLCAxMCwgMTAsICdndWknKTtcbiAgICAgICAgdGhpcy5lbC5pbm5lckhUTUwgPSBgc2NvcmU6ICR7dGhpcy5zY29yZS50b1N0cmluZygpfWA7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmV0cmlldmUgY3VycmVudCBzY29yZVxuICAgICAqXG4gICAgICogQHJldHVybnMge251bWJlcn1cbiAgICAgKi9cbiAgICBwdWJsaWMgZ2V0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5zY29yZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBVcGRhdGUgdGhlIHNjb3JlIGJhc2VkIG9uIGEgQ3VzdG9tIEV2ZW50IGZyb20gdGhlIEJsb2NrIG9iamVjdFxuICAgICAqXG4gICAgICogQHBhcmFtIHNjb3JlXG4gICAgICogQHBhcmFtIFtyZXNldF1cbiAgICAgKi9cbiAgICBwdWJsaWMgdXBkYXRlKHNjb3JlOiBudW1iZXIsIHJlc2V0OiBib29sZWFuID0gZmFsc2UpIHtcbiAgICAgICAgdGhpcy5zY29yZSA9IHJlc2V0ID8gc2NvcmUgOiB0aGlzLnNjb3JlICsgc2NvcmU7XG4gICAgICAgIHRoaXMuZWwuaW5uZXJIVE1MID0gYHNjb3JlOiAke3RoaXMuc2NvcmUudG9TdHJpbmcoKX1gO1xuICAgIH1cbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFdpbmRvd0V2ZW50SGFuZGxlciB7XG4gICAgcHJpdmF0ZSBzdGF0aWMgZnVuY3Rpb25NYXA6IHsgW2s6IHN0cmluZ106IGFueSB9ID0ge307XG5cbiAgICBwdWJsaWMgc3RhdGljIGFkZEV2ZW50TGlzdGVuZXIoZXZlbnQ6IHN0cmluZywgZnVuYzogYW55KSB7XG4gICAgICAgIFdpbmRvd0V2ZW50SGFuZGxlci5mdW5jdGlvbk1hcFtldmVudF0gPSBmdW5jO1xuICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihldmVudC5zcGxpdCgnLicpWzBdLCBXaW5kb3dFdmVudEhhbmRsZXIuZnVuY3Rpb25NYXBbZXZlbnRdKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgc3RhdGljIHJlbW92ZUV2ZW50TGlzdGVuZXIoZXZlbnQ6IHN0cmluZykge1xuICAgICAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcihldmVudC5zcGxpdCgnLicpWzBdLCBXaW5kb3dFdmVudEhhbmRsZXIuZnVuY3Rpb25NYXBbZXZlbnRdKTtcbiAgICAgICAgZGVsZXRlIFdpbmRvd0V2ZW50SGFuZGxlci5mdW5jdGlvbk1hcFtldmVudF07XG4gICAgfVxufVxuIiwiaW1wb3J0IERvbUVsZW1lbnQgZnJvbSBcIi4uL2hlbHBlcnMvZG9tZWxlbWVudFwiO1xuaW1wb3J0IFdpbmRvd0V2ZW50SGFuZGxlciBmcm9tIFwiLi4vaGVscGVycy93aW5kb3dldmVudGhhbmRsZXJcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgTWVzc2FnZVNjcmVlbiBleHRlbmRzIERvbUVsZW1lbnQge1xuICAgIHByaXZhdGUgaGVpZ2h0OiBudW1iZXIgPSAyMDA7XG4gICAgcHJpdmF0ZSB3aWR0aDogbnVtYmVyID0gNDAwO1xuICAgIHByaXZhdGUgY3VycmVudEV2ZW50ITogc3RyaW5nO1xuICAgIHByaXZhdGUgaXNBY3RpdmU6IGJvb2xlYW4gPSBmYWxzZTtcblxuICAgIHByaXZhdGUgbWVzc2FnZXM6IHsgW2s6IHN0cmluZ106IHN0cmluZyB9ID0ge1xuICAgICAgICAnZ2FtZTpzdGFydCc6ICdXZWxjb21lIHRvIEJsb2NrLW8tQmxvY2ssIGl0XFwncyB0aW1lIHRvIGNhdGNoIHRoZW0gYmxvY2tzITxici8+PGJyLz5Vc2UgeW91ciBhcnJvdyBrZXlzIHRvIG1vdmUgeW91ciBwbGF5ZXIgYXJvdW5kIGFuZCBwcmVzcyBzcGFjZSB0byBzdGFydC4nLFxuICAgICAgICAnZ2FtZTplbmQnOiAnWW91IG1hZGUgaXQsIHlvdXIgZmluYWwgc2NvcmUgaXMgX19TQ09SRV9fIG91dCBvZiBtYXggX19NQVhfU0NPUkVfXyBwb2ludHMuPGJyLz48YnIvPlRoYW5rcyBmb3IgcGxheWluZywgcHJlc3Mgc3BhY2UgdG8gcmVzdGFydCB0aGUgbWFkbmVzcycsXG4gICAgICAgICdsZXZlbDpzdWNjZXNzJzogJ1lFQUghIExldmVsIGNvbXBsZXRlZCEgUHJlc3Mgc3BhY2UgdG8gcHJvY2VlZCB0byB0aGUgbmV4dCBsZXZlbCcsXG4gICAgICAgICdsZXZlbDpmYWlsZWQnOiAnQUFIISBMZXZlbCBmYWlsZWQhIFByZXNzIHNwYWNlIHRvIHJlc3RhcnQgdGhpcyBsZXZlbCdcbiAgICB9O1xuXG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHN1cGVyKCdtZXNzYWdlc2NyZWVuJywgMCwgMCwgJ2d1aScpO1xuXG4gICAgICAgIHRoaXMueCA9IHdpbmRvdy5vdXRlcldpZHRoIC8gMiAtIHRoaXMud2lkdGggLyAyO1xuICAgICAgICB0aGlzLnkgPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50SGVpZ2h0IC8gMiAtIHRoaXMuaGVpZ2h0IC8gMjtcblxuICAgICAgICB0aGlzLmVsLnN0eWxlLndpZHRoID0gYCR7dGhpcy53aWR0aH1weGA7XG4gICAgICAgIHRoaXMuZWwuc3R5bGUuaGVpZ2h0ID0gYCR7dGhpcy5oZWlnaHR9cHhgO1xuICAgICAgICB0aGlzLmVsLnN0eWxlLnRyYW5zZm9ybSA9IGB0cmFuc2xhdGUoJHt0aGlzLnh9cHgsICR7dGhpcy55fXB4KWA7XG5cbiAgICAgICAgdGhpcy5zaG93KCdnYW1lOnN0YXJ0Jyk7XG4gICAgICAgIFdpbmRvd0V2ZW50SGFuZGxlci5hZGRFdmVudExpc3RlbmVyKCdrZXl1cC5tZXNzYWdlc2NyZWVuJywgKGU6IEtleWJvYXJkRXZlbnQpID0+IHRoaXMua2V5Qm9hcmRIYW5kbGVyKGUpKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBIYW5kbGUgdGhlIHNwYWNlYmFyXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge0tleWJvYXJkRXZlbnR9IGVcbiAgICAgKi9cbiAgICBrZXlCb2FyZEhhbmRsZXIoZTogS2V5Ym9hcmRFdmVudCkge1xuICAgICAgICBpZiAoZS5rZXlDb2RlID09PSAzMiAmJiB0aGlzLmlzQWN0aXZlID09PSB0cnVlKSB7XG4gICAgICAgICAgICB3aW5kb3cuZGlzcGF0Y2hFdmVudChuZXcgRXZlbnQoYCR7dGhpcy5jdXJyZW50RXZlbnR9OmNsaWNrYCkpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU2hvdyB0aGUgZGVzaXJlZCBtZXNzYWdlICh0eXBlIG1hdGNoZXMgaW5kZXggaW4gb2JqZWN0KVxuICAgICAqXG4gICAgICogQHBhcmFtIHR5cGVcbiAgICAgKiBAcGFyYW0gW3JlcGxhY2VtZW50c11cbiAgICAgKi9cbiAgICBwdWJsaWMgc2hvdyh0eXBlOiBzdHJpbmcsIHJlcGxhY2VtZW50czogeyBbazogc3RyaW5nXTogc3RyaW5nIH0gPSB7fSkge1xuICAgICAgICBsZXQgbWVzc2FnZSA9IHRoaXMubWVzc2FnZXNbdHlwZV07XG4gICAgICAgIGZvciAobGV0IHJlcGxhY2VtZW50IGluIHJlcGxhY2VtZW50cykge1xuICAgICAgICAgICAgbWVzc2FnZSA9IG1lc3NhZ2UucmVwbGFjZShyZXBsYWNlbWVudCwgcmVwbGFjZW1lbnRzW3JlcGxhY2VtZW50XSk7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLmVsLmlubmVySFRNTCA9IG1lc3NhZ2U7XG4gICAgICAgIHRoaXMuZWwuY2xhc3NMaXN0LmFkZCgnc2hvdycpO1xuICAgICAgICB0aGlzLmN1cnJlbnRFdmVudCA9IHR5cGU7XG4gICAgICAgIHRoaXMuaXNBY3RpdmUgPSB0cnVlO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEhpZGUgbWVzc2FnZSBvbiBzY3JlZW5cbiAgICAgKi9cbiAgICBwdWJsaWMgaGlkZSgpIHtcbiAgICAgICAgdGhpcy5lbC5jbGFzc0xpc3QucmVtb3ZlKCdzaG93Jyk7XG4gICAgICAgIHRoaXMuaXNBY3RpdmUgPSBmYWxzZTtcbiAgICB9XG59XG4iLCJpbXBvcnQgU2NvcmUgZnJvbSAnLi9zY29yZSc7XG5pbXBvcnQgTWVzc2FnZVNjcmVlbiBmcm9tICcuL21lc3NhZ2VzY3JlZW4nO1xuaW1wb3J0IERvbUVsZW1lbnQgZnJvbSBcIi4uL2hlbHBlcnMvZG9tZWxlbWVudFwiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBHVUkgZXh0ZW5kcyBEb21FbGVtZW50IHtcbiAgICBwcml2YXRlIHNjb3JlOiBTY29yZTtcbiAgICBwcml2YXRlIG1lc3NhZ2VTY3JlZW46IE1lc3NhZ2VTY3JlZW47XG5cbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgc3VwZXIoJ2d1aScsIDAsIDApO1xuXG4gICAgICAgIHRoaXMuc2NvcmUgPSBuZXcgU2NvcmUoKTtcbiAgICAgICAgdGhpcy5tZXNzYWdlU2NyZWVuID0gbmV3IE1lc3NhZ2VTY3JlZW4oKTtcblxuICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignbGV2ZWw6c2NvcmVVcGRhdGUnLCAoZSkgPT4gdGhpcy5zY29yZS51cGRhdGUoKGUgYXMgQ3VzdG9tRXZlbnQpLmRldGFpbC5zY29yZSkpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRyaWdnZXJlZCB3aGVuIGEgbGV2ZWwgaXMgZG9uZVxuICAgICAqXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHR5cGVcbiAgICAgKi9cbiAgICBwdWJsaWMgbGV2ZWxEb25lKHR5cGU6IHN0cmluZykge1xuICAgICAgICB0aGlzLm1lc3NhZ2VTY3JlZW4uc2hvdyh0eXBlKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUcmlnZ2VyZWQgd2hlbiBhIG5ldyBsZXZlbCBzdGFydHNcbiAgICAgKi9cbiAgICBwdWJsaWMgbmV3TGV2ZWwoKSB7XG4gICAgICAgIHRoaXMubWVzc2FnZVNjcmVlbi5oaWRlKCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVHJpZ2dlcmVkIHdoZW4gdGhlIGdhbWUgaXMgZG9uZVxuICAgICAqXG4gICAgICogQHBhcmFtIG1heFNjb3JlXG4gICAgICovXG4gICAgcHVibGljIGdhbWVFbmQobWF4U2NvcmU6IG51bWJlcikge1xuICAgICAgICB0aGlzLm1lc3NhZ2VTY3JlZW4uc2hvdygnZ2FtZTplbmQnLCB7XG4gICAgICAgICAgICAnX19TQ09SRV9fJzogdGhpcy5zY29yZS5nZXQoKS50b1N0cmluZygpLFxuICAgICAgICAgICAgJ19fTUFYX1NDT1JFX18nOiBtYXhTY29yZS50b1N0cmluZygpXG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRyaWdnZXJlZCB3aGVuIHdlIG5lZWQgdG8gcmVzdGFydCwgZ28gdG8gZmlyc3Qgc2NyZWVuIGFuZCBzZXQgc2NvcmUgdG8gMFxuICAgICAqL1xuICAgIHB1YmxpYyByZXN0YXJ0KCkge1xuICAgICAgICB0aGlzLm1lc3NhZ2VTY3JlZW4uc2hvdygnZ2FtZTpzdGFydCcpO1xuICAgICAgICB0aGlzLnNjb3JlLnVwZGF0ZSgwLCB0cnVlKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBAcmV0dXJucyB7bnVtYmVyfVxuICAgICAqL1xuICAgIHB1YmxpYyBnZXRTY29yZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc2NvcmUuZ2V0KCk7XG4gICAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgVXRpbHMge1xuICAgIHN0YXRpYyBnZXRSYW5kb21Db2xvcigpIHtcbiAgICAgICAgbGV0IG8gPSBNYXRoLnJvdW5kLCByID0gTWF0aC5yYW5kb20sIHMgPSAyNTU7XG4gICAgICAgIHJldHVybiBgcmdiYSgke28ocigpICogcyl9LCR7byhyKCkgKiBzKX0sJHtvKHIoKSAqIHMpfSwxKWA7XG4gICAgfVxuXG4gICAgc3RhdGljIGdldFJhbmRvbUludChtaW46IG51bWJlciwgbWF4OiBudW1iZXIpIHtcbiAgICAgICAgcmV0dXJuIE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIChtYXggLSBtaW4gKyAxKSkgKyBtaW47XG4gICAgfVxuXG4gICAgc3RhdGljIGNoZWNrQ29sbGlzaW9uKGE6IENsaWVudFJlY3QsIGI6IENsaWVudFJlY3QpIHtcbiAgICAgICAgcmV0dXJuIChhLmxlZnQgPD0gYi5yaWdodCAmJlxuICAgICAgICAgICAgYi5sZWZ0IDw9IGEucmlnaHQgJiZcbiAgICAgICAgICAgIGEudG9wIDw9IGIuYm90dG9tICYmXG4gICAgICAgICAgICBiLnRvcCA8PSBhLmJvdHRvbSk7XG4gICAgfVxufVxuIiwiaW1wb3J0IERvbUVsZW1lbnQgZnJvbSBcIi4uL2hlbHBlcnMvZG9tZWxlbWVudFwiO1xuaW1wb3J0IFV0aWxzIGZyb20gXCIuLi9oZWxwZXJzL3V0aWxzXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEJsb2NrIGV4dGVuZHMgRG9tRWxlbWVudCB7XG4gICAgcHJpdmF0ZSByZWFkb25seSBzcGVlZDogbnVtYmVyO1xuICAgIHByaXZhdGUgcmVhZG9ubHkgd2lkdGg6IG51bWJlcjtcbiAgICBwcml2YXRlIHJlYWRvbmx5IGhlaWdodDogbnVtYmVyO1xuICAgIHB1YmxpYyBjb2xvcjogc3RyaW5nO1xuICAgIHByaXZhdGUgZGVzdGluYXRpb24gPSB7eDogMCwgeTogMH07XG5cbiAgICBjb25zdHJ1Y3Rvcihjb2xvcjogc3RyaW5nLCBzcGVlZDogbnVtYmVyLCB3aWR0aDogbnVtYmVyLCBoZWlnaHQ6IG51bWJlcikge1xuICAgICAgICBzdXBlcignYmxvY2snLCAwLCAwLCAnbGV2ZWwnKTtcblxuICAgICAgICB0aGlzLnNwZWVkID0gc3BlZWQ7XG4gICAgICAgIHRoaXMud2lkdGggPSB3aWR0aDtcbiAgICAgICAgdGhpcy5oZWlnaHQgPSBoZWlnaHQ7XG4gICAgICAgIHRoaXMuY29sb3IgPSBjb2xvcjtcblxuICAgICAgICB0aGlzLmVsLnN0eWxlLmJhY2tncm91bmRJbWFnZSA9IGByZXBlYXRpbmctbGluZWFyLWdyYWRpZW50KCR7VXRpbHMuZ2V0UmFuZG9tSW50KDAsMzYwKX1kZWcsICMwMDAwMDAsICMwMDAwMDAgJHtVdGlscy5nZXRSYW5kb21JbnQoMiwxMCl9cHgsICR7dGhpcy5jb2xvcn0gMTBweCwgJHt0aGlzLmNvbG9yfSAke1V0aWxzLmdldFJhbmRvbUludCgyMCw0MCl9cHgpYDtcbiAgICAgICAgdGhpcy5lbC5zdHlsZS53aWR0aCA9IGAke3RoaXMud2lkdGh9cHhgO1xuICAgICAgICB0aGlzLmVsLnN0eWxlLmhlaWdodCA9IGAke3RoaXMuaGVpZ2h0fXB4YDtcblxuICAgICAgICB0aGlzLnggPSBVdGlscy5nZXRSYW5kb21JbnQoMCwgKHdpbmRvdy5vdXRlcldpZHRoIC0gdGhpcy53aWR0aCkpO1xuICAgICAgICB0aGlzLnkgPSBVdGlscy5nZXRSYW5kb21JbnQoMCwgKGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRIZWlnaHQgLSB0aGlzLmhlaWdodCkpO1xuICAgICAgICB0aGlzLmVsLnN0eWxlLnRyYW5zZm9ybSA9IGB0cmFuc2xhdGUoJHt0aGlzLnh9cHgsICR7dGhpcy55fXB4KWA7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogSGFuZGxlciBmb3IgY2xpY2tpbmcgdGhlIGJsb2Nrc1xuICAgICAqL1xuICAgIHB1YmxpYyBkZXN0cm95KCkge1xuICAgICAgICB0aGlzLmVsLnJlbW92ZSgpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIE1haW4gdXBkYXRlIGhhbmRsZXIgZm9yIHRoZSBnYW1lIGZvciBtb3Zpbmcgb3VyIGJsb2NrIHJhbmRvbWx5IG92ZXIgdGhlIHNjcmVlblxuICAgICAqL1xuICAgIHB1YmxpYyB1cGRhdGUoKSB7XG4gICAgICAgIGlmICh0aGlzLnggPiAodGhpcy5kZXN0aW5hdGlvbi54IC0gdGhpcy5zcGVlZCkgJiYgdGhpcy54IDwgKHRoaXMuZGVzdGluYXRpb24ueCArIHRoaXMuc3BlZWQpKSB7XG4gICAgICAgICAgICB0aGlzLmRlc3RpbmF0aW9uLnggPSBVdGlscy5nZXRSYW5kb21JbnQoMCwgKHdpbmRvdy5vdXRlcldpZHRoIC0gdGhpcy53aWR0aCkpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnkgPiAodGhpcy5kZXN0aW5hdGlvbi55IC0gdGhpcy5zcGVlZCkgJiYgdGhpcy55IDwgKHRoaXMuZGVzdGluYXRpb24ueSArIHRoaXMuc3BlZWQpKSB7XG4gICAgICAgICAgICB0aGlzLmRlc3RpbmF0aW9uLnkgPSBVdGlscy5nZXRSYW5kb21JbnQoMCwgKGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRIZWlnaHQgLSB0aGlzLmhlaWdodCkpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHRoaXMuZGVzdGluYXRpb24ueCA+PSB0aGlzLngpIHtcbiAgICAgICAgICAgIHRoaXMueCArPSB0aGlzLnNwZWVkO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy54IC09IHRoaXMuc3BlZWQ7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGhpcy5kZXN0aW5hdGlvbi55ID49IHRoaXMueSkge1xuICAgICAgICAgICAgdGhpcy55ICs9IHRoaXMuc3BlZWQ7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnkgLT0gdGhpcy5zcGVlZDtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuZWwuc3R5bGUudHJhbnNmb3JtID0gYHRyYW5zbGF0ZSgke3RoaXMueH1weCwgJHt0aGlzLnl9cHgpYDtcbiAgICB9XG59XG4iLCJpbXBvcnQgRG9tRWxlbWVudCBmcm9tIFwiLi4vaGVscGVycy9kb21lbGVtZW50XCI7XG5pbXBvcnQgQmxvY2sgZnJvbSBcIi4vYmxvY2tcIjtcbmltcG9ydCBXaW5kb3dFdmVudEhhbmRsZXIgZnJvbSBcIi4uL2hlbHBlcnMvd2luZG93ZXZlbnRoYW5kbGVyXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBsYXllciBleHRlbmRzIERvbUVsZW1lbnQge1xuICAgIHByaXZhdGUgaGVpZ2h0OiBudW1iZXIgPSAxMDtcbiAgICBwcml2YXRlIHdpZHRoOiBudW1iZXIgPSAxMDtcbiAgICBwcml2YXRlIGdyb3d0aEZhY3RvcjogbnVtYmVyID0gMS41O1xuICAgIHByaXZhdGUgc3BlZWQ6IG51bWJlciA9IDI7XG4gICAgcHJpdmF0ZSBzcGVlZEluY3JlYXNlRmFjdG9yOiBudW1iZXIgPSAwLjI7XG4gICAgcHJpdmF0ZSBrZXlzQWxsb3dlZDogbnVtYmVyW10gPSBbMzcsIDM4LCAzOSwgNDBdO1xuICAgIHByaXZhdGUga2V5c1ByZXNzZWQ6IG51bWJlcltdID0gW107XG5cbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgc3VwZXIoJ3BsYXllcicsIDAsIDAsICdsZXZlbCcpO1xuICAgICAgICB0aGlzLnggPSB3aW5kb3cub3V0ZXJXaWR0aCAvIDIgLSB0aGlzLndpZHRoIC8gMjtcbiAgICAgICAgdGhpcy55ID0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudEhlaWdodCAvIDIgLSB0aGlzLmhlaWdodCAvIDI7XG5cbiAgICAgICAgdGhpcy5lbC5zdHlsZS53aWR0aCA9IGAke3RoaXMud2lkdGh9cHhgO1xuICAgICAgICB0aGlzLmVsLnN0eWxlLmhlaWdodCA9IGAke3RoaXMuaGVpZ2h0fXB4YDtcbiAgICAgICAgdGhpcy5lbC5zdHlsZS5ib3JkZXJSYWRpdXMgPSBgJHt0aGlzLndpZHRofXB4YDtcblxuICAgICAgICBXaW5kb3dFdmVudEhhbmRsZXIuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bi5wbGF5ZXInLCAoZTogS2V5Ym9hcmRFdmVudCkgPT4gdGhpcy5rZXlEb3duSGFuZGxlcihlKSk7XG4gICAgICAgIFdpbmRvd0V2ZW50SGFuZGxlci5hZGRFdmVudExpc3RlbmVyKCdrZXl1cC5wbGF5ZXInLCAoZTogS2V5Ym9hcmRFdmVudCkgPT4gdGhpcy5rZXlVcEhhbmRsZXIoZSkpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEtleSBkb3duIGhhbmRsZXIgZm9yIG1vdmluZyB0aGUgcGxheWVyXG4gICAgICpcbiAgICAgKiBAcGFyYW0gZVxuICAgICAqL1xuICAgIHByaXZhdGUga2V5RG93bkhhbmRsZXIoZTogS2V5Ym9hcmRFdmVudCkge1xuICAgICAgICBsZXQga2V5ID0gZS5rZXlDb2RlO1xuICAgICAgICBpZiAodGhpcy5rZXlzQWxsb3dlZC5pbmRleE9mKGtleSkgPiAtMSAmJiB0aGlzLmtleXNQcmVzc2VkLmluZGV4T2Yoa2V5KSA9PT0gLTEpIHtcbiAgICAgICAgICAgIHRoaXMua2V5c1ByZXNzZWQucHVzaChrZXkpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogS2V5IGRvd24gaGFuZGxlciBmb3IgbW92aW5nIHRoZSBwbGF5ZXJcbiAgICAgKlxuICAgICAqIEBwYXJhbSBlXG4gICAgICovXG4gICAgcHJpdmF0ZSBrZXlVcEhhbmRsZXIoZTogS2V5Ym9hcmRFdmVudCkge1xuICAgICAgICBsZXQga2V5ID0gZS5rZXlDb2RlO1xuICAgICAgICBsZXQga2V5UHJlc3NlZFBvc2l0aW9uID0gdGhpcy5rZXlzUHJlc3NlZC5pbmRleE9mKGtleSk7XG4gICAgICAgIGlmICh0aGlzLmtleXNBbGxvd2VkLmluZGV4T2Yoa2V5KSA+IC0xICYmIGtleVByZXNzZWRQb3NpdGlvbiA+IC0xKSB7XG4gICAgICAgICAgICB0aGlzLmtleXNQcmVzc2VkLnNwbGljZShrZXlQcmVzc2VkUG9zaXRpb24sIDEpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVXBkYXRlIHRoZSBhY3R1YWwgcG9zaXRpb24gYmFzZWQgb24gZWFybGllciBldmVudHNcbiAgICAgKi9cbiAgICBwdWJsaWMgdXBkYXRlKCkge1xuICAgICAgICB0aGlzLmtleXNQcmVzc2VkLmZvckVhY2goKGtleSkgPT4ge1xuICAgICAgICAgICAgc3dpdGNoIChrZXkpIHtcbiAgICAgICAgICAgICAgICBjYXNlIDM3OlxuICAgICAgICAgICAgICAgICAgICB0aGlzLnggLT0gdGhpcy5zcGVlZDtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICBjYXNlIDM4OlxuICAgICAgICAgICAgICAgICAgICB0aGlzLnkgLT0gdGhpcy5zcGVlZDtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICBjYXNlIDM5OlxuICAgICAgICAgICAgICAgICAgICB0aGlzLnggKz0gdGhpcy5zcGVlZDtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICBjYXNlIDQwOlxuICAgICAgICAgICAgICAgICAgICB0aGlzLnkgKz0gdGhpcy5zcGVlZDtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vQ2hlY2tzIHRvIHN0YXkgaW4gYm91bmRzXG4gICAgICAgIGlmICh0aGlzLnggPCAwKSB7XG4gICAgICAgICAgICB0aGlzLnggPSAwO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnkgPCAwKSB7XG4gICAgICAgICAgICB0aGlzLnkgPSAwO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnggPiAod2luZG93Lm91dGVyV2lkdGggLSB0aGlzLndpZHRoKSkge1xuICAgICAgICAgICAgdGhpcy54ID0gKHdpbmRvdy5vdXRlcldpZHRoIC0gdGhpcy53aWR0aCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMueSA+IChkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50SGVpZ2h0IC0gdGhpcy5oZWlnaHQpKSB7XG4gICAgICAgICAgICB0aGlzLnkgPSAoZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudEhlaWdodCAtIHRoaXMuaGVpZ2h0KTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuZWwuc3R5bGUudHJhbnNmb3JtID0gYHRyYW5zbGF0ZSgke3RoaXMueH1weCwgJHt0aGlzLnl9cHgpYDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBVcGRhdGUgcGxheWVyIHdoZW4gYSBibG9jayBnb3QgY2F1Z2h0XG4gICAgICpcbiAgICAgKiBAcGFyYW0gYmxvY2tcbiAgICAgKi9cbiAgICBwdWJsaWMgYmxvY2tDYXVnaHQoYmxvY2s6IEJsb2NrKSB7XG4gICAgICAgIHRoaXMuc3BlZWQgKz0gdGhpcy5zcGVlZEluY3JlYXNlRmFjdG9yO1xuICAgICAgICB0aGlzLndpZHRoICs9IHRoaXMuZ3Jvd3RoRmFjdG9yO1xuICAgICAgICB0aGlzLmhlaWdodCArPSB0aGlzLmdyb3d0aEZhY3RvcjtcblxuICAgICAgICB0aGlzLmVsLnN0eWxlLmhlaWdodCA9IGAke3RoaXMuaGVpZ2h0fXB4YDtcbiAgICAgICAgdGhpcy5lbC5zdHlsZS53aWR0aCA9IGAke3RoaXMud2lkdGh9cHhgO1xuICAgICAgICB0aGlzLmVsLnN0eWxlLmJvcmRlclJhZGl1cyA9IGAke3RoaXMud2lkdGh9cHhgO1xuICAgICAgICB0aGlzLmVsLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IGJsb2NrLmNvbG9yO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENsZWFuIHVwIVxuICAgICAqL1xuICAgIHB1YmxpYyBkZXN0cm95KCkge1xuICAgICAgICBXaW5kb3dFdmVudEhhbmRsZXIucmVtb3ZlRXZlbnRMaXN0ZW5lcigna2V5ZG93bi5wbGF5ZXInKTtcbiAgICAgICAgV2luZG93RXZlbnRIYW5kbGVyLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2tleXVwLnBsYXllcicpO1xuICAgIH1cbn1cbiIsImltcG9ydCBEb21FbGVtZW50IGZyb20gXCIuLi9oZWxwZXJzL2RvbWVsZW1lbnRcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgVGltZXIgZXh0ZW5kcyBEb21FbGVtZW50IHtcbiAgICBzZWNvbmRzOiBudW1iZXIgPSAxMDtcbiAgICBpbnRlcnZhbElkOiBudW1iZXI7XG5cbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgc3VwZXIoJ3RpbWVyJywgMTAsIDQwLCAnbGV2ZWwnKTtcbiAgICAgICAgdGhpcy5lbC5pbm5lckhUTUwgPSBgdGltZTogJHt0aGlzLnNlY29uZHN9YDtcblxuICAgICAgICB0aGlzLmludGVydmFsSWQgPSBzZXRJbnRlcnZhbCgoKSA9PiB0aGlzLnVwZGF0ZSgpLCAxMDAwKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDb3VudGRvd24gb2Ygc2Vjb25kc1xuICAgICAqL1xuICAgIHByaXZhdGUgdXBkYXRlKCkge1xuICAgICAgICB0aGlzLnNlY29uZHMtLTtcbiAgICAgICAgdGhpcy5lbC5pbm5lckhUTUwgPSBgdGltZTogJHt0aGlzLnNlY29uZHN9YDtcblxuICAgICAgICBpZiAodGhpcy5zZWNvbmRzID09PSAwKSB7XG4gICAgICAgICAgICB3aW5kb3cuZGlzcGF0Y2hFdmVudChuZXcgRXZlbnQoJ3RpbWVyOmRvbmUnKSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwdWJsaWMgZGVzdHJveSgpIHtcbiAgICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLmludGVydmFsSWQpO1xuICAgIH1cbn1cbiIsImltcG9ydCBEb21FbGVtZW50IGZyb20gXCIuLi9oZWxwZXJzL2RvbWVsZW1lbnRcIjtcbmltcG9ydCBCbG9jayBmcm9tIFwiLi9ibG9ja1wiO1xuaW1wb3J0IFBsYXllciBmcm9tIFwiLi9wbGF5ZXJcIjtcbmltcG9ydCBUaW1lciBmcm9tIFwiLi90aW1lclwiO1xuaW1wb3J0IFV0aWxzIGZyb20gXCIuLi9oZWxwZXJzL3V0aWxzXCI7XG5pbXBvcnQgV2luZG93RXZlbnRIYW5kbGVyIGZyb20gXCIuLi9oZWxwZXJzL3dpbmRvd2V2ZW50aGFuZGxlclwiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBMZXZlbCBleHRlbmRzIERvbUVsZW1lbnQge1xuICAgIHByaXZhdGUgcmVhZG9ubHkgdG90YWxCbG9ja3M6IG51bWJlcjtcbiAgICBwcml2YXRlIHJlYWRvbmx5IHNjb3JlUGVyQmxvY2s6IG51bWJlcjtcbiAgICBwcml2YXRlIGJsb2NrczogQmxvY2tbXSA9IFtdO1xuICAgIHByaXZhdGUgcGxheWVyOiBQbGF5ZXI7XG4gICAgcHJpdmF0ZSB0aW1lcjogVGltZXI7XG4gICAgcHVibGljIGZhaWxlZCA9IGZhbHNlO1xuXG4gICAgY29uc3RydWN0b3IodG90YWxCbG9ja3M6IG51bWJlciwgc2NvcmVQZXJCbG9jazogbnVtYmVyKSB7XG4gICAgICAgIHN1cGVyKCdsZXZlbCcsIDAsIDApO1xuXG4gICAgICAgIHRoaXMudG90YWxCbG9ja3MgPSB0b3RhbEJsb2NrcztcbiAgICAgICAgdGhpcy5zY29yZVBlckJsb2NrID0gc2NvcmVQZXJCbG9jaztcbiAgICAgICAgdGhpcy5wbGF5ZXIgPSBuZXcgUGxheWVyKCk7XG4gICAgICAgIHRoaXMudGltZXIgPSBuZXcgVGltZXIoKTtcblxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMudG90YWxCbG9ja3M7IGkrKykge1xuICAgICAgICAgICAgdGhpcy5ibG9ja3MucHVzaChuZXcgQmxvY2soVXRpbHMuZ2V0UmFuZG9tQ29sb3IoKSwgVXRpbHMuZ2V0UmFuZG9tSW50KDEsIDUpLCBVdGlscy5nZXRSYW5kb21JbnQoMTAsIDE1MCksIFV0aWxzLmdldFJhbmRvbUludCgxMCwgMTUwKSkpO1xuICAgICAgICB9XG5cbiAgICAgICAgV2luZG93RXZlbnRIYW5kbGVyLmFkZEV2ZW50TGlzdGVuZXIoJ3RpbWVyOmRvbmUnLCAoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmZhaWxlZCA9IHRydWU7XG4gICAgICAgICAgICB0aGlzLmRlc3Ryb3koJ2xldmVsOmZhaWxlZCcpO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDaGVja3MgZm9yIGNvbGxpc2lvbiBhbmQgcG90ZW50aWFsIHN1Y2Nlc3Mgb2YgdGhpcyBsZXZlbFxuICAgICAqL1xuICAgIHB1YmxpYyB1cGRhdGUoKSB7XG4gICAgICAgIHRoaXMucGxheWVyLnVwZGF0ZSgpO1xuICAgICAgICB0aGlzLmJsb2Nrcy5mb3JFYWNoKChibG9jaywgaW5kZXgpID0+IHtcbiAgICAgICAgICAgIGJsb2NrLnVwZGF0ZSgpO1xuXG4gICAgICAgICAgICBpZiAoVXRpbHMuY2hlY2tDb2xsaXNpb24odGhpcy5wbGF5ZXIuZ2V0Q2xpZW50UmVhY3QoKSwgYmxvY2suZ2V0Q2xpZW50UmVhY3QoKSkgJiYgdGhpcy5mYWlsZWQgPT09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wbGF5ZXIuYmxvY2tDYXVnaHQoYmxvY2spO1xuICAgICAgICAgICAgICAgIGJsb2NrLmRlc3Ryb3koKTtcbiAgICAgICAgICAgICAgICB0aGlzLmJsb2Nrcy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICAgICAgICAgIHdpbmRvdy5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgnbGV2ZWw6c2NvcmVVcGRhdGUnLCB7ZGV0YWlsOiB7c2NvcmU6IHRoaXMuc2NvcmVQZXJCbG9ja319KSk7XG5cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5ibG9ja3MubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZGVzdHJveSgnbGV2ZWw6c3VjY2VzcycpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRGVzdHJveSBvYmplY3QgJiB0aW1lciBhbmQgdHJpZ2dlciBldmVudCB0byBub3RpZnkgdGhlIHdvcmxkIGFib3V0IHRoZSBzdGF0dXMgb2YgdGhpcyBsZXZlbFxuICAgICAqXG4gICAgICogQHBhcmFtIGV2ZW50VHlwZVxuICAgICAqL1xuICAgIHByaXZhdGUgZGVzdHJveShldmVudFR5cGU6IHN0cmluZykge1xuICAgICAgICB0aGlzLnRpbWVyLmRlc3Ryb3koKTtcbiAgICAgICAgdGhpcy5wbGF5ZXIuZGVzdHJveSgpO1xuICAgICAgICB0aGlzLmJsb2Nrcy5mb3JFYWNoKChibG9jaywgaW5kZXgpID0+IHtcbiAgICAgICAgICAgIGJsb2NrLmRlc3Ryb3koKTtcbiAgICAgICAgICAgIHRoaXMuYmxvY2tzLnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgIH0pO1xuICAgICAgICBXaW5kb3dFdmVudEhhbmRsZXIucmVtb3ZlRXZlbnRMaXN0ZW5lcigndGltZXI6ZG9uZScpO1xuICAgICAgICB3aW5kb3cuZGlzcGF0Y2hFdmVudChuZXcgRXZlbnQoZXZlbnRUeXBlKSk7XG4gICAgICAgIHRoaXMuZWwucmVtb3ZlKCk7XG4gICAgfVxufVxuIiwiaW1wb3J0IGNvbmZpZyBmcm9tICcuL2NvbmZpZy5qc29uJztcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgRGF0YVNlcnZpY2Uge1xuICAgIHByaXZhdGUgZW5kUG9pbnRMaXN0OiBzdHJpbmcgPSBgL2RhdGFiYXNlcy8ke2NvbmZpZy5kYXRhU2VydmljZS5kYXRhYmFzZU5hbWV9L2NvbGxlY3Rpb25zLyR7Y29uZmlnLmRhdGFTZXJ2aWNlLmNvbGxlY3Rpb25OYW1lfT9hcGlLZXk9JHtjb25maWcuZGF0YVNlcnZpY2UuYXBpS2V5fWA7XG4gICAgcHJpdmF0ZSBlbmRQb2ludFNhdmU6IHN0cmluZyA9IGAvZGF0YWJhc2VzLyR7Y29uZmlnLmRhdGFTZXJ2aWNlLmRhdGFiYXNlTmFtZX0vY29sbGVjdGlvbnMvJHtjb25maWcuZGF0YVNlcnZpY2UuY29sbGVjdGlvbk5hbWV9P2FwaUtleT0ke2NvbmZpZy5kYXRhU2VydmljZS5hcGlLZXl9YDtcblxuICAgIC8qKlxuICAgICAqIFN0b3JlIHRoZSBsYXRlc3Qgc2NvcmUgaW4gdGhlIERCXG4gICAgICpcbiAgICAgKiBAcGFyYW0gc2NvcmVcbiAgICAgKiBAcmV0dXJucyB7UHJvbWlzZTx7fT59XG4gICAgICovXG4gICAgcHVibGljIHNhdmVTY29yZShzY29yZTogbnVtYmVyKSB7XG4gICAgICAgIGlmIChjb25maWcuZnVuY3Rpb25hbGl0aWVzLmRhdGFTZXJ2aWNlID09PSBmYWxzZSkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZGlzYWJsZWQoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGxldCB1cmwgPSBgJHtjb25maWcuZGF0YVNlcnZpY2UuYmFzZVVybH0ke3RoaXMuZW5kUG9pbnRTYXZlfWA7XG4gICAgICAgIHJldHVybiBmZXRjaCh1cmwsIHtcbiAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICAgICAgICBzY29yZTogc2NvcmVcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgICAgICdjb250ZW50LXR5cGUnOiAnYXBwbGljYXRpb24vanNvbidcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICAgIG1vZGU6ICdjb3JzJ1xuICAgICAgICB9KS50aGVuKHJlc3BvbnNlID0+IHJlc3BvbnNlLmpzb24oKSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IGFsbCB0aGUgY3VycmVudCBzY29yZXMgZnJvbSB0aGUgREJcbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHtQcm9taXNlPFtdPn1cbiAgICAgKi9cbiAgICBwdWJsaWMgZ2V0U2NvcmVzKCkge1xuICAgICAgICBpZiAoY29uZmlnLmZ1bmN0aW9uYWxpdGllcy5kYXRhU2VydmljZSA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmRpc2FibGVkKCk7XG4gICAgICAgIH1cblxuICAgICAgICBsZXQgdXJsID0gYCR7Y29uZmlnLmRhdGFTZXJ2aWNlLmJhc2VVcmx9JHt0aGlzLmVuZFBvaW50TGlzdH1gO1xuICAgICAgICByZXR1cm4gZmV0Y2godXJsLCB7XG4gICAgICAgICAgICBtb2RlOiAnY29ycydcbiAgICAgICAgfSkudGhlbihyZXNwb25zZSA9PiByZXNwb25zZS5qc29uKCkpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdlbmVyYWwgbWVzc2FnZSB3aGVuIHRoaXMgc2VydmljZSBpcyBpbmFjdGl2ZVxuICAgICAqXG4gICAgICogQHJldHVybnMge1Byb21pc2U8e30+fVxuICAgICAqL1xuICAgIHByaXZhdGUgZGlzYWJsZWQoKSB7XG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4ge1xuICAgICAgICAgICAgcmVzb2x2ZSh7XCJlcnJvclwiOiBcIkRhdGFzZXJ2aWNlIGlzIGRpc2FibGVkXCJ9KTtcbiAgICAgICAgfSk7XG4gICAgfVxufVxuIiwiaW1wb3J0IEdhbWUgZnJvbSAnLi9nYW1lJztcblxud2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJsb2FkXCIsICgpID0+IG5ldyBHYW1lKCkpO1xuIiwiaW1wb3J0IEdVSSBmcm9tICcuL2d1aS9ndWknO1xuaW1wb3J0IExldmVsIGZyb20gXCIuL2xldmVsL2xldmVsXCI7XG5pbXBvcnQgRGF0YVNlcnZpY2UgZnJvbSBcIi4vZGF0YXNlcnZpY2VcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgR2FtZSB7XG4gICAgcHJpdmF0ZSBsZXZlbCE6IExldmVsO1xuICAgIHByaXZhdGUgbGV2ZWxzUGVyR2FtZTogbnVtYmVyID0gMTA7XG4gICAgcHJpdmF0ZSBjdXJyZW50TGV2ZWxzUGxheWVkOiBudW1iZXIgPSAwO1xuICAgIHByaXZhdGUgZWxlbWVudHNQZXJMZXZlbDogbnVtYmVyID0gNTtcbiAgICBwcml2YXRlIGVsZW1lbnRzSW5jcmVhc2VQZXJMZXZlbDogbnVtYmVyID0gNTtcbiAgICBwcml2YXRlIHNjb3JlUGVyRWxlbWVudDogbnVtYmVyID0gMTA7XG4gICAgcHJpdmF0ZSByZWFkb25seSBtYXhTY29yZTogbnVtYmVyO1xuICAgIHByaXZhdGUgZ3VpOiBHVUk7XG4gICAgcHJpdmF0ZSBkYXRhU2VydmljZTogRGF0YVNlcnZpY2U7XG5cbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgdGhpcy5ndWkgPSBuZXcgR1VJKCk7XG4gICAgICAgIHRoaXMubWF4U2NvcmUgPSB0aGlzLmNhbGN1bGF0ZU1heFNjb3JlKCk7XG4gICAgICAgIHRoaXMuZ2FtZUxvb3AoKTtcbiAgICAgICAgdGhpcy5kYXRhU2VydmljZSA9IG5ldyBEYXRhU2VydmljZSgpO1xuICAgICAgICB0aGlzLmRhdGFTZXJ2aWNlLmdldFNjb3JlcygpLnRoZW4oKGRhdGEpID0+IHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdDdXJyZW50IHNjb3JlcycsIGRhdGEpO1xuICAgICAgICB9KTtcblxuICAgICAgICBbJ2xldmVsOnN1Y2Nlc3MnLCAnbGV2ZWw6ZmFpbGVkJ10ubWFwKChldmVudFR5cGUpID0+IHtcbiAgICAgICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKGV2ZW50VHlwZSwgKGUpID0+IHRoaXMudXBkYXRlKGUudHlwZSkpO1xuICAgICAgICB9KTtcbiAgICAgICAgWydnYW1lOnN0YXJ0OmNsaWNrJywgJ2xldmVsOnN1Y2Nlc3M6Y2xpY2snLCAnbGV2ZWw6ZmFpbGVkOmNsaWNrJ10ubWFwKChldmVudFR5cGUpID0+IHtcbiAgICAgICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKGV2ZW50VHlwZSwgKCkgPT4gdGhpcy5zdGFydE5ld0xldmVsKCkpO1xuICAgICAgICB9KTtcbiAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2dhbWU6ZW5kOmNsaWNrJywgKCkgPT4gdGhpcy5yZXN0YXJ0KCkpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENhbGN1bGF0ZSB0aGUgc2NvcmUgd2l0aCBhdmFpbGFibGUgcGFyYW1ldGVyc1xuICAgICAqXG4gICAgICogQHRvZG8gRG8gSSByZWFsbHkgbmVlZCB0byB0byB0aGlzIHNvIGluZWZmaWNpZW50Li4/XG4gICAgICogQHJldHVybnMge251bWJlcn1cbiAgICAgKi9cbiAgICBwcml2YXRlIGNhbGN1bGF0ZU1heFNjb3JlKCkge1xuICAgICAgICBsZXQgbWF4U2NvcmUgPSAwO1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubGV2ZWxzUGVyR2FtZTsgaSsrKSB7XG4gICAgICAgICAgICBsZXQgZWxlbWVudHMgPSB0aGlzLmVsZW1lbnRzUGVyTGV2ZWwgKyAoaSA9PT0gMCA/IDAgOiAodGhpcy5lbGVtZW50c0luY3JlYXNlUGVyTGV2ZWwgKiBpKSk7XG4gICAgICAgICAgICBtYXhTY29yZSArPSAoZWxlbWVudHMgKiB0aGlzLnNjb3JlUGVyRWxlbWVudCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG1heFNjb3JlO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRoZSBvbmx5IHBsYWNlIGZvciBhIHJlcXVlc3RBbmltYXRpb25GcmFtZVxuICAgICAqL1xuICAgIHByaXZhdGUgZ2FtZUxvb3AoKSB7XG4gICAgICAgIGlmICh0eXBlb2YgdGhpcy5sZXZlbCAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgIHRoaXMubGV2ZWwudXBkYXRlKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKCgpID0+IHRoaXMuZ2FtZUxvb3AoKSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVXBkYXRlIHRoZSBnYW1lIGJ5IGVpdGhlciB0aGUgZW5kIG9yIGFueXRoaW5nIGluIGJldHdlZW4gbGV2ZWxzXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gdHlwZVxuICAgICAqL1xuICAgIHByaXZhdGUgdXBkYXRlKHR5cGU6IHN0cmluZykge1xuICAgICAgICB0aGlzLmN1cnJlbnRMZXZlbHNQbGF5ZWQrKztcbiAgICAgICAgaWYgKHRoaXMuY3VycmVudExldmVsc1BsYXllZCA9PT0gdGhpcy5sZXZlbHNQZXJHYW1lKSB7XG4gICAgICAgICAgICB0aGlzLmd1aS5nYW1lRW5kKHRoaXMubWF4U2NvcmUpO1xuICAgICAgICAgICAgdGhpcy5zYXZlU2NvcmUoKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuZ3VpLmxldmVsRG9uZSh0eXBlKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUaW1lIHRvIHN0YXJ0IGEgbmV3IGxldmVsIHdpdGggbWFkbmVzc1xuICAgICAqL1xuICAgIHByaXZhdGUgc3RhcnROZXdMZXZlbCgpIHtcbiAgICAgICAgaWYgKHRoaXMubGV2ZWwgJiYgdGhpcy5sZXZlbC5mYWlsZWQgPT09IGZhbHNlKSB7XG4gICAgICAgICAgICB0aGlzLmVsZW1lbnRzUGVyTGV2ZWwgKz0gdGhpcy5lbGVtZW50c0luY3JlYXNlUGVyTGV2ZWw7XG4gICAgICAgIH1cblxuICAgICAgICBkZWxldGUgdGhpcy5sZXZlbDtcbiAgICAgICAgdGhpcy5ndWkubmV3TGV2ZWwoKTtcblxuICAgICAgICB0aGlzLmxldmVsID0gbmV3IExldmVsKHRoaXMuZWxlbWVudHNQZXJMZXZlbCwgdGhpcy5zY29yZVBlckVsZW1lbnQpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFN0YXJ0IGV2ZXJ5dGhpbmcgZnJvbSB0aGUgYmVnaW5uaW5nXG4gICAgICovXG4gICAgcHJpdmF0ZSByZXN0YXJ0KCkge1xuICAgICAgICB0aGlzLmd1aS5yZXN0YXJ0KCk7XG4gICAgICAgIHRoaXMuY3VycmVudExldmVsc1BsYXllZCA9IDA7XG4gICAgICAgIHRoaXMuZWxlbWVudHNQZXJMZXZlbCA9IDU7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2FsbCB0aGUgZGF0YSBzZXJ2aWNlIGFuZCBsZXQgaXQgZG8gaXRzIG1hZ2ljXG4gICAgICovXG4gICAgcHJpdmF0ZSBzYXZlU2NvcmUoKSB7XG4gICAgICAgIGxldCBzY29yZSA9IHRoaXMuZ3VpLmdldFNjb3JlKCk7XG4gICAgICAgIHRoaXMuZGF0YVNlcnZpY2Uuc2F2ZVNjb3JlKHNjb3JlKS50aGVuKChkYXRhKSA9PiB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnUmVzcG9uc2UgYWZ0ZXIgc2F2aW5nIHNjb3JlJywgZGF0YSk7XG4gICAgICAgIH0pO1xuICAgIH1cbn1cbiJdLCJzb3VyY2VSb290IjoiIn0=