!function(e){var s={};function t(i){if(s[i])return s[i].exports;var r=s[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,t),r.l=!0,r.exports}t.m=e,t.c=s,t.d=function(e,s,i){t.o(e,s)||Object.defineProperty(e,s,{configurable:!1,enumerable:!0,get:i})},t.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},t.n=function(e){var s=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(s,"a",s),s},t.o=function(e,s){return Object.prototype.hasOwnProperty.call(e,s)},t.p="",t(t.s=1)}([function(e){e.exports={game:{levelsPerGame:10,startElementsPerLevel:5,elementsIncreasePerLevel:5,scorePerElement:10,secondsPerLevel:10,blockSpeed:{min:1,max:5},blockPixels:{min:10,max:150},player:{growthFactor:1.5,speed:3,speedIncreaseFactor:.2}},functionalities:{mLab:!0},mLab:{baseUrl:"https://api.mlab.com/api/1",apiKey:"X17utv1FH2dFTeUo4yhNGL54sA7CY2jS",databaseName:"typescript_scores",collectionName:"scores"}}},function(e,s,t){"use strict";t.r(s);var i=t(0);class r{constructor(e,s,t,i=""){this.x=s,this.y=t,this.el=document.createElement("div");let r=document.getElementById("main");if(null===r)throw new Error("<main> element doesn't exist!");if(this.x>-1&&this.y>-1&&(this.el.style.transform=`translate(${this.x}px, ${this.y}px)`),this.el.classList.add(`game-${e}`),""===i)r.appendChild(this.el);else{let e=document.querySelector(`.game-${i}`);if(null===e)throw new Error(`<.game-${i}> element doesn't exist!`);e.appendChild(this.el)}}getClientReact(){return this.el.getBoundingClientRect()}}class a extends r{constructor(){super("score",-1,-1,"gui"),this.score=0,this.renderTemplate(),this.el.querySelector(".score-count").innerHTML=this.score.toString(),this.el.classList.add("message","is-warning")}get(){return this.score}update(e,s=!1){this.score=s?e:this.score+e,this.el.querySelector(".score-count").innerHTML=this.score.toString()}renderTemplate(){this.el.innerHTML='\n            <div class="message-body">\n                <span>score: </span>\n                <span class="score-count"></span>\n            </div>\n        '}}class n{static addEventListener(e,s){n.functionMap[e]=s,window.addEventListener(e.split(".")[0],n.functionMap[e])}static removeEventListener(e){window.removeEventListener(e.split(".")[0],n.functionMap[e]),delete n.functionMap[e]}}n.functionMap={};class o extends r{constructor(){super("messagescreen",-1,-1,"gui"),this.isActive=!1,this.messages={"game:start":{header:"Welcome to Block-o-Block!",body:"It's time to catch them blocks!<br/><br/>Use your arrow keys to move your player around and press space to start.<br/><br/>Press -<strong>H</strong>- to view the highscore list.",className:"is-info"},"game:end":{header:"Your game is over!",body:"You made it, your final score is __SCORE__ out of max __MAX_SCORE__ points.<br/><br/>Thanks for playing, press <strong>-N-</strong> to save your score or press space to restart the madness.<br/><br/>Press -<strong>H</strong>- to view the highscore list.",className:"is-success"},"level:success":{header:"YEAH! Level completed!",body:"Performing like a boss! Press space to proceed to the next level and catch even more blocks.",className:"is-success"},"level:failed":{header:"AAH! Level failed!",body:"Try again and show us what you're made off! Press space to restart this level.",className:"is-danger"}},this.el.classList.add("message"),this.renderTemplate(),this.show("game:start"),n.addEventListener("keyup.messagescreen",e=>this.keyBoardHandler(e))}keyBoardHandler(e){" "===e.key.toLowerCase()&&!0===this.isActive&&window.dispatchEvent(new Event(`${this.currentEvent}:click`))}show(e,s={}){let t=this.messages[e].header,i=this.messages[e].body;for(let e in s)i=i.replace(e,s[e]);this.el.querySelector(".message-header").innerHTML=t,this.el.querySelector(".message-body").innerHTML=i,this.el.classList.add("show",this.messages[e].className),this.currentEvent=e,this.isActive=!0}hide(){this.el.classList.remove("show","is-info","is-success","is-danger"),this.isActive=!1}renderTemplate(){this.el.innerHTML='\n            <div class="message-header"></div>\n            <div class="message-body"></div>\n        '}}class h{constructor(){this.endPointList=`/databases/${i.mLab.databaseName}/collections/${i.mLab.collectionName}?apiKey=${i.mLab.apiKey}`,this.endPointSave=`/databases/${i.mLab.databaseName}/collections/${i.mLab.collectionName}?apiKey=${i.mLab.apiKey}`,this.offlineUserScores=[],n.addEventListener("online.dataservice",()=>this.saveScoreToMlab())}static getInstance(){return h.instance||(h.instance=new h),h.instance}saveScore(e,s){let t={name:e,score:s};if(!1===i.functionalities.mLab||!1===window.navigator.onLine)return this.offlineUserScores.push(t),new Promise(e=>{e(t)});let r=`${i.mLab.baseUrl}${this.endPointSave}`;return fetch(r,{body:JSON.stringify(t),headers:{"content-type":"application/json"},method:"POST",mode:"cors"}).then(e=>e.json())}getScores(){if(!1===i.functionalities.mLab||!1===window.navigator.onLine)return new Promise(e=>{e(JSON.parse(localStorage.getItem("scores")))});let e=`${i.mLab.baseUrl}${this.endPointList}&s={"score": -1}&l=10`;return fetch(e,{mode:"cors"}).then(e=>e.json()).then(e=>localStorage.getItem("scores")===JSON.stringify(e)?JSON.parse(localStorage.getItem("scores")):(localStorage.setItem("scores",JSON.stringify(e)),e))}saveScoreToMlab(){this.offlineUserScores.length>0&&Promise.all(this.offlineUserScores.map(e=>this.saveScore(e.name,e.score))).then(()=>{this.offlineUserScores=[]})}}class l extends r{constructor(){super("highscorelist",-1,-1,"gui"),this.el.classList.add("modal"),this.renderTemplate(),this.tBody=this.el.querySelector(".tbody"),this.dataService=h.getInstance(),this.loadScoreData(),window.addEventListener("game:scoreSaved",e=>this.updateData(e.detail.data))}loadScoreData(e=!1){this.dataService.getScores().then(s=>{this.scores=s,this.tBody.innerHTML=this.getTbodyTemplate(),!0===e&&this.el.classList.add("is-active")})}updateData(e){((0===this.scores.length?-1:this.scores[this.scores.length-1].score)<e.score||this.scores.length<10)&&(this.scores.push(e),this.scores.sort((e,s)=>s.score-e.score),this.scores.splice(10,1),this.tBody.innerHTML=this.getTbodyTemplate())}show(){void 0===this.scores?this.loadScoreData(!0):this.el.classList.add("is-active")}hide(){this.el.classList.remove("is-active")}getTbodyTemplate(){return`\n            ${this.scores.map((e,s)=>`<tr>\n                <td>${s+1}</td>\n                <td>${e.name}</td>\n                <td>${e.score.toString()}</td>\n            </tr>`).join("")}\n        `}renderTemplate(){this.el.innerHTML='\n            <div class="modal-background"></div>\n            <div class="modal-content">\n                <div class="message is-warning">\n                    <div class="message-header">\n                        <p>Top 10 Scores (press -<strong>ESC</strong>- to return)</p>\n                    </div>\n                    <div class="message-body">\n                        <table class="table">\n                            <thead>\n                            <tr>\n                                <th>#</th>\n                                <th>Name</th>\n                                <th>Score</th>\n                            </tr>\n                            </thead>\n                            <tbody class="tbody"></tbody>\n                        </table>\n                    </div>\n                </div>\n            </div>\n        '}}class c extends r{constructor(){super("nameform",-1,-1,"gui"),this.score=0,this.dataService=h.getInstance(),this.el.classList.add("modal"),this.renderTemplate(),this.form=this.el.querySelector(".name-form"),this.nameField=this.form.querySelector(".name"),this.feedbackMessage=this.el.querySelector(".feedback-message"),this.form.addEventListener("submit",e=>this.saveScore(e))}show(e){this.form.classList.remove("is-hidden"),this.feedbackMessage.classList.add("is-hidden"),this.score=e,this.el.classList.add("is-active"),this.nameField.focus()}hide(){this.el.classList.remove("is-active")}saveScore(e){e.preventDefault();let s=this.nameField.value;this.dataService.saveScore(s,this.score).then(e=>{void 0===e.error&&(window.dispatchEvent(new CustomEvent("game:scoreSaved",{detail:{data:e}})),this.feedbackMessage.innerHTML="Your score has been saved, Press <strong>-ESC-</strong> to return to the previous screen!",this.form.classList.add("is-hidden"),this.feedbackMessage.classList.remove("is-hidden"))})}renderTemplate(){this.el.innerHTML='\n            <div class="modal-background"></div>\n            <div class="modal-content">\n                <div class="message">\n                    <div class="message-header">Please enter your name</div>\n                    <div class="message-body">\n                        <p class="feedback-message is-hidden"></p>\n                        <form method="post" action="" class="name-form">\n                            <div class="control has-icons-left">\n                                <input name="name" class="name input is-primary" type="text" placeholder="Enter your name.." maxlength="16" autocomplete="off"/>\n                                <span class="icon is-small is-left">\n                                    <i class="fas fa-user"></i>\n                                </span>\n                            </div>\n                            <div class="control">\n                                <input type="submit" class="input button" value="Save score"/>\n                            </div>\n                        </form>\n                    </div>\n                </div>\n            </div>\n        '}}class d extends r{constructor(){super("gui",-1,-1),this.nameFormVisible=!1,this.highScoreListVisible=!1,this.score=new a,this.messageScreen=new o,this.nameForm=new c,window.addEventListener("level:scoreUpdate",e=>this.score.update(e.detail.score)),this.highScoreList=new l,n.addEventListener("keyup.highscorelist",e=>this.keyBoardHandler(e))}keyBoardHandler(e){let s=e.key.toLowerCase();"h"===s&&!1===this.highScoreListVisible&&!1===this.nameFormVisible?(this.highScoreListVisible=!0,this.highScoreList.show(),this.messageScreen.isActive=!1):"escape"===s&&!0===this.highScoreListVisible&&(this.highScoreListVisible=!1,this.highScoreList.hide(),this.messageScreen.isActive=!0),"n"===s&&!1===this.highScoreListVisible&&!1===this.nameFormVisible&&"game:end"===this.messageScreen.currentEvent?(this.nameFormVisible=!0,this.nameForm.show(this.score.get()),this.messageScreen.isActive=!1):"escape"===s&&!0===this.nameFormVisible&&(this.nameFormVisible=!1,this.nameForm.hide(),this.messageScreen.isActive=!0)}show(e){this.messageScreen.show(e)}hide(){this.messageScreen.hide()}gameEnd(e){this.messageScreen.show("game:end",{__SCORE__:this.score.get().toString(),__MAX_SCORE__:e.toString()})}restart(){this.messageScreen.hide(),this.messageScreen.show("game:start"),this.score.update(0,!0)}}class m{static getRandomColor(){let e=Math.round,s=Math.random;return`rgba(${e(255*s())},${e(255*s())},${e(255*s())},1)`}static getRandomInt(e,s){return Math.floor(Math.random()*(s-e+1))+e}static checkCollision(e,s){return e.left<=s.right&&s.left<=e.right&&e.top<=s.bottom&&s.top<=e.bottom}}class p extends r{constructor(e,s,t,i){super("block",0,0,"level"),this.destination={x:0,y:0},this.speed=s,this.width=t,this.height=i,this.color=e,this.el.style.backgroundImage=`repeating-linear-gradient(${m.getRandomInt(0,360)}deg, #000000, #000000 ${m.getRandomInt(2,10)}px, ${this.color} 10px, ${this.color} ${m.getRandomInt(20,40)}px)`,this.el.style.width=`${this.width}px`,this.el.style.height=`${this.height}px`,this.x=m.getRandomInt(0,window.outerWidth-this.width),this.y=m.getRandomInt(0,document.documentElement.clientHeight-this.height),this.el.style.transform=`translate(${this.x}px, ${this.y}px)`}destroy(){this.el.remove()}update(){this.x>this.destination.x-this.speed&&this.x<this.destination.x+this.speed&&(this.destination.x=m.getRandomInt(0,window.outerWidth-this.width)),this.y>this.destination.y-this.speed&&this.y<this.destination.y+this.speed&&(this.destination.y=m.getRandomInt(0,document.documentElement.clientHeight-this.height)),this.destination.x>=this.x?this.x+=this.speed:this.x-=this.speed,this.destination.y>=this.y?this.y+=this.speed:this.y-=this.speed,this.el.style.transform=`translate(${this.x}px, ${this.y}px)`}}class g extends r{constructor(){super("player",0,0,"level"),this.height=10,this.width=10,this.growthFactor=i.game.player.growthFactor,this.speed=i.game.player.speed,this.speedIncreaseFactor=i.game.player.speedIncreaseFactor,this.keysAllowed=["arrowleft","arrowup","arrowright","arrowdown"],this.keysPressed=[],this.x=window.outerWidth/2-this.width/2,this.y=document.documentElement.clientHeight/2-this.height/2,this.el.style.width=`${this.width}px`,this.el.style.height=`${this.height}px`,this.el.style.borderRadius=`${this.width}px`,n.addEventListener("keydown.player",e=>this.keyDownHandler(e)),n.addEventListener("keyup.player",e=>this.keyUpHandler(e))}keyDownHandler(e){let s=e.key.toLowerCase();this.keysAllowed.indexOf(s)>-1&&-1===this.keysPressed.indexOf(s)&&this.keysPressed.push(s)}keyUpHandler(e){let s=e.key.toLowerCase(),t=this.keysPressed.indexOf(s);this.keysAllowed.indexOf(s)>-1&&t>-1&&this.keysPressed.splice(t,1)}update(){this.keysPressed.forEach(e=>{switch(e){case"arrowleft":this.x-=this.speed;break;case"arrowup":this.y-=this.speed;break;case"arrowright":this.x+=this.speed;break;case"arrowdown":this.y+=this.speed;break;default:return}}),this.x<0&&(this.x=0),this.y<0&&(this.y=0),this.x>window.outerWidth-this.width&&(this.x=window.outerWidth-this.width),this.y>document.documentElement.clientHeight-this.height&&(this.y=document.documentElement.clientHeight-this.height),this.el.style.transform=`translate(${this.x}px, ${this.y}px)`}blockCaught(e){this.speed+=this.speedIncreaseFactor,this.width+=this.growthFactor,this.height+=this.growthFactor,this.el.style.height=`${this.height}px`,this.el.style.width=`${this.width}px`,this.el.style.borderRadius=`${this.width}px`,this.el.style.backgroundColor=e.color}destroy(){this.el.remove(),n.removeEventListener("keydown.player"),n.removeEventListener("keyup.player")}}class u extends r{constructor(){super("timer",-1,-1,"level"),this.seconds=i.game.secondsPerLevel,this.renderTemplate(),this.el.classList.add("message","is-primary"),this.el.querySelector(".seconds").innerHTML=this.seconds.toString(),this.intervalId=setInterval(()=>this.update(),1e3)}update(){this.seconds--,this.el.querySelector(".seconds").innerHTML=this.seconds.toString(),this.seconds<=3?(this.el.classList.remove("is-primary"),this.el.classList.add("is-danger")):(this.el.classList.add("is-primary"),this.el.classList.remove("is-danger")),0===this.seconds&&window.dispatchEvent(new Event("timer:done"))}destroy(){clearInterval(this.intervalId)}renderTemplate(){this.el.innerHTML='\n            <div class="message-body">\n                <span>time: </span>\n                <span class="seconds"></span>\n            </div>\n        '}}class v extends r{constructor(e,s){super("level",0,0),this.blocks=[],this.failed=!1,this.totalBlocks=e,this.scorePerBlock=s,this.player=new g,this.timer=new u;for(let e=0;e<this.totalBlocks;e++)this.blocks.push(new p(m.getRandomColor(),m.getRandomInt(i.game.blockSpeed.min,i.game.blockSpeed.max),m.getRandomInt(i.game.blockPixels.min,i.game.blockPixels.max),m.getRandomInt(i.game.blockPixels.min,i.game.blockPixels.max)));n.addEventListener("timer:done",()=>{this.failed=!0,this.destroy("level:failed")})}update(){this.player.update(),this.blocks.forEach((e,s)=>{e.update(),m.checkCollision(this.player.getClientReact(),e.getClientReact())&&!1===this.failed&&(this.player.blockCaught(e),e.destroy(),this.blocks.splice(s,1),window.dispatchEvent(new CustomEvent("level:scoreUpdate",{detail:{score:this.scorePerBlock}})),0===this.blocks.length&&this.destroy("level:success"))})}destroy(e){this.timer.destroy(),this.player.destroy(),this.blocks.forEach((e,s)=>{e.destroy(),this.blocks.splice(s,1)}),n.removeEventListener("timer:done"),window.dispatchEvent(new Event(e)),this.el.remove()}}window.addEventListener("load",()=>new class{constructor(){this.levelsPerGame=i.game.levelsPerGame,this.currentLevelsPlayed=0,this.startElementsPerLevel=i.game.startElementsPerLevel,this.elementsIncreasePerLevel=i.game.elementsIncreasePerLevel,this.scorePerElement=i.game.scorePerElement,this.gui=new d,this.maxScore=this.calculateMaxScore(),this.gameLoop(),["level:success","level:failed"].map(e=>{window.addEventListener(e,e=>this.update(e.type))}),["game:start:click","level:success:click","level:failed:click"].map(e=>{window.addEventListener(e,()=>this.startNewLevel())}),window.addEventListener("game:end:click",()=>this.restart())}calculateMaxScore(){let e=0;for(let s=0;s<this.levelsPerGame;s++)e+=(this.startElementsPerLevel+(0===s?0:this.elementsIncreasePerLevel*s))*this.scorePerElement;return e}gameLoop(){void 0!==this.level&&this.level.update(),requestAnimationFrame(()=>this.gameLoop())}update(e){this.currentLevelsPlayed++,this.currentLevelsPlayed!==this.levelsPerGame?this.gui.show(e):this.gui.gameEnd(this.maxScore)}startNewLevel(){this.level&&!1===this.level.failed&&(this.startElementsPerLevel+=this.elementsIncreasePerLevel),delete this.level,this.gui.hide(),this.level=new v(this.startElementsPerLevel,this.scorePerElement)}restart(){this.gui.restart(),this.currentLevelsPlayed=0,this.startElementsPerLevel=i.game.startElementsPerLevel,delete this.level}})}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vZGV2L2hlbHBlcnMvZG9tZWxlbWVudC50cyIsIndlYnBhY2s6Ly8vLi9kZXYvZ3VpL3Njb3JlLnRzIiwid2VicGFjazovLy8uL2Rldi9oZWxwZXJzL3dpbmRvd2V2ZW50aGFuZGxlci50cyIsIndlYnBhY2s6Ly8vLi9kZXYvZ3VpL21lc3NhZ2VzY3JlZW4udHMiLCJ3ZWJwYWNrOi8vLy4vZGV2L2RhdGFzZXJ2aWNlLnRzIiwid2VicGFjazovLy8uL2Rldi9ndWkvaGlnaHNjb3JlbGlzdC50cyIsIndlYnBhY2s6Ly8vLi9kZXYvZ3VpL25hbWVmb3JtLnRzIiwid2VicGFjazovLy8uL2Rldi9ndWkvZ3VpLnRzIiwid2VicGFjazovLy8uL2Rldi9oZWxwZXJzL3V0aWxzLnRzIiwid2VicGFjazovLy8uL2Rldi9sZXZlbC9ibG9jay50cyIsIndlYnBhY2s6Ly8vLi9kZXYvbGV2ZWwvcGxheWVyLnRzIiwid2VicGFjazovLy8uL2Rldi9sZXZlbC90aW1lci50cyIsIndlYnBhY2s6Ly8vLi9kZXYvbGV2ZWwvbGV2ZWwudHMiLCJ3ZWJwYWNrOi8vLy4vZGV2L21haW4udHMiLCJ3ZWJwYWNrOi8vLy4vZGV2L2dhbWUudHMiXSwibmFtZXMiOlsiaW5zdGFsbGVkTW9kdWxlcyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImV4cG9ydHMiLCJtb2R1bGUiLCJpIiwibCIsIm1vZHVsZXMiLCJjYWxsIiwibSIsImMiLCJkIiwibmFtZSIsImdldHRlciIsIm8iLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImNvbmZpZ3VyYWJsZSIsImVudW1lcmFibGUiLCJnZXQiLCJyIiwidmFsdWUiLCJuIiwiX19lc01vZHVsZSIsIm9iamVjdCIsInByb3BlcnR5IiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJwIiwicyIsIkRvbUVsZW1lbnQiLCJbb2JqZWN0IE9iamVjdF0iLCJ0eXBlIiwieCIsInkiLCJwYXJlbnRDbGFzcyIsInRoaXMiLCJlbCIsImRvY3VtZW50IiwiY3JlYXRlRWxlbWVudCIsIm1haW4iLCJnZXRFbGVtZW50QnlJZCIsIkVycm9yIiwic3R5bGUiLCJ0cmFuc2Zvcm0iLCJjbGFzc0xpc3QiLCJhZGQiLCJhcHBlbmRDaGlsZCIsInBhcmVudEVsIiwicXVlcnlTZWxlY3RvciIsImdldEJvdW5kaW5nQ2xpZW50UmVjdCIsInNjb3JlX1Njb3JlIiwic3VwZXIiLCJzY29yZSIsInJlbmRlclRlbXBsYXRlIiwiaW5uZXJIVE1MIiwidG9TdHJpbmciLCJyZXNldCIsIldpbmRvd0V2ZW50SGFuZGxlciIsImV2ZW50IiwiZnVuYyIsImZ1bmN0aW9uTWFwIiwid2luZG93IiwiYWRkRXZlbnRMaXN0ZW5lciIsInNwbGl0IiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsIm1lc3NhZ2VzY3JlZW5fTWVzc2FnZVNjcmVlbiIsImlzQWN0aXZlIiwibWVzc2FnZXMiLCJnYW1lOnN0YXJ0IiwiaGVhZGVyIiwiYm9keSIsImNsYXNzTmFtZSIsImdhbWU6ZW5kIiwibGV2ZWw6c3VjY2VzcyIsImxldmVsOmZhaWxlZCIsInNob3ciLCJlIiwia2V5Qm9hcmRIYW5kbGVyIiwia2V5IiwidG9Mb3dlckNhc2UiLCJkaXNwYXRjaEV2ZW50IiwiRXZlbnQiLCJjdXJyZW50RXZlbnQiLCJib2R5UmVwbGFjZW1lbnRzIiwibWVzc2FnZUhlYWRlciIsIm1lc3NhZ2VCb2R5IiwicmVwbGFjZW1lbnQiLCJyZXBsYWNlIiwicmVtb3ZlIiwiZGF0YXNlcnZpY2VfRGF0YVNlcnZpY2UiLCJlbmRQb2ludExpc3QiLCJjb25maWciLCJtTGFiIiwiZGF0YWJhc2VOYW1lIiwiY29sbGVjdGlvbk5hbWUiLCJhcGlLZXkiLCJlbmRQb2ludFNhdmUiLCJvZmZsaW5lVXNlclNjb3JlcyIsInNhdmVTY29yZVRvTWxhYiIsImluc3RhbmNlIiwidXNlclNjb3JlIiwiZnVuY3Rpb25hbGl0aWVzIiwibmF2aWdhdG9yIiwib25MaW5lIiwicHVzaCIsIlByb21pc2UiLCJyZXNvbHZlIiwidXJsIiwiYmFzZVVybCIsImZldGNoIiwiSlNPTiIsInN0cmluZ2lmeSIsImhlYWRlcnMiLCJjb250ZW50LXR5cGUiLCJtZXRob2QiLCJtb2RlIiwidGhlbiIsInJlc3BvbnNlIiwianNvbiIsInBhcnNlIiwibG9jYWxTdG9yYWdlIiwiZ2V0SXRlbSIsImRhdGEiLCJzZXRJdGVtIiwibGVuZ3RoIiwiYWxsIiwibWFwIiwidXNlciIsInNhdmVTY29yZSIsImhpZ2hzY29yZWxpc3RfSGlnaFNjb3JlTGlzdCIsInRCb2R5IiwiZGF0YVNlcnZpY2UiLCJnZXRJbnN0YW5jZSIsImxvYWRTY29yZURhdGEiLCJ1cGRhdGVEYXRhIiwiZGV0YWlsIiwic2hvd1NjcmVlbiIsImdldFNjb3JlcyIsInNjb3JlcyIsImdldFRib2R5VGVtcGxhdGUiLCJzb3J0IiwiYSIsImIiLCJzcGxpY2UiLCJpdGVtIiwiaW5kZXgiLCJqb2luIiwibmFtZWZvcm1fTmFtZUZvcm0iLCJmb3JtIiwibmFtZUZpZWxkIiwiZmVlZGJhY2tNZXNzYWdlIiwiZm9jdXMiLCJwcmV2ZW50RGVmYXVsdCIsImVycm9yIiwiQ3VzdG9tRXZlbnQiLCJndWlfR1VJIiwibmFtZUZvcm1WaXNpYmxlIiwiaGlnaFNjb3JlTGlzdFZpc2libGUiLCJtZXNzYWdlU2NyZWVuIiwibmFtZUZvcm0iLCJ1cGRhdGUiLCJoaWdoU2NvcmVMaXN0IiwiaGlkZSIsIm1heFNjb3JlIiwiX19TQ09SRV9fIiwiX19NQVhfU0NPUkVfXyIsIlV0aWxzIiwiTWF0aCIsInJvdW5kIiwicmFuZG9tIiwibWluIiwibWF4IiwiZmxvb3IiLCJsZWZ0IiwicmlnaHQiLCJ0b3AiLCJib3R0b20iLCJibG9ja19CbG9jayIsImNvbG9yIiwic3BlZWQiLCJ3aWR0aCIsImhlaWdodCIsImRlc3RpbmF0aW9uIiwiYmFja2dyb3VuZEltYWdlIiwiZ2V0UmFuZG9tSW50Iiwib3V0ZXJXaWR0aCIsImRvY3VtZW50RWxlbWVudCIsImNsaWVudEhlaWdodCIsInBsYXllcl9QbGF5ZXIiLCJncm93dGhGYWN0b3IiLCJnYW1lIiwicGxheWVyIiwic3BlZWRJbmNyZWFzZUZhY3RvciIsImtleXNBbGxvd2VkIiwia2V5c1ByZXNzZWQiLCJib3JkZXJSYWRpdXMiLCJrZXlEb3duSGFuZGxlciIsImtleVVwSGFuZGxlciIsImluZGV4T2YiLCJrZXlQcmVzc2VkUG9zaXRpb24iLCJmb3JFYWNoIiwiYmxvY2siLCJiYWNrZ3JvdW5kQ29sb3IiLCJ0aW1lcl9UaW1lciIsInNlY29uZHMiLCJzZWNvbmRzUGVyTGV2ZWwiLCJpbnRlcnZhbElkIiwic2V0SW50ZXJ2YWwiLCJjbGVhckludGVydmFsIiwibGV2ZWxfTGV2ZWwiLCJ0b3RhbEJsb2NrcyIsInNjb3JlUGVyQmxvY2siLCJibG9ja3MiLCJmYWlsZWQiLCJ0aW1lciIsImdldFJhbmRvbUNvbG9yIiwiYmxvY2tTcGVlZCIsImJsb2NrUGl4ZWxzIiwiZGVzdHJveSIsImNoZWNrQ29sbGlzaW9uIiwiZ2V0Q2xpZW50UmVhY3QiLCJibG9ja0NhdWdodCIsImV2ZW50VHlwZSIsImxldmVsc1BlckdhbWUiLCJjdXJyZW50TGV2ZWxzUGxheWVkIiwic3RhcnRFbGVtZW50c1BlckxldmVsIiwiZWxlbWVudHNJbmNyZWFzZVBlckxldmVsIiwic2NvcmVQZXJFbGVtZW50IiwiZ3VpIiwiY2FsY3VsYXRlTWF4U2NvcmUiLCJnYW1lTG9vcCIsInN0YXJ0TmV3TGV2ZWwiLCJyZXN0YXJ0IiwibGV2ZWwiLCJyZXF1ZXN0QW5pbWF0aW9uRnJhbWUiLCJnYW1lRW5kIl0sIm1hcHBpbmdzIjoiYUFDQSxJQUFBQSxLQUdBLFNBQUFDLEVBQUFDLEdBR0EsR0FBQUYsRUFBQUUsR0FDQSxPQUFBRixFQUFBRSxHQUFBQyxRQUdBLElBQUFDLEVBQUFKLEVBQUFFLElBQ0FHLEVBQUFILEVBQ0FJLEdBQUEsRUFDQUgsWUFVQSxPQU5BSSxFQUFBTCxHQUFBTSxLQUFBSixFQUFBRCxRQUFBQyxJQUFBRCxRQUFBRixHQUdBRyxFQUFBRSxH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IG1vZHVsZSBjYWNoZVxuIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcblxuIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbiBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbiBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pIHtcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbiBcdFx0fVxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0aTogbW9kdWxlSWQsXG4gXHRcdFx0bDogZmFsc2UsXG4gXHRcdFx0ZXhwb3J0czoge31cbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubCA9IHRydWU7XG5cbiBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbiBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuIFx0fVxuXG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcblxuIFx0Ly8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHtcbiBcdFx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7XG4gXHRcdFx0XHRjb25maWd1cmFibGU6IGZhbHNlLFxuIFx0XHRcdFx0ZW51bWVyYWJsZTogdHJ1ZSxcbiBcdFx0XHRcdGdldDogZ2V0dGVyXG4gXHRcdFx0fSk7XG4gXHRcdH1cbiBcdH07XG5cbiBcdC8vIGRlZmluZSBfX2VzTW9kdWxlIG9uIGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uciA9IGZ1bmN0aW9uKGV4cG9ydHMpIHtcbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywgeyB2YWx1ZTogdHJ1ZSB9KTtcbiBcdH07XG5cbiBcdC8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSBmdW5jdGlvbihtb2R1bGUpIHtcbiBcdFx0dmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDpcbiBcdFx0XHRmdW5jdGlvbiBnZXRNb2R1bGVFeHBvcnRzKCkgeyByZXR1cm4gbW9kdWxlOyB9O1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCAnYScsIGdldHRlcik7XG4gXHRcdHJldHVybiBnZXR0ZXI7XG4gXHR9O1xuXG4gXHQvLyBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGxcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iamVjdCwgcHJvcGVydHkpIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KTsgfTtcblxuIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbiBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7XG5cblxuIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXyhfX3dlYnBhY2tfcmVxdWlyZV9fLnMgPSAxKTtcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIERvbUVsZW1lbnQge1xuICAgIHByb3RlY3RlZCBlbDogSFRNTERpdkVsZW1lbnQ7XG4gICAgcHJvdGVjdGVkIHg6IG51bWJlcjtcbiAgICBwcm90ZWN0ZWQgeTogbnVtYmVyO1xuXG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHR5cGVcbiAgICAgKiBAcGFyYW0ge251bWJlcn0geFxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSB5XG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHBhcmVudENsYXNzXG4gICAgICovXG4gICAgY29uc3RydWN0b3IodHlwZTogc3RyaW5nLCB4OiBudW1iZXIsIHk6IG51bWJlciwgcGFyZW50Q2xhc3M6IHN0cmluZyA9ICcnKSB7XG4gICAgICAgIHRoaXMueCA9IHg7XG4gICAgICAgIHRoaXMueSA9IHk7XG5cbiAgICAgICAgdGhpcy5lbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICBsZXQgbWFpbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYWluJyk7XG4gICAgICAgIGlmIChtYWluID09PSBudWxsKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCI8bWFpbj4gZWxlbWVudCBkb2Vzbid0IGV4aXN0IVwiKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vLTEgY2hlY2sgaXMgdG8gbGV0IENTUyBkbyBpdHMgb3duIGpvYiBAdG9kbyBjbGVhbmVyIHNvbHV0aW9uP1xuICAgICAgICBpZiAodGhpcy54ID4gLTEgJiYgdGhpcy55ID4gLTEpIHtcbiAgICAgICAgICAgIHRoaXMuZWwuc3R5bGUudHJhbnNmb3JtID0gYHRyYW5zbGF0ZSgke3RoaXMueH1weCwgJHt0aGlzLnl9cHgpYDtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmVsLmNsYXNzTGlzdC5hZGQoYGdhbWUtJHt0eXBlfWApO1xuXG4gICAgICAgIGlmIChwYXJlbnRDbGFzcyA9PT0gJycpIHtcbiAgICAgICAgICAgIG1haW4uYXBwZW5kQ2hpbGQodGhpcy5lbCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBsZXQgcGFyZW50RWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAuZ2FtZS0ke3BhcmVudENsYXNzfWApO1xuICAgICAgICAgICAgaWYgKHBhcmVudEVsID09PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGA8LmdhbWUtJHtwYXJlbnRDbGFzc30+IGVsZW1lbnQgZG9lc24ndCBleGlzdCFgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHBhcmVudEVsLmFwcGVuZENoaWxkKHRoaXMuZWwpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQHJldHVybnMgQ2xpZW50UmVjdFxuICAgICAqL1xuICAgIHB1YmxpYyBnZXRDbGllbnRSZWFjdCgpOiBDbGllbnRSZWN0IHwgRE9NUmVjdCB7XG4gICAgICAgIHJldHVybiB0aGlzLmVsLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICAgIH1cbn1cbiIsImltcG9ydCBEb21FbGVtZW50IGZyb20gXCIuLi9oZWxwZXJzL2RvbWVsZW1lbnRcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2NvcmUgZXh0ZW5kcyBEb21FbGVtZW50IHtcbiAgICBwcml2YXRlIHNjb3JlOiBudW1iZXIgPSAwO1xuXG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHN1cGVyKCdzY29yZScsIC0xLCAtMSwgJ2d1aScpO1xuXG4gICAgICAgIHRoaXMucmVuZGVyVGVtcGxhdGUoKTtcbiAgICAgICAgdGhpcy5lbC5xdWVyeVNlbGVjdG9yKCcuc2NvcmUtY291bnQnKS5pbm5lckhUTUwgPSB0aGlzLnNjb3JlLnRvU3RyaW5nKCk7XG4gICAgICAgIHRoaXMuZWwuY2xhc3NMaXN0LmFkZCgnbWVzc2FnZScsICdpcy13YXJuaW5nJyk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmV0cmlldmUgY3VycmVudCBzY29yZVxuICAgICAqXG4gICAgICogQHJldHVybnMge251bWJlcn1cbiAgICAgKi9cbiAgICBwdWJsaWMgZ2V0KCk6IG51bWJlciB7XG4gICAgICAgIHJldHVybiB0aGlzLnNjb3JlO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFVwZGF0ZSB0aGUgc2NvcmUgYmFzZWQgb24gYSBDdXN0b20gRXZlbnQgZnJvbSB0aGUgQmxvY2sgb2JqZWN0XG4gICAgICpcbiAgICAgKiBAcGFyYW0gc2NvcmVcbiAgICAgKiBAcGFyYW0gW3Jlc2V0XVxuICAgICAqL1xuICAgIHB1YmxpYyB1cGRhdGUoc2NvcmU6IG51bWJlciwgcmVzZXQ6IGJvb2xlYW4gPSBmYWxzZSk6IHZvaWQge1xuICAgICAgICB0aGlzLnNjb3JlID0gcmVzZXQgPyBzY29yZSA6IHRoaXMuc2NvcmUgKyBzY29yZTtcbiAgICAgICAgdGhpcy5lbC5xdWVyeVNlbGVjdG9yKCcuc2NvcmUtY291bnQnKS5pbm5lckhUTUwgPSB0aGlzLnNjb3JlLnRvU3RyaW5nKCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVGVtcGxhdGUgbmVlZGVkIHRvIHNob3cgbW9yZSBlbGVtZW50c1xuICAgICAqL1xuICAgIHByaXZhdGUgcmVuZGVyVGVtcGxhdGUoKTogdm9pZCB7XG4gICAgICAgIHRoaXMuZWwuaW5uZXJIVE1MID0gYFxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cIm1lc3NhZ2UtYm9keVwiPlxuICAgICAgICAgICAgICAgIDxzcGFuPnNjb3JlOiA8L3NwYW4+XG4gICAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9XCJzY29yZS1jb3VudFwiPjwvc3Bhbj5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICBgO1xuICAgIH1cbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFdpbmRvd0V2ZW50SGFuZGxlciB7XG4gICAgcHJpdmF0ZSBzdGF0aWMgZnVuY3Rpb25NYXA6IHsgW2s6IHN0cmluZ106IGFueSB9ID0ge307XG5cbiAgICAvKipcbiAgICAgKiBBZGQgbGlzdGVuZXIgdG8gd2luZG93IHdpdGggbmFtZSBzcGFjaW5nXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gZXZlbnRcbiAgICAgKiBAcGFyYW0gZnVuY1xuICAgICAqL1xuICAgIHB1YmxpYyBzdGF0aWMgYWRkRXZlbnRMaXN0ZW5lcihldmVudDogc3RyaW5nLCBmdW5jOiBhbnkpOiB2b2lkIHtcbiAgICAgICAgV2luZG93RXZlbnRIYW5kbGVyLmZ1bmN0aW9uTWFwW2V2ZW50XSA9IGZ1bmM7XG4gICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKGV2ZW50LnNwbGl0KCcuJylbMF0sIFdpbmRvd0V2ZW50SGFuZGxlci5mdW5jdGlvbk1hcFtldmVudF0pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJlbW92ZSBsaXN0ZW5lciBmcm9tIHdpbmRvdyB3aXRoIG5hbWUgc3BhY2luZ1xuICAgICAqXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGV2ZW50XG4gICAgICovXG4gICAgcHVibGljIHN0YXRpYyByZW1vdmVFdmVudExpc3RlbmVyKGV2ZW50OiBzdHJpbmcpOiB2b2lkIHtcbiAgICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoZXZlbnQuc3BsaXQoJy4nKVswXSwgV2luZG93RXZlbnRIYW5kbGVyLmZ1bmN0aW9uTWFwW2V2ZW50XSk7XG4gICAgICAgIGRlbGV0ZSBXaW5kb3dFdmVudEhhbmRsZXIuZnVuY3Rpb25NYXBbZXZlbnRdO1xuICAgIH1cbn1cbiIsImltcG9ydCBEb21FbGVtZW50IGZyb20gXCIuLi9oZWxwZXJzL2RvbWVsZW1lbnRcIjtcbmltcG9ydCBXaW5kb3dFdmVudEhhbmRsZXIgZnJvbSBcIi4uL2hlbHBlcnMvd2luZG93ZXZlbnRoYW5kbGVyXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIE1lc3NhZ2VTY3JlZW4gZXh0ZW5kcyBEb21FbGVtZW50IHtcbiAgICBwdWJsaWMgY3VycmVudEV2ZW50OiBzdHJpbmc7XG4gICAgcHVibGljIGlzQWN0aXZlOiBib29sZWFuID0gZmFsc2U7XG5cbiAgICBwcml2YXRlIG1lc3NhZ2VzOiB7IFtrOiBzdHJpbmddOiB7ICdoZWFkZXInOiBzdHJpbmcsICdib2R5Jzogc3RyaW5nLCAnY2xhc3NOYW1lJzogc3RyaW5nIH0gfSA9IHtcbiAgICAgICAgJ2dhbWU6c3RhcnQnOiB7XG4gICAgICAgICAgICAnaGVhZGVyJzogJ1dlbGNvbWUgdG8gQmxvY2stby1CbG9jayEnLFxuICAgICAgICAgICAgJ2JvZHknOiAnSXRcXCdzIHRpbWUgdG8gY2F0Y2ggdGhlbSBibG9ja3MhPGJyLz48YnIvPlVzZSB5b3VyIGFycm93IGtleXMgdG8gbW92ZSB5b3VyIHBsYXllciBhcm91bmQgYW5kIHByZXNzIHNwYWNlIHRvIHN0YXJ0Ljxici8+PGJyLz5QcmVzcyAtPHN0cm9uZz5IPC9zdHJvbmc+LSB0byB2aWV3IHRoZSBoaWdoc2NvcmUgbGlzdC4nLFxuICAgICAgICAgICAgJ2NsYXNzTmFtZSc6ICdpcy1pbmZvJ1xuICAgICAgICB9LFxuICAgICAgICAnZ2FtZTplbmQnOiB7XG4gICAgICAgICAgICAnaGVhZGVyJzogJ1lvdXIgZ2FtZSBpcyBvdmVyIScsXG4gICAgICAgICAgICAnYm9keSc6ICdZb3UgbWFkZSBpdCwgeW91ciBmaW5hbCBzY29yZSBpcyBfX1NDT1JFX18gb3V0IG9mIG1heCBfX01BWF9TQ09SRV9fIHBvaW50cy48YnIvPjxici8+VGhhbmtzIGZvciBwbGF5aW5nLCBwcmVzcyA8c3Ryb25nPi1OLTwvc3Ryb25nPiB0byBzYXZlIHlvdXIgc2NvcmUgb3IgcHJlc3Mgc3BhY2UgdG8gcmVzdGFydCB0aGUgbWFkbmVzcy48YnIvPjxici8+UHJlc3MgLTxzdHJvbmc+SDwvc3Ryb25nPi0gdG8gdmlldyB0aGUgaGlnaHNjb3JlIGxpc3QuJyxcbiAgICAgICAgICAgICdjbGFzc05hbWUnOiAnaXMtc3VjY2VzcydcbiAgICAgICAgfSxcbiAgICAgICAgJ2xldmVsOnN1Y2Nlc3MnOiB7XG4gICAgICAgICAgICAnaGVhZGVyJzogJ1lFQUghIExldmVsIGNvbXBsZXRlZCEnLFxuICAgICAgICAgICAgJ2JvZHknOiAnUGVyZm9ybWluZyBsaWtlIGEgYm9zcyEgUHJlc3Mgc3BhY2UgdG8gcHJvY2VlZCB0byB0aGUgbmV4dCBsZXZlbCBhbmQgY2F0Y2ggZXZlbiBtb3JlIGJsb2Nrcy4nLFxuICAgICAgICAgICAgJ2NsYXNzTmFtZSc6ICdpcy1zdWNjZXNzJ1xuICAgICAgICB9LFxuICAgICAgICAnbGV2ZWw6ZmFpbGVkJzoge1xuICAgICAgICAgICAgJ2hlYWRlcic6ICdBQUghIExldmVsIGZhaWxlZCEnLFxuICAgICAgICAgICAgJ2JvZHknOiAnVHJ5IGFnYWluIGFuZCBzaG93IHVzIHdoYXQgeW91XFwncmUgbWFkZSBvZmYhIFByZXNzIHNwYWNlIHRvIHJlc3RhcnQgdGhpcyBsZXZlbC4nLFxuICAgICAgICAgICAgJ2NsYXNzTmFtZSc6ICdpcy1kYW5nZXInXG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHN1cGVyKCdtZXNzYWdlc2NyZWVuJywgLTEsIC0xLCAnZ3VpJyk7XG4gICAgICAgIHRoaXMuZWwuY2xhc3NMaXN0LmFkZCgnbWVzc2FnZScpO1xuXG4gICAgICAgIHRoaXMucmVuZGVyVGVtcGxhdGUoKTtcbiAgICAgICAgdGhpcy5zaG93KCdnYW1lOnN0YXJ0Jyk7XG4gICAgICAgIFdpbmRvd0V2ZW50SGFuZGxlci5hZGRFdmVudExpc3RlbmVyKCdrZXl1cC5tZXNzYWdlc2NyZWVuJywgKGU6IEtleWJvYXJkRXZlbnQpID0+IHRoaXMua2V5Qm9hcmRIYW5kbGVyKGUpKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBIYW5kbGUgdGhlIHNwYWNlYmFyXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge0tleWJvYXJkRXZlbnR9IGVcbiAgICAgKi9cbiAgICBwcml2YXRlIGtleUJvYXJkSGFuZGxlcihlOiBLZXlib2FyZEV2ZW50KTogdm9pZCB7XG4gICAgICAgIGxldCBrZXkgPSBlLmtleS50b0xvd2VyQ2FzZSgpO1xuXG4gICAgICAgIGlmIChrZXkgPT09ICcgJyAmJiB0aGlzLmlzQWN0aXZlID09PSB0cnVlKSB7XG4gICAgICAgICAgICB3aW5kb3cuZGlzcGF0Y2hFdmVudChuZXcgRXZlbnQoYCR7dGhpcy5jdXJyZW50RXZlbnR9OmNsaWNrYCkpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU2hvdyB0aGUgZGVzaXJlZCBtZXNzYWdlICh0eXBlIG1hdGNoZXMgaW5kZXggaW4gb2JqZWN0KVxuICAgICAqXG4gICAgICogQHBhcmFtIHR5cGVcbiAgICAgKiBAcGFyYW0gW2JvZHlSZXBsYWNlbWVudHNdXG4gICAgICovXG4gICAgcHVibGljIHNob3codHlwZTogc3RyaW5nLCBib2R5UmVwbGFjZW1lbnRzOiB7IFtrOiBzdHJpbmddOiBzdHJpbmcgfSA9IHt9KTogdm9pZCB7XG4gICAgICAgIGxldCBtZXNzYWdlSGVhZGVyID0gdGhpcy5tZXNzYWdlc1t0eXBlXS5oZWFkZXI7XG4gICAgICAgIGxldCBtZXNzYWdlQm9keSA9IHRoaXMubWVzc2FnZXNbdHlwZV0uYm9keTtcbiAgICAgICAgZm9yIChsZXQgcmVwbGFjZW1lbnQgaW4gYm9keVJlcGxhY2VtZW50cykge1xuICAgICAgICAgICAgbWVzc2FnZUJvZHkgPSBtZXNzYWdlQm9keS5yZXBsYWNlKHJlcGxhY2VtZW50LCBib2R5UmVwbGFjZW1lbnRzW3JlcGxhY2VtZW50XSk7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLmVsLnF1ZXJ5U2VsZWN0b3IoJy5tZXNzYWdlLWhlYWRlcicpLmlubmVySFRNTCA9IG1lc3NhZ2VIZWFkZXI7XG4gICAgICAgIHRoaXMuZWwucXVlcnlTZWxlY3RvcignLm1lc3NhZ2UtYm9keScpLmlubmVySFRNTCA9IG1lc3NhZ2VCb2R5O1xuXG4gICAgICAgIHRoaXMuZWwuY2xhc3NMaXN0LmFkZCgnc2hvdycsIHRoaXMubWVzc2FnZXNbdHlwZV0uY2xhc3NOYW1lKTtcbiAgICAgICAgdGhpcy5jdXJyZW50RXZlbnQgPSB0eXBlO1xuICAgICAgICB0aGlzLmlzQWN0aXZlID0gdHJ1ZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBIaWRlIG1lc3NhZ2Ugb24gc2NyZWVuXG4gICAgICovXG4gICAgcHVibGljIGhpZGUoKTogdm9pZCB7XG4gICAgICAgIHRoaXMuZWwuY2xhc3NMaXN0LnJlbW92ZSgnc2hvdycsICdpcy1pbmZvJywgJ2lzLXN1Y2Nlc3MnLCAnaXMtZGFuZ2VyJyk7XG4gICAgICAgIHRoaXMuaXNBY3RpdmUgPSBmYWxzZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUZW1wbGF0ZSBuZWVkZWQgdG8gc2hvdyBtb3JlIGVsZW1lbnRzXG4gICAgICovXG4gICAgcHJpdmF0ZSByZW5kZXJUZW1wbGF0ZSgpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5lbC5pbm5lckhUTUwgPSBgXG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVwibWVzc2FnZS1oZWFkZXJcIj48L2Rpdj5cbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJtZXNzYWdlLWJvZHlcIj48L2Rpdj5cbiAgICAgICAgYDtcbiAgICB9XG59XG4iLCJpbXBvcnQgY29uZmlnIGZyb20gJy4vY29uZmlnLmpzb24nO1xuaW1wb3J0IFdpbmRvd0V2ZW50SGFuZGxlciBmcm9tIFwiLi9oZWxwZXJzL3dpbmRvd2V2ZW50aGFuZGxlclwiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBEYXRhU2VydmljZSB7XG4gICAgcHJpdmF0ZSBzdGF0aWMgaW5zdGFuY2U6IERhdGFTZXJ2aWNlO1xuXG4gICAgcHJpdmF0ZSBlbmRQb2ludExpc3Q6IHN0cmluZyA9IGAvZGF0YWJhc2VzLyR7Y29uZmlnLm1MYWIuZGF0YWJhc2VOYW1lfS9jb2xsZWN0aW9ucy8ke2NvbmZpZy5tTGFiLmNvbGxlY3Rpb25OYW1lfT9hcGlLZXk9JHtjb25maWcubUxhYi5hcGlLZXl9YDtcbiAgICBwcml2YXRlIGVuZFBvaW50U2F2ZTogc3RyaW5nID0gYC9kYXRhYmFzZXMvJHtjb25maWcubUxhYi5kYXRhYmFzZU5hbWV9L2NvbGxlY3Rpb25zLyR7Y29uZmlnLm1MYWIuY29sbGVjdGlvbk5hbWV9P2FwaUtleT0ke2NvbmZpZy5tTGFiLmFwaUtleX1gO1xuICAgIHByaXZhdGUgb2ZmbGluZVVzZXJTY29yZXM6IHsgbmFtZTogc3RyaW5nLCBzY29yZTogbnVtYmVyIH1bXSA9IFtdO1xuXG4gICAgcHJpdmF0ZSBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgV2luZG93RXZlbnRIYW5kbGVyLmFkZEV2ZW50TGlzdGVuZXIoJ29ubGluZS5kYXRhc2VydmljZScsICgpID0+IHRoaXMuc2F2ZVNjb3JlVG9NbGFiKCkpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRoaXMgY2xhc3MgbmVlZHMgdG8gd29yayBhcyBTaW5nbGVUb24gdG8gcHJldmVudCBkb3VibGUgZGF0YSBjYWxscyBldGMuXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyB7RGF0YVNlcnZpY2V9XG4gICAgICovXG4gICAgcHVibGljIHN0YXRpYyBnZXRJbnN0YW5jZSgpOiBEYXRhU2VydmljZSB7XG4gICAgICAgIGlmICghRGF0YVNlcnZpY2UuaW5zdGFuY2UpIHtcbiAgICAgICAgICAgIERhdGFTZXJ2aWNlLmluc3RhbmNlID0gbmV3IERhdGFTZXJ2aWNlKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIERhdGFTZXJ2aWNlLmluc3RhbmNlO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFN0b3JlIHRoZSBsYXRlc3Qgc2NvcmUgaW4gdGhlIERCXG4gICAgICpcbiAgICAgKiBAcGFyYW0gbmFtZVxuICAgICAqIEBwYXJhbSBzY29yZVxuICAgICAqIEByZXR1cm5zIHtQcm9taXNlPHt9Pn1cbiAgICAgKi9cbiAgICBwdWJsaWMgc2F2ZVNjb3JlKG5hbWU6IHN0cmluZywgc2NvcmU6IG51bWJlcik6IFByb21pc2U8YW55PiB7XG4gICAgICAgIGxldCB1c2VyU2NvcmUgPSB7bmFtZSwgc2NvcmV9O1xuXG4gICAgICAgIGlmIChjb25maWcuZnVuY3Rpb25hbGl0aWVzLm1MYWIgPT09IGZhbHNlIHx8IHdpbmRvdy5uYXZpZ2F0b3Iub25MaW5lID09PSBmYWxzZSkge1xuICAgICAgICAgICAgdGhpcy5vZmZsaW5lVXNlclNjb3Jlcy5wdXNoKHVzZXJTY29yZSk7XG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHtcbiAgICAgICAgICAgICAgICByZXNvbHZlKHVzZXJTY29yZSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGxldCB1cmwgPSBgJHtjb25maWcubUxhYi5iYXNlVXJsfSR7dGhpcy5lbmRQb2ludFNhdmV9YDtcbiAgICAgICAgcmV0dXJuIGZldGNoKHVybCwge1xuICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkodXNlclNjb3JlKSxcbiAgICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICAgICAnY29udGVudC10eXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAgICBtb2RlOiAnY29ycydcbiAgICAgICAgfSkudGhlbihyZXNwb25zZSA9PiByZXNwb25zZS5qc29uKCkpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCBhbGwgdGhlIGN1cnJlbnQgc2NvcmVzIGZyb20gdGhlIERCXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyB7UHJvbWlzZTxbXT59XG4gICAgICovXG4gICAgcHVibGljIGdldFNjb3JlcygpOiBQcm9taXNlPGFueT4ge1xuICAgICAgICBpZiAoY29uZmlnLmZ1bmN0aW9uYWxpdGllcy5tTGFiID09PSBmYWxzZSB8fCB3aW5kb3cubmF2aWdhdG9yLm9uTGluZSA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4ge1xuICAgICAgICAgICAgICAgIHJlc29sdmUoSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnc2NvcmVzJykpKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgbGV0IHVybCA9IGAke2NvbmZpZy5tTGFiLmJhc2VVcmx9JHt0aGlzLmVuZFBvaW50TGlzdH0mcz17XCJzY29yZVwiOiAtMX0mbD0xMGA7XG4gICAgICAgIHJldHVybiBmZXRjaCh1cmwsIHtcbiAgICAgICAgICAgIG1vZGU6ICdjb3JzJ1xuICAgICAgICB9KS50aGVuKHJlc3BvbnNlID0+IHJlc3BvbnNlLmpzb24oKSkudGhlbigoZGF0YSkgPT4ge1xuICAgICAgICAgICAgaWYgKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdzY29yZXMnKSA9PT0gSlNPTi5zdHJpbmdpZnkoZGF0YSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnc2NvcmVzJykpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnc2NvcmVzJywgSlNPTi5zdHJpbmdpZnkoZGF0YSkpO1xuICAgICAgICAgICAgICAgIHJldHVybiBkYXRhO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTYXZlIHRoZSBzY29yZSB0byBtTGFiIG9uY2UgYmFjayBvbmxpbmVcbiAgICAgKi9cbiAgICBwcml2YXRlIHNhdmVTY29yZVRvTWxhYigpOiB2b2lkIHtcbiAgICAgICAgaWYgKHRoaXMub2ZmbGluZVVzZXJTY29yZXMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgUHJvbWlzZS5hbGwodGhpcy5vZmZsaW5lVXNlclNjb3Jlcy5tYXAoKHVzZXIpID0+IHRoaXMuc2F2ZVNjb3JlKHVzZXIubmFtZSwgdXNlci5zY29yZSkpKS50aGVuKCgpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLm9mZmxpbmVVc2VyU2NvcmVzID0gW107XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cbn1cbiIsImltcG9ydCBEb21FbGVtZW50IGZyb20gXCIuLi9oZWxwZXJzL2RvbWVsZW1lbnRcIjtcbmltcG9ydCBEYXRhU2VydmljZSBmcm9tIFwiLi4vZGF0YXNlcnZpY2VcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgSGlnaFNjb3JlTGlzdCBleHRlbmRzIERvbUVsZW1lbnQge1xuICAgIHByaXZhdGUgZGF0YVNlcnZpY2U6IERhdGFTZXJ2aWNlO1xuICAgIHByaXZhdGUgc2NvcmVzOiB7IG5hbWU6IHN0cmluZywgc2NvcmU6IG51bWJlciwgX2lkOiB7ICRvaWQ6IHN0cmluZyB9IH1bXTtcbiAgICBwcml2YXRlIHRCb2R5OiBIVE1MVGFibGVTZWN0aW9uRWxlbWVudDtcblxuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICBzdXBlcignaGlnaHNjb3JlbGlzdCcsIC0xLCAtMSwgJ2d1aScpO1xuICAgICAgICB0aGlzLmVsLmNsYXNzTGlzdC5hZGQoJ21vZGFsJyk7XG5cbiAgICAgICAgdGhpcy5yZW5kZXJUZW1wbGF0ZSgpO1xuICAgICAgICB0aGlzLnRCb2R5ID0gdGhpcy5lbC5xdWVyeVNlbGVjdG9yKCcudGJvZHknKTtcblxuICAgICAgICB0aGlzLmRhdGFTZXJ2aWNlID0gRGF0YVNlcnZpY2UuZ2V0SW5zdGFuY2UoKTtcbiAgICAgICAgdGhpcy5sb2FkU2NvcmVEYXRhKCk7XG5cbiAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2dhbWU6c2NvcmVTYXZlZCcsIChlKSA9PiB0aGlzLnVwZGF0ZURhdGEoKGUgYXMgQ3VzdG9tRXZlbnQpLmRldGFpbC5kYXRhKSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogSW5pdGlhbCBzY29yZSBsb2FkaW5nXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IHNob3dTY3JlZW5cbiAgICAgKi9cbiAgICBwcml2YXRlIGxvYWRTY29yZURhdGEoc2hvd1NjcmVlbjogYm9vbGVhbiA9IGZhbHNlKTogdm9pZCB7XG4gICAgICAgIHRoaXMuZGF0YVNlcnZpY2UuZ2V0U2NvcmVzKCkudGhlbigoZGF0YSkgPT4ge1xuICAgICAgICAgICAgdGhpcy5zY29yZXMgPSBkYXRhO1xuICAgICAgICAgICAgdGhpcy50Qm9keS5pbm5lckhUTUwgPSB0aGlzLmdldFRib2R5VGVtcGxhdGUoKTtcblxuICAgICAgICAgICAgaWYgKHNob3dTY3JlZW4gPT09IHRydWUpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmVsLmNsYXNzTGlzdC5hZGQoJ2lzLWFjdGl2ZScpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFVwZGF0ZSBjdXJyZW50IHNjb3JlIG9mIHVzZXIgaW4gYXZhaWxhYmxlIGRhdGFcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7e319IGRhdGFcbiAgICAgKi9cbiAgICBwcml2YXRlIHVwZGF0ZURhdGEoZGF0YTogeyBuYW1lOiBzdHJpbmcsIHNjb3JlOiBudW1iZXIsIF9pZDogeyAkb2lkOiBzdHJpbmcgfSB9KTogdm9pZCB7XG4gICAgICAgIC8vQ2hlY2sgaWYgZ2l2ZW4gc2NvcmUgaXMgdG9wIDEwIHdvcnRoeVxuICAgICAgICBsZXQgbG93ZXN0Q3VycmVudFNjb3JlID0gdGhpcy5zY29yZXMubGVuZ3RoID09PSAwID8gLTEgOiB0aGlzLnNjb3Jlc1t0aGlzLnNjb3Jlcy5sZW5ndGggLSAxXS5zY29yZTtcbiAgICAgICAgaWYgKGxvd2VzdEN1cnJlbnRTY29yZSA8IGRhdGEuc2NvcmUgfHwgdGhpcy5zY29yZXMubGVuZ3RoIDwgMTApIHtcbiAgICAgICAgICAgIC8vVXBkYXRpbmcgdGhlIHNjb3JlcyBhcnJheSAmIHByZXNlbnRcbiAgICAgICAgICAgIHRoaXMuc2NvcmVzLnB1c2goZGF0YSk7XG4gICAgICAgICAgICB0aGlzLnNjb3Jlcy5zb3J0KChhLCBiKSA9PiBiLnNjb3JlIC0gYS5zY29yZSk7XG4gICAgICAgICAgICB0aGlzLnNjb3Jlcy5zcGxpY2UoMTAsIDEpO1xuICAgICAgICAgICAgdGhpcy50Qm9keS5pbm5lckhUTUwgPSB0aGlzLmdldFRib2R5VGVtcGxhdGUoKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFNob3cgdGhlIGhpZ2ggc2NvcmUgbGlzdFxuICAgICAqL1xuICAgIHB1YmxpYyBzaG93KCk6IHZvaWQge1xuICAgICAgICBpZiAodHlwZW9mIHRoaXMuc2NvcmVzID09PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgICAgdGhpcy5sb2FkU2NvcmVEYXRhKHRydWUpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5lbC5jbGFzc0xpc3QuYWRkKCdpcy1hY3RpdmUnKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEhpZGUgaXQgcGVyaW9kXG4gICAgICovXG4gICAgcHVibGljIGhpZGUoKTogdm9pZCB7XG4gICAgICAgIHRoaXMuZWwuY2xhc3NMaXN0LnJlbW92ZSgnaXMtYWN0aXZlJyk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmV0dXJuIHRoZSBtYXBwZWQgSFRNTCA8dHI+IGxpc3QgZm9yIGFwcGVuZGluZyBpbiA8dGJvZHk+XG4gICAgICpcbiAgICAgKiBAcmV0dXJucyB7c3RyaW5nfVxuICAgICAqL1xuICAgIHByaXZhdGUgZ2V0VGJvZHlUZW1wbGF0ZSgpOiBzdHJpbmcge1xuICAgICAgICByZXR1cm4gYFxuICAgICAgICAgICAgJHt0aGlzLnNjb3Jlcy5tYXAoKGl0ZW0sIGluZGV4KSA9PiBgPHRyPlxuICAgICAgICAgICAgICAgIDx0ZD4ke2luZGV4ICsgMX08L3RkPlxuICAgICAgICAgICAgICAgIDx0ZD4ke2l0ZW0ubmFtZX08L3RkPlxuICAgICAgICAgICAgICAgIDx0ZD4ke2l0ZW0uc2NvcmUudG9TdHJpbmcoKX08L3RkPlxuICAgICAgICAgICAgPC90cj5gKS5qb2luKCcnKX1cbiAgICAgICAgYDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUZW1wbGF0ZSBuZWVkZWQgdG8gc2hvdyBtb3JlIGVsZW1lbnRzXG4gICAgICovXG4gICAgcHJpdmF0ZSByZW5kZXJUZW1wbGF0ZSgpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5lbC5pbm5lckhUTUwgPSBgXG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVwibW9kYWwtYmFja2dyb3VuZFwiPjwvZGl2PlxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cIm1vZGFsLWNvbnRlbnRcIj5cbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwibWVzc2FnZSBpcy13YXJuaW5nXCI+XG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJtZXNzYWdlLWhlYWRlclwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgPHA+VG9wIDEwIFNjb3JlcyAocHJlc3MgLTxzdHJvbmc+RVNDPC9zdHJvbmc+LSB0byByZXR1cm4pPC9wPlxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cIm1lc3NhZ2UtYm9keVwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgPHRhYmxlIGNsYXNzPVwidGFibGVcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGhlYWQ+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRyPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGg+IzwvdGg+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0aD5OYW1lPC90aD5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRoPlNjb3JlPC90aD5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3RyPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvdGhlYWQ+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRib2R5IGNsYXNzPVwidGJvZHlcIj48L3Rib2R5PlxuICAgICAgICAgICAgICAgICAgICAgICAgPC90YWJsZT5cbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgYDtcbiAgICB9XG59XG4iLCJpbXBvcnQgRG9tRWxlbWVudCBmcm9tIFwiLi4vaGVscGVycy9kb21lbGVtZW50XCI7XG5pbXBvcnQgRGF0YVNlcnZpY2UgZnJvbSBcIi4uL2RhdGFzZXJ2aWNlXCI7XG4vLyBpbXBvcnQgRmlsdGVyIGZyb20gXCJiYWQtd29yZHNcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgTmFtZUZvcm0gZXh0ZW5kcyBEb21FbGVtZW50IHtcbiAgICBwcml2YXRlIGRhdGFTZXJ2aWNlOiBEYXRhU2VydmljZTtcbiAgICBwcml2YXRlIHNjb3JlOiBudW1iZXIgPSAwO1xuICAgIHByaXZhdGUgZm9ybTogSFRNTEZvcm1FbGVtZW50O1xuICAgIHByaXZhdGUgZmVlZGJhY2tNZXNzYWdlOiBIVE1MUGFyYWdyYXBoRWxlbWVudDtcbiAgICBwcml2YXRlIG5hbWVGaWVsZDogSFRNTElucHV0RWxlbWVudDtcblxuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICBzdXBlcignbmFtZWZvcm0nLCAtMSwgLTEsICdndWknKTtcbiAgICAgICAgdGhpcy5kYXRhU2VydmljZSA9IERhdGFTZXJ2aWNlLmdldEluc3RhbmNlKCk7XG5cbiAgICAgICAgdGhpcy5lbC5jbGFzc0xpc3QuYWRkKCdtb2RhbCcpO1xuICAgICAgICB0aGlzLnJlbmRlclRlbXBsYXRlKCk7XG5cbiAgICAgICAgdGhpcy5mb3JtID0gdGhpcy5lbC5xdWVyeVNlbGVjdG9yKCcubmFtZS1mb3JtJyk7XG4gICAgICAgIHRoaXMubmFtZUZpZWxkID0gdGhpcy5mb3JtLnF1ZXJ5U2VsZWN0b3IoJy5uYW1lJyk7XG4gICAgICAgIHRoaXMuZmVlZGJhY2tNZXNzYWdlID0gdGhpcy5lbC5xdWVyeVNlbGVjdG9yKCcuZmVlZGJhY2stbWVzc2FnZScpO1xuXG4gICAgICAgIHRoaXMuZm9ybS5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCAoZSkgPT4gdGhpcy5zYXZlU2NvcmUoZSkpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFNob3cgb3VyIGZvcm1cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBzY29yZVxuICAgICAqL1xuICAgIHB1YmxpYyBzaG93KHNjb3JlOiBudW1iZXIpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5mb3JtLmNsYXNzTGlzdC5yZW1vdmUoJ2lzLWhpZGRlbicpO1xuICAgICAgICB0aGlzLmZlZWRiYWNrTWVzc2FnZS5jbGFzc0xpc3QuYWRkKCdpcy1oaWRkZW4nKTtcblxuICAgICAgICB0aGlzLnNjb3JlID0gc2NvcmU7XG4gICAgICAgIHRoaXMuZWwuY2xhc3NMaXN0LmFkZCgnaXMtYWN0aXZlJyk7XG4gICAgICAgIHRoaXMubmFtZUZpZWxkLmZvY3VzKCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogSGlkZSBvdXIgZm9ybVxuICAgICAqL1xuICAgIHB1YmxpYyBoaWRlKCk6IHZvaWQge1xuICAgICAgICB0aGlzLmVsLmNsYXNzTGlzdC5yZW1vdmUoJ2lzLWFjdGl2ZScpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFNhdmUgc2NvcmUgd2l0aCB3ZWIgc2VydmljZSwgYW5kIG1ha2Ugc3VyZSB0byBoaWRlIG91ciBmb3JtIGFmdGVyd2FyZHNcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7RXZlbnR9IGVcbiAgICAgKi9cbiAgICBwcml2YXRlIHNhdmVTY29yZShlOiBFdmVudCk6IHZvaWQge1xuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIGxldCBuYW1lID0gdGhpcy5uYW1lRmllbGQudmFsdWU7XG5cbiAgICAgICAgdGhpcy5kYXRhU2VydmljZS5zYXZlU2NvcmUobmFtZSwgdGhpcy5zY29yZSkudGhlbigoZGF0YSkgPT4ge1xuICAgICAgICAgICAgaWYgKHR5cGVvZiBkYXRhLmVycm9yID09PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgICAgICAgIHdpbmRvdy5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgnZ2FtZTpzY29yZVNhdmVkJywge2RldGFpbDoge2RhdGF9fSkpO1xuXG4gICAgICAgICAgICAgICAgdGhpcy5mZWVkYmFja01lc3NhZ2UuaW5uZXJIVE1MID0gJ1lvdXIgc2NvcmUgaGFzIGJlZW4gc2F2ZWQsIFByZXNzIDxzdHJvbmc+LUVTQy08L3N0cm9uZz4gdG8gcmV0dXJuIHRvIHRoZSBwcmV2aW91cyBzY3JlZW4hJztcbiAgICAgICAgICAgICAgICB0aGlzLmZvcm0uY2xhc3NMaXN0LmFkZCgnaXMtaGlkZGVuJyk7XG4gICAgICAgICAgICAgICAgdGhpcy5mZWVkYmFja01lc3NhZ2UuY2xhc3NMaXN0LnJlbW92ZSgnaXMtaGlkZGVuJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRlbXBsYXRlIG5lZWRlZCB0byBzaG93IG1vcmUgZWxlbWVudHNcbiAgICAgKi9cbiAgICBwcml2YXRlIHJlbmRlclRlbXBsYXRlKCk6IHZvaWQge1xuICAgICAgICB0aGlzLmVsLmlubmVySFRNTCA9IGBcbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJtb2RhbC1iYWNrZ3JvdW5kXCI+PC9kaXY+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVwibW9kYWwtY29udGVudFwiPlxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJtZXNzYWdlXCI+XG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJtZXNzYWdlLWhlYWRlclwiPlBsZWFzZSBlbnRlciB5b3VyIG5hbWU8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cIm1lc3NhZ2UtYm9keVwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgPHAgY2xhc3M9XCJmZWVkYmFjay1tZXNzYWdlIGlzLWhpZGRlblwiPjwvcD5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxmb3JtIG1ldGhvZD1cInBvc3RcIiBhY3Rpb249XCJcIiBjbGFzcz1cIm5hbWUtZm9ybVwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJjb250cm9sIGhhcy1pY29ucy1sZWZ0XCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxpbnB1dCBuYW1lPVwibmFtZVwiIGNsYXNzPVwibmFtZSBpbnB1dCBpcy1wcmltYXJ5XCIgdHlwZT1cInRleHRcIiBwbGFjZWhvbGRlcj1cIkVudGVyIHlvdXIgbmFtZS4uXCIgbWF4bGVuZ3RoPVwiMTZcIiBhdXRvY29tcGxldGU9XCJvZmZcIi8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPVwiaWNvbiBpcy1zbWFsbCBpcy1sZWZ0XCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aSBjbGFzcz1cImZhcyBmYS11c2VyXCI+PC9pPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3NwYW4+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cImNvbnRyb2xcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9XCJzdWJtaXRcIiBjbGFzcz1cImlucHV0IGJ1dHRvblwiIHZhbHVlPVwiU2F2ZSBzY29yZVwiLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvZm9ybT5cbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgYDtcbiAgICB9XG59XG4iLCJpbXBvcnQgU2NvcmUgZnJvbSAnLi9zY29yZSc7XG5pbXBvcnQgTWVzc2FnZVNjcmVlbiBmcm9tICcuL21lc3NhZ2VzY3JlZW4nO1xuaW1wb3J0IERvbUVsZW1lbnQgZnJvbSBcIi4uL2hlbHBlcnMvZG9tZWxlbWVudFwiO1xuaW1wb3J0IEhpZ2hTY29yZUxpc3QgZnJvbSBcIi4vaGlnaHNjb3JlbGlzdFwiO1xuaW1wb3J0IE5hbWVGb3JtIGZyb20gJy4vbmFtZWZvcm0nO1xuaW1wb3J0IFdpbmRvd0V2ZW50SGFuZGxlciBmcm9tIFwiLi4vaGVscGVycy93aW5kb3dldmVudGhhbmRsZXJcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgR1VJIGV4dGVuZHMgRG9tRWxlbWVudCB7XG4gICAgcHJpdmF0ZSBzY29yZTogU2NvcmU7XG4gICAgcHJpdmF0ZSBtZXNzYWdlU2NyZWVuOiBNZXNzYWdlU2NyZWVuO1xuICAgIHByaXZhdGUgbmFtZUZvcm06IE5hbWVGb3JtO1xuICAgIHByaXZhdGUgbmFtZUZvcm1WaXNpYmxlOiBib29sZWFuID0gZmFsc2U7XG4gICAgcHJpdmF0ZSBoaWdoU2NvcmVMaXN0OiBIaWdoU2NvcmVMaXN0O1xuICAgIHByaXZhdGUgaGlnaFNjb3JlTGlzdFZpc2libGU6IGJvb2xlYW4gPSBmYWxzZTtcblxuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICBzdXBlcignZ3VpJywgLTEsIC0xKTtcblxuICAgICAgICB0aGlzLnNjb3JlID0gbmV3IFNjb3JlKCk7XG4gICAgICAgIHRoaXMubWVzc2FnZVNjcmVlbiA9IG5ldyBNZXNzYWdlU2NyZWVuKCk7XG4gICAgICAgIHRoaXMubmFtZUZvcm0gPSBuZXcgTmFtZUZvcm0oKTtcbiAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2xldmVsOnNjb3JlVXBkYXRlJywgKGUpID0+IHRoaXMuc2NvcmUudXBkYXRlKChlIGFzIEN1c3RvbUV2ZW50KS5kZXRhaWwuc2NvcmUpKTtcblxuICAgICAgICB0aGlzLmhpZ2hTY29yZUxpc3QgPSBuZXcgSGlnaFNjb3JlTGlzdCgpO1xuICAgICAgICBXaW5kb3dFdmVudEhhbmRsZXIuYWRkRXZlbnRMaXN0ZW5lcigna2V5dXAuaGlnaHNjb3JlbGlzdCcsIChlOiBLZXlib2FyZEV2ZW50KSA9PiB0aGlzLmtleUJvYXJkSGFuZGxlcihlKSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogSGFuZGxlIHRoZSBzcGFjZWJhclxuICAgICAqXG4gICAgICogQHBhcmFtIHtLZXlib2FyZEV2ZW50fSBlXG4gICAgICovXG4gICAga2V5Qm9hcmRIYW5kbGVyKGU6IEtleWJvYXJkRXZlbnQpOiB2b2lkIHtcbiAgICAgICAgbGV0IGtleSA9IGUua2V5LnRvTG93ZXJDYXNlKCk7XG5cbiAgICAgICAgLy9DaGVja3MgZm9yIHRoZSBoaWdoIHNjb3JlIG1vZGFsIHNob3cvaGlkZVxuICAgICAgICBpZiAoa2V5ID09PSAnaCcgJiYgdGhpcy5oaWdoU2NvcmVMaXN0VmlzaWJsZSA9PT0gZmFsc2UgJiYgdGhpcy5uYW1lRm9ybVZpc2libGUgPT09IGZhbHNlKSB7XG4gICAgICAgICAgICB0aGlzLmhpZ2hTY29yZUxpc3RWaXNpYmxlID0gdHJ1ZTtcbiAgICAgICAgICAgIHRoaXMuaGlnaFNjb3JlTGlzdC5zaG93KCk7XG4gICAgICAgICAgICB0aGlzLm1lc3NhZ2VTY3JlZW4uaXNBY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgfSBlbHNlIGlmIChrZXkgPT09ICdlc2NhcGUnICYmIHRoaXMuaGlnaFNjb3JlTGlzdFZpc2libGUgPT09IHRydWUpIHtcbiAgICAgICAgICAgIHRoaXMuaGlnaFNjb3JlTGlzdFZpc2libGUgPSBmYWxzZTtcbiAgICAgICAgICAgIHRoaXMuaGlnaFNjb3JlTGlzdC5oaWRlKCk7XG4gICAgICAgICAgICB0aGlzLm1lc3NhZ2VTY3JlZW4uaXNBY3RpdmUgPSB0cnVlO1xuICAgICAgICB9XG5cbiAgICAgICAgLy9DaGVja3MgZm9yIHRoZSBuYW1lIGVudGVyaW5nIG1vZGFsIHNob3cvaGlkZVxuICAgICAgICBpZiAoa2V5ID09PSAnbicgJiYgdGhpcy5oaWdoU2NvcmVMaXN0VmlzaWJsZSA9PT0gZmFsc2UgJiYgdGhpcy5uYW1lRm9ybVZpc2libGUgPT09IGZhbHNlICYmIHRoaXMubWVzc2FnZVNjcmVlbi5jdXJyZW50RXZlbnQgPT09ICdnYW1lOmVuZCcpIHtcbiAgICAgICAgICAgIHRoaXMubmFtZUZvcm1WaXNpYmxlID0gdHJ1ZTtcbiAgICAgICAgICAgIHRoaXMubmFtZUZvcm0uc2hvdyh0aGlzLnNjb3JlLmdldCgpKTtcbiAgICAgICAgICAgIHRoaXMubWVzc2FnZVNjcmVlbi5pc0FjdGl2ZSA9IGZhbHNlO1xuICAgICAgICB9IGVsc2UgaWYgKGtleSA9PT0gJ2VzY2FwZScgJiYgdGhpcy5uYW1lRm9ybVZpc2libGUgPT09IHRydWUpIHtcbiAgICAgICAgICAgIHRoaXMubmFtZUZvcm1WaXNpYmxlID0gZmFsc2U7XG4gICAgICAgICAgICB0aGlzLm5hbWVGb3JtLmhpZGUoKTtcbiAgICAgICAgICAgIHRoaXMubWVzc2FnZVNjcmVlbi5pc0FjdGl2ZSA9IHRydWU7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUcmlnZ2VyZWQgd2hlbiBhIGxldmVsIGlzIGRvbmVcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSB0eXBlXG4gICAgICovXG4gICAgcHVibGljIHNob3codHlwZTogc3RyaW5nKTogdm9pZCB7XG4gICAgICAgIHRoaXMubWVzc2FnZVNjcmVlbi5zaG93KHR5cGUpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRyaWdnZXJlZCB3aGVuIGEgbmV3IGxldmVsIHN0YXJ0c1xuICAgICAqL1xuICAgIHB1YmxpYyBoaWRlKCk6IHZvaWQge1xuICAgICAgICB0aGlzLm1lc3NhZ2VTY3JlZW4uaGlkZSgpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRyaWdnZXJlZCB3aGVuIHRoZSBnYW1lIGlzIGRvbmVcbiAgICAgKlxuICAgICAqIEBwYXJhbSBtYXhTY29yZVxuICAgICAqL1xuICAgIHB1YmxpYyBnYW1lRW5kKG1heFNjb3JlOiBudW1iZXIpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5tZXNzYWdlU2NyZWVuLnNob3coJ2dhbWU6ZW5kJywge1xuICAgICAgICAgICAgJ19fU0NPUkVfXyc6IHRoaXMuc2NvcmUuZ2V0KCkudG9TdHJpbmcoKSxcbiAgICAgICAgICAgICdfX01BWF9TQ09SRV9fJzogbWF4U2NvcmUudG9TdHJpbmcoKVxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUcmlnZ2VyZWQgd2hlbiB3ZSBuZWVkIHRvIHJlc3RhcnQsIGdvIHRvIGZpcnN0IHNjcmVlbiBhbmQgc2V0IHNjb3JlIHRvIDBcbiAgICAgKi9cbiAgICBwdWJsaWMgcmVzdGFydCgpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5tZXNzYWdlU2NyZWVuLmhpZGUoKTtcbiAgICAgICAgdGhpcy5tZXNzYWdlU2NyZWVuLnNob3coJ2dhbWU6c3RhcnQnKTtcbiAgICAgICAgdGhpcy5zY29yZS51cGRhdGUoMCwgdHJ1ZSk7XG4gICAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgVXRpbHMge1xuICAgIC8qKlxuICAgICAqIEByZXR1cm5zIHtzdHJpbmd9XG4gICAgICovXG4gICAgc3RhdGljIGdldFJhbmRvbUNvbG9yKCk6IHN0cmluZyB7XG4gICAgICAgIGxldCBvID0gTWF0aC5yb3VuZCwgciA9IE1hdGgucmFuZG9tLCBzID0gMjU1O1xuICAgICAgICByZXR1cm4gYHJnYmEoJHtvKHIoKSAqIHMpfSwke28ocigpICogcyl9LCR7byhyKCkgKiBzKX0sMSlgO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBtaW5cbiAgICAgKiBAcGFyYW0ge251bWJlcn0gbWF4XG4gICAgICogQHJldHVybnMge251bWJlcn1cbiAgICAgKi9cbiAgICBzdGF0aWMgZ2V0UmFuZG9tSW50KG1pbjogbnVtYmVyLCBtYXg6IG51bWJlcik6IG51bWJlciB7XG4gICAgICAgIHJldHVybiBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAobWF4IC0gbWluICsgMSkpICsgbWluO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7Q2xpZW50UmVjdH0gYVxuICAgICAqIEBwYXJhbSB7Q2xpZW50UmVjdH0gYlxuICAgICAqIEByZXR1cm5zIHtib29sZWFufVxuICAgICAqL1xuICAgIHN0YXRpYyBjaGVja0NvbGxpc2lvbihhOiBDbGllbnRSZWN0LCBiOiBDbGllbnRSZWN0KTogYm9vbGVhbiB7XG4gICAgICAgIHJldHVybiAoYS5sZWZ0IDw9IGIucmlnaHQgJiZcbiAgICAgICAgICAgIGIubGVmdCA8PSBhLnJpZ2h0ICYmXG4gICAgICAgICAgICBhLnRvcCA8PSBiLmJvdHRvbSAmJlxuICAgICAgICAgICAgYi50b3AgPD0gYS5ib3R0b20pO1xuICAgIH1cbn1cbiIsImltcG9ydCBEb21FbGVtZW50IGZyb20gXCIuLi9oZWxwZXJzL2RvbWVsZW1lbnRcIjtcbmltcG9ydCBVdGlscyBmcm9tIFwiLi4vaGVscGVycy91dGlsc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBCbG9jayBleHRlbmRzIERvbUVsZW1lbnQge1xuICAgIHByaXZhdGUgcmVhZG9ubHkgc3BlZWQ6IG51bWJlcjtcbiAgICBwcml2YXRlIHJlYWRvbmx5IHdpZHRoOiBudW1iZXI7XG4gICAgcHJpdmF0ZSByZWFkb25seSBoZWlnaHQ6IG51bWJlcjtcbiAgICBwdWJsaWMgY29sb3I6IHN0cmluZztcbiAgICBwcml2YXRlIGRlc3RpbmF0aW9uID0ge3g6IDAsIHk6IDB9O1xuXG4gICAgY29uc3RydWN0b3IoY29sb3I6IHN0cmluZywgc3BlZWQ6IG51bWJlciwgd2lkdGg6IG51bWJlciwgaGVpZ2h0OiBudW1iZXIpIHtcbiAgICAgICAgc3VwZXIoJ2Jsb2NrJywgMCwgMCwgJ2xldmVsJyk7XG5cbiAgICAgICAgdGhpcy5zcGVlZCA9IHNwZWVkO1xuICAgICAgICB0aGlzLndpZHRoID0gd2lkdGg7XG4gICAgICAgIHRoaXMuaGVpZ2h0ID0gaGVpZ2h0O1xuICAgICAgICB0aGlzLmNvbG9yID0gY29sb3I7XG5cbiAgICAgICAgdGhpcy5lbC5zdHlsZS5iYWNrZ3JvdW5kSW1hZ2UgPSBgcmVwZWF0aW5nLWxpbmVhci1ncmFkaWVudCgke1V0aWxzLmdldFJhbmRvbUludCgwLCAzNjApfWRlZywgIzAwMDAwMCwgIzAwMDAwMCAke1V0aWxzLmdldFJhbmRvbUludCgyLCAxMCl9cHgsICR7dGhpcy5jb2xvcn0gMTBweCwgJHt0aGlzLmNvbG9yfSAke1V0aWxzLmdldFJhbmRvbUludCgyMCwgNDApfXB4KWA7XG4gICAgICAgIHRoaXMuZWwuc3R5bGUud2lkdGggPSBgJHt0aGlzLndpZHRofXB4YDtcbiAgICAgICAgdGhpcy5lbC5zdHlsZS5oZWlnaHQgPSBgJHt0aGlzLmhlaWdodH1weGA7XG5cbiAgICAgICAgdGhpcy54ID0gVXRpbHMuZ2V0UmFuZG9tSW50KDAsICh3aW5kb3cub3V0ZXJXaWR0aCAtIHRoaXMud2lkdGgpKTtcbiAgICAgICAgdGhpcy55ID0gVXRpbHMuZ2V0UmFuZG9tSW50KDAsIChkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50SGVpZ2h0IC0gdGhpcy5oZWlnaHQpKTtcbiAgICAgICAgdGhpcy5lbC5zdHlsZS50cmFuc2Zvcm0gPSBgdHJhbnNsYXRlKCR7dGhpcy54fXB4LCAke3RoaXMueX1weClgO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEhhbmRsZXIgZm9yIGNsaWNraW5nIHRoZSBibG9ja3NcbiAgICAgKi9cbiAgICBwdWJsaWMgZGVzdHJveSgpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5lbC5yZW1vdmUoKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBNYWluIHVwZGF0ZSBoYW5kbGVyIGZvciB0aGUgZ2FtZSBmb3IgbW92aW5nIG91ciBibG9jayByYW5kb21seSBvdmVyIHRoZSBzY3JlZW5cbiAgICAgKi9cbiAgICBwdWJsaWMgdXBkYXRlKCk6IHZvaWQge1xuICAgICAgICBpZiAodGhpcy54ID4gKHRoaXMuZGVzdGluYXRpb24ueCAtIHRoaXMuc3BlZWQpICYmIHRoaXMueCA8ICh0aGlzLmRlc3RpbmF0aW9uLnggKyB0aGlzLnNwZWVkKSkge1xuICAgICAgICAgICAgdGhpcy5kZXN0aW5hdGlvbi54ID0gVXRpbHMuZ2V0UmFuZG9tSW50KDAsICh3aW5kb3cub3V0ZXJXaWR0aCAtIHRoaXMud2lkdGgpKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy55ID4gKHRoaXMuZGVzdGluYXRpb24ueSAtIHRoaXMuc3BlZWQpICYmIHRoaXMueSA8ICh0aGlzLmRlc3RpbmF0aW9uLnkgKyB0aGlzLnNwZWVkKSkge1xuICAgICAgICAgICAgdGhpcy5kZXN0aW5hdGlvbi55ID0gVXRpbHMuZ2V0UmFuZG9tSW50KDAsIChkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50SGVpZ2h0IC0gdGhpcy5oZWlnaHQpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0aGlzLmRlc3RpbmF0aW9uLnggPj0gdGhpcy54KSB7XG4gICAgICAgICAgICB0aGlzLnggKz0gdGhpcy5zcGVlZDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMueCAtPSB0aGlzLnNwZWVkO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHRoaXMuZGVzdGluYXRpb24ueSA+PSB0aGlzLnkpIHtcbiAgICAgICAgICAgIHRoaXMueSArPSB0aGlzLnNwZWVkO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy55IC09IHRoaXMuc3BlZWQ7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLmVsLnN0eWxlLnRyYW5zZm9ybSA9IGB0cmFuc2xhdGUoJHt0aGlzLnh9cHgsICR7dGhpcy55fXB4KWA7XG4gICAgfVxufVxuIiwiaW1wb3J0IGNvbmZpZyBmcm9tICcuLi9jb25maWcuanNvbic7XG5pbXBvcnQgRG9tRWxlbWVudCBmcm9tIFwiLi4vaGVscGVycy9kb21lbGVtZW50XCI7XG5pbXBvcnQgQmxvY2sgZnJvbSBcIi4vYmxvY2tcIjtcbmltcG9ydCBXaW5kb3dFdmVudEhhbmRsZXIgZnJvbSBcIi4uL2hlbHBlcnMvd2luZG93ZXZlbnRoYW5kbGVyXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBsYXllciBleHRlbmRzIERvbUVsZW1lbnQge1xuICAgIHByaXZhdGUgaGVpZ2h0OiBudW1iZXIgPSAxMDtcbiAgICBwcml2YXRlIHdpZHRoOiBudW1iZXIgPSAxMDtcbiAgICBwcml2YXRlIGdyb3d0aEZhY3RvcjogbnVtYmVyID0gY29uZmlnLmdhbWUucGxheWVyLmdyb3d0aEZhY3RvcjtcbiAgICBwcml2YXRlIHNwZWVkOiBudW1iZXIgPSBjb25maWcuZ2FtZS5wbGF5ZXIuc3BlZWQ7XG4gICAgcHJpdmF0ZSBzcGVlZEluY3JlYXNlRmFjdG9yOiBudW1iZXIgPSBjb25maWcuZ2FtZS5wbGF5ZXIuc3BlZWRJbmNyZWFzZUZhY3RvcjtcbiAgICBwcml2YXRlIGtleXNBbGxvd2VkOiBzdHJpbmdbXSA9IFsnYXJyb3dsZWZ0JywgJ2Fycm93dXAnLCAnYXJyb3dyaWdodCcsICdhcnJvd2Rvd24nXTtcbiAgICBwcml2YXRlIGtleXNQcmVzc2VkOiBzdHJpbmdbXSA9IFtdO1xuXG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHN1cGVyKCdwbGF5ZXInLCAwLCAwLCAnbGV2ZWwnKTtcbiAgICAgICAgdGhpcy54ID0gd2luZG93Lm91dGVyV2lkdGggLyAyIC0gdGhpcy53aWR0aCAvIDI7XG4gICAgICAgIHRoaXMueSA9IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRIZWlnaHQgLyAyIC0gdGhpcy5oZWlnaHQgLyAyO1xuXG4gICAgICAgIHRoaXMuZWwuc3R5bGUud2lkdGggPSBgJHt0aGlzLndpZHRofXB4YDtcbiAgICAgICAgdGhpcy5lbC5zdHlsZS5oZWlnaHQgPSBgJHt0aGlzLmhlaWdodH1weGA7XG4gICAgICAgIHRoaXMuZWwuc3R5bGUuYm9yZGVyUmFkaXVzID0gYCR7dGhpcy53aWR0aH1weGA7XG5cbiAgICAgICAgV2luZG93RXZlbnRIYW5kbGVyLmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24ucGxheWVyJywgKGU6IEtleWJvYXJkRXZlbnQpID0+IHRoaXMua2V5RG93bkhhbmRsZXIoZSkpO1xuICAgICAgICBXaW5kb3dFdmVudEhhbmRsZXIuYWRkRXZlbnRMaXN0ZW5lcigna2V5dXAucGxheWVyJywgKGU6IEtleWJvYXJkRXZlbnQpID0+IHRoaXMua2V5VXBIYW5kbGVyKGUpKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBLZXkgZG93biBoYW5kbGVyIGZvciBtb3ZpbmcgdGhlIHBsYXllclxuICAgICAqXG4gICAgICogQHBhcmFtIGVcbiAgICAgKi9cbiAgICBwcml2YXRlIGtleURvd25IYW5kbGVyKGU6IEtleWJvYXJkRXZlbnQpOiB2b2lkIHtcbiAgICAgICAgbGV0IGtleSA9IGUua2V5LnRvTG93ZXJDYXNlKCk7XG4gICAgICAgIGlmICh0aGlzLmtleXNBbGxvd2VkLmluZGV4T2Yoa2V5KSA+IC0xICYmIHRoaXMua2V5c1ByZXNzZWQuaW5kZXhPZihrZXkpID09PSAtMSkge1xuICAgICAgICAgICAgdGhpcy5rZXlzUHJlc3NlZC5wdXNoKGtleSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBLZXkgZG93biBoYW5kbGVyIGZvciBtb3ZpbmcgdGhlIHBsYXllclxuICAgICAqXG4gICAgICogQHBhcmFtIGVcbiAgICAgKi9cbiAgICBwcml2YXRlIGtleVVwSGFuZGxlcihlOiBLZXlib2FyZEV2ZW50KTogdm9pZCB7XG4gICAgICAgIGxldCBrZXkgPSBlLmtleS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICBsZXQga2V5UHJlc3NlZFBvc2l0aW9uID0gdGhpcy5rZXlzUHJlc3NlZC5pbmRleE9mKGtleSk7XG4gICAgICAgIGlmICh0aGlzLmtleXNBbGxvd2VkLmluZGV4T2Yoa2V5KSA+IC0xICYmIGtleVByZXNzZWRQb3NpdGlvbiA+IC0xKSB7XG4gICAgICAgICAgICB0aGlzLmtleXNQcmVzc2VkLnNwbGljZShrZXlQcmVzc2VkUG9zaXRpb24sIDEpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVXBkYXRlIHRoZSBhY3R1YWwgcG9zaXRpb24gYmFzZWQgb24gZWFybGllciBldmVudHNcbiAgICAgKi9cbiAgICBwdWJsaWMgdXBkYXRlKCk6IHZvaWQge1xuICAgICAgICB0aGlzLmtleXNQcmVzc2VkLmZvckVhY2goKGtleSkgPT4ge1xuICAgICAgICAgICAgc3dpdGNoIChrZXkpIHtcbiAgICAgICAgICAgICAgICBjYXNlICdhcnJvd2xlZnQnOlxuICAgICAgICAgICAgICAgICAgICB0aGlzLnggLT0gdGhpcy5zcGVlZDtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICBjYXNlICdhcnJvd3VwJzpcbiAgICAgICAgICAgICAgICAgICAgdGhpcy55IC09IHRoaXMuc3BlZWQ7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgY2FzZSAnYXJyb3dyaWdodCc6XG4gICAgICAgICAgICAgICAgICAgIHRoaXMueCArPSB0aGlzLnNwZWVkO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgIGNhc2UgJ2Fycm93ZG93bic6XG4gICAgICAgICAgICAgICAgICAgIHRoaXMueSArPSB0aGlzLnNwZWVkO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy9DaGVja3MgdG8gc3RheSBpbiBib3VuZHNcbiAgICAgICAgaWYgKHRoaXMueCA8IDApIHtcbiAgICAgICAgICAgIHRoaXMueCA9IDA7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMueSA8IDApIHtcbiAgICAgICAgICAgIHRoaXMueSA9IDA7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMueCA+ICh3aW5kb3cub3V0ZXJXaWR0aCAtIHRoaXMud2lkdGgpKSB7XG4gICAgICAgICAgICB0aGlzLnggPSAod2luZG93Lm91dGVyV2lkdGggLSB0aGlzLndpZHRoKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy55ID4gKGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRIZWlnaHQgLSB0aGlzLmhlaWdodCkpIHtcbiAgICAgICAgICAgIHRoaXMueSA9IChkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50SGVpZ2h0IC0gdGhpcy5oZWlnaHQpO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5lbC5zdHlsZS50cmFuc2Zvcm0gPSBgdHJhbnNsYXRlKCR7dGhpcy54fXB4LCAke3RoaXMueX1weClgO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFVwZGF0ZSBwbGF5ZXIgd2hlbiBhIGJsb2NrIGdvdCBjYXVnaHRcbiAgICAgKlxuICAgICAqIEBwYXJhbSBibG9ja1xuICAgICAqL1xuICAgIHB1YmxpYyBibG9ja0NhdWdodChibG9jazogQmxvY2spOiB2b2lkIHtcbiAgICAgICAgdGhpcy5zcGVlZCArPSB0aGlzLnNwZWVkSW5jcmVhc2VGYWN0b3I7XG4gICAgICAgIHRoaXMud2lkdGggKz0gdGhpcy5ncm93dGhGYWN0b3I7XG4gICAgICAgIHRoaXMuaGVpZ2h0ICs9IHRoaXMuZ3Jvd3RoRmFjdG9yO1xuXG4gICAgICAgIHRoaXMuZWwuc3R5bGUuaGVpZ2h0ID0gYCR7dGhpcy5oZWlnaHR9cHhgO1xuICAgICAgICB0aGlzLmVsLnN0eWxlLndpZHRoID0gYCR7dGhpcy53aWR0aH1weGA7XG4gICAgICAgIHRoaXMuZWwuc3R5bGUuYm9yZGVyUmFkaXVzID0gYCR7dGhpcy53aWR0aH1weGA7XG4gICAgICAgIHRoaXMuZWwuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gYmxvY2suY29sb3I7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2xlYW4gdXAhXG4gICAgICovXG4gICAgcHVibGljIGRlc3Ryb3koKTogdm9pZCB7XG4gICAgICAgIHRoaXMuZWwucmVtb3ZlKCk7XG4gICAgICAgIFdpbmRvd0V2ZW50SGFuZGxlci5yZW1vdmVFdmVudExpc3RlbmVyKCdrZXlkb3duLnBsYXllcicpO1xuICAgICAgICBXaW5kb3dFdmVudEhhbmRsZXIucmVtb3ZlRXZlbnRMaXN0ZW5lcigna2V5dXAucGxheWVyJyk7XG4gICAgfVxufVxuIiwiaW1wb3J0IGNvbmZpZyBmcm9tICcuLi9jb25maWcuanNvbic7XG5pbXBvcnQgRG9tRWxlbWVudCBmcm9tIFwiLi4vaGVscGVycy9kb21lbGVtZW50XCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFRpbWVyIGV4dGVuZHMgRG9tRWxlbWVudCB7XG4gICAgc2Vjb25kczogbnVtYmVyID0gY29uZmlnLmdhbWUuc2Vjb25kc1BlckxldmVsO1xuICAgIGludGVydmFsSWQ6IG51bWJlcjtcblxuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICBzdXBlcigndGltZXInLCAtMSwgLTEsICdsZXZlbCcpO1xuXG4gICAgICAgIHRoaXMucmVuZGVyVGVtcGxhdGUoKTtcbiAgICAgICAgdGhpcy5lbC5jbGFzc0xpc3QuYWRkKCdtZXNzYWdlJywgJ2lzLXByaW1hcnknKTtcbiAgICAgICAgdGhpcy5lbC5xdWVyeVNlbGVjdG9yKCcuc2Vjb25kcycpLmlubmVySFRNTCA9IHRoaXMuc2Vjb25kcy50b1N0cmluZygpO1xuXG4gICAgICAgIHRoaXMuaW50ZXJ2YWxJZCA9IHNldEludGVydmFsKCgpID0+IHRoaXMudXBkYXRlKCksIDEwMDApO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENvdW50ZG93biBvZiBzZWNvbmRzXG4gICAgICovXG4gICAgcHJpdmF0ZSB1cGRhdGUoKTogdm9pZCB7XG4gICAgICAgIHRoaXMuc2Vjb25kcy0tO1xuICAgICAgICB0aGlzLmVsLnF1ZXJ5U2VsZWN0b3IoJy5zZWNvbmRzJykuaW5uZXJIVE1MID0gdGhpcy5zZWNvbmRzLnRvU3RyaW5nKCk7XG5cbiAgICAgICAgaWYgKHRoaXMuc2Vjb25kcyA8PSAzKSB7XG4gICAgICAgICAgICB0aGlzLmVsLmNsYXNzTGlzdC5yZW1vdmUoJ2lzLXByaW1hcnknKTtcbiAgICAgICAgICAgIHRoaXMuZWwuY2xhc3NMaXN0LmFkZCgnaXMtZGFuZ2VyJyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmVsLmNsYXNzTGlzdC5hZGQoJ2lzLXByaW1hcnknKTtcbiAgICAgICAgICAgIHRoaXMuZWwuY2xhc3NMaXN0LnJlbW92ZSgnaXMtZGFuZ2VyJyk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGhpcy5zZWNvbmRzID09PSAwKSB7XG4gICAgICAgICAgICB3aW5kb3cuZGlzcGF0Y2hFdmVudChuZXcgRXZlbnQoJ3RpbWVyOmRvbmUnKSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwdWJsaWMgZGVzdHJveSgpOiB2b2lkIHtcbiAgICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLmludGVydmFsSWQpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRlbXBsYXRlIG5lZWRlZCB0byBzaG93IG1vcmUgZWxlbWVudHNcbiAgICAgKi9cbiAgICBwcml2YXRlIHJlbmRlclRlbXBsYXRlKCk6IHZvaWQge1xuICAgICAgICB0aGlzLmVsLmlubmVySFRNTCA9IGBcbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJtZXNzYWdlLWJvZHlcIj5cbiAgICAgICAgICAgICAgICA8c3Bhbj50aW1lOiA8L3NwYW4+XG4gICAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9XCJzZWNvbmRzXCI+PC9zcGFuPlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgIGA7XG4gICAgfVxufVxuIiwiaW1wb3J0IGNvbmZpZyBmcm9tICcuLi9jb25maWcuanNvbic7XG5pbXBvcnQgRG9tRWxlbWVudCBmcm9tIFwiLi4vaGVscGVycy9kb21lbGVtZW50XCI7XG5pbXBvcnQgQmxvY2sgZnJvbSBcIi4vYmxvY2tcIjtcbmltcG9ydCBQbGF5ZXIgZnJvbSBcIi4vcGxheWVyXCI7XG5pbXBvcnQgVGltZXIgZnJvbSBcIi4vdGltZXJcIjtcbmltcG9ydCBVdGlscyBmcm9tIFwiLi4vaGVscGVycy91dGlsc1wiO1xuaW1wb3J0IFdpbmRvd0V2ZW50SGFuZGxlciBmcm9tIFwiLi4vaGVscGVycy93aW5kb3dldmVudGhhbmRsZXJcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgTGV2ZWwgZXh0ZW5kcyBEb21FbGVtZW50IHtcbiAgICBwcml2YXRlIHJlYWRvbmx5IHRvdGFsQmxvY2tzOiBudW1iZXI7XG4gICAgcHJpdmF0ZSByZWFkb25seSBzY29yZVBlckJsb2NrOiBudW1iZXI7XG4gICAgcHJpdmF0ZSBibG9ja3M6IEJsb2NrW10gPSBbXTtcbiAgICBwcml2YXRlIHBsYXllcjogUGxheWVyO1xuICAgIHByaXZhdGUgdGltZXI6IFRpbWVyO1xuICAgIHB1YmxpYyBmYWlsZWQgPSBmYWxzZTtcblxuICAgIGNvbnN0cnVjdG9yKHRvdGFsQmxvY2tzOiBudW1iZXIsIHNjb3JlUGVyQmxvY2s6IG51bWJlcikge1xuICAgICAgICBzdXBlcignbGV2ZWwnLCAwLCAwKTtcblxuICAgICAgICB0aGlzLnRvdGFsQmxvY2tzID0gdG90YWxCbG9ja3M7XG4gICAgICAgIHRoaXMuc2NvcmVQZXJCbG9jayA9IHNjb3JlUGVyQmxvY2s7XG4gICAgICAgIHRoaXMucGxheWVyID0gbmV3IFBsYXllcigpO1xuICAgICAgICB0aGlzLnRpbWVyID0gbmV3IFRpbWVyKCk7XG5cbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLnRvdGFsQmxvY2tzOyBpKyspIHtcbiAgICAgICAgICAgIHRoaXMuYmxvY2tzLnB1c2gobmV3IEJsb2NrKFV0aWxzLmdldFJhbmRvbUNvbG9yKCksIFV0aWxzLmdldFJhbmRvbUludChjb25maWcuZ2FtZS5ibG9ja1NwZWVkLm1pbiwgY29uZmlnLmdhbWUuYmxvY2tTcGVlZC5tYXgpLCBVdGlscy5nZXRSYW5kb21JbnQoY29uZmlnLmdhbWUuYmxvY2tQaXhlbHMubWluLCBjb25maWcuZ2FtZS5ibG9ja1BpeGVscy5tYXgpLCBVdGlscy5nZXRSYW5kb21JbnQoY29uZmlnLmdhbWUuYmxvY2tQaXhlbHMubWluLCBjb25maWcuZ2FtZS5ibG9ja1BpeGVscy5tYXgpKSk7XG4gICAgICAgIH1cblxuICAgICAgICBXaW5kb3dFdmVudEhhbmRsZXIuYWRkRXZlbnRMaXN0ZW5lcigndGltZXI6ZG9uZScsICgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuZmFpbGVkID0gdHJ1ZTtcbiAgICAgICAgICAgIHRoaXMuZGVzdHJveSgnbGV2ZWw6ZmFpbGVkJyk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENoZWNrcyBmb3IgY29sbGlzaW9uIGFuZCBwb3RlbnRpYWwgc3VjY2VzcyBvZiB0aGlzIGxldmVsXG4gICAgICovXG4gICAgcHVibGljIHVwZGF0ZSgpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5wbGF5ZXIudXBkYXRlKCk7XG4gICAgICAgIHRoaXMuYmxvY2tzLmZvckVhY2goKGJsb2NrLCBpbmRleCkgPT4ge1xuICAgICAgICAgICAgYmxvY2sudXBkYXRlKCk7XG5cbiAgICAgICAgICAgIGlmIChVdGlscy5jaGVja0NvbGxpc2lvbih0aGlzLnBsYXllci5nZXRDbGllbnRSZWFjdCgpLCBibG9jay5nZXRDbGllbnRSZWFjdCgpKSAmJiB0aGlzLmZhaWxlZCA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnBsYXllci5ibG9ja0NhdWdodChibG9jayk7XG4gICAgICAgICAgICAgICAgYmxvY2suZGVzdHJveSgpO1xuICAgICAgICAgICAgICAgIHRoaXMuYmxvY2tzLnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgICAgICAgICAgd2luZG93LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCdsZXZlbDpzY29yZVVwZGF0ZScsIHtkZXRhaWw6IHtzY29yZTogdGhpcy5zY29yZVBlckJsb2NrfX0pKTtcblxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmJsb2Nrcy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5kZXN0cm95KCdsZXZlbDpzdWNjZXNzJyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBEZXN0cm95IG9iamVjdCAmIHRpbWVyIGFuZCB0cmlnZ2VyIGV2ZW50IHRvIG5vdGlmeSB0aGUgd29ybGQgYWJvdXQgdGhlIHN0YXR1cyBvZiB0aGlzIGxldmVsXG4gICAgICpcbiAgICAgKiBAcGFyYW0gZXZlbnRUeXBlXG4gICAgICovXG4gICAgcHJpdmF0ZSBkZXN0cm95KGV2ZW50VHlwZTogc3RyaW5nKTogdm9pZCB7XG4gICAgICAgIHRoaXMudGltZXIuZGVzdHJveSgpO1xuICAgICAgICB0aGlzLnBsYXllci5kZXN0cm95KCk7XG4gICAgICAgIHRoaXMuYmxvY2tzLmZvckVhY2goKGJsb2NrLCBpbmRleCkgPT4ge1xuICAgICAgICAgICAgYmxvY2suZGVzdHJveSgpO1xuICAgICAgICAgICAgdGhpcy5ibG9ja3Muc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgICAgfSk7XG4gICAgICAgIFdpbmRvd0V2ZW50SGFuZGxlci5yZW1vdmVFdmVudExpc3RlbmVyKCd0aW1lcjpkb25lJyk7XG4gICAgICAgIHdpbmRvdy5kaXNwYXRjaEV2ZW50KG5ldyBFdmVudChldmVudFR5cGUpKTtcbiAgICAgICAgdGhpcy5lbC5yZW1vdmUoKTtcbiAgICB9XG59XG4iLCJpbXBvcnQgR2FtZSBmcm9tICcuL2dhbWUnO1xuXG53aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcImxvYWRcIiwgKCkgPT4gbmV3IEdhbWUoKSk7XG4iLCJpbXBvcnQgY29uZmlnIGZyb20gJy4vY29uZmlnLmpzb24nO1xuaW1wb3J0IEdVSSBmcm9tICcuL2d1aS9ndWknO1xuaW1wb3J0IExldmVsIGZyb20gXCIuL2xldmVsL2xldmVsXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEdhbWUge1xuICAgIHByaXZhdGUgbGV2ZWw6IExldmVsO1xuICAgIHByaXZhdGUgbGV2ZWxzUGVyR2FtZTogbnVtYmVyID0gY29uZmlnLmdhbWUubGV2ZWxzUGVyR2FtZTtcbiAgICBwcml2YXRlIGN1cnJlbnRMZXZlbHNQbGF5ZWQ6IG51bWJlciA9IDA7XG4gICAgcHJpdmF0ZSBzdGFydEVsZW1lbnRzUGVyTGV2ZWw6IG51bWJlciA9IGNvbmZpZy5nYW1lLnN0YXJ0RWxlbWVudHNQZXJMZXZlbDtcbiAgICBwcml2YXRlIGVsZW1lbnRzSW5jcmVhc2VQZXJMZXZlbDogbnVtYmVyID0gY29uZmlnLmdhbWUuZWxlbWVudHNJbmNyZWFzZVBlckxldmVsO1xuICAgIHByaXZhdGUgc2NvcmVQZXJFbGVtZW50OiBudW1iZXIgPSBjb25maWcuZ2FtZS5zY29yZVBlckVsZW1lbnQ7XG4gICAgcHJpdmF0ZSByZWFkb25seSBtYXhTY29yZTogbnVtYmVyO1xuICAgIHByaXZhdGUgZ3VpOiBHVUk7XG5cbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgdGhpcy5ndWkgPSBuZXcgR1VJKCk7XG4gICAgICAgIHRoaXMubWF4U2NvcmUgPSB0aGlzLmNhbGN1bGF0ZU1heFNjb3JlKCk7XG4gICAgICAgIHRoaXMuZ2FtZUxvb3AoKTtcblxuICAgICAgICBbJ2xldmVsOnN1Y2Nlc3MnLCAnbGV2ZWw6ZmFpbGVkJ10ubWFwKChldmVudFR5cGUpID0+IHtcbiAgICAgICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKGV2ZW50VHlwZSwgKGUpID0+IHRoaXMudXBkYXRlKGUudHlwZSkpO1xuICAgICAgICB9KTtcbiAgICAgICAgWydnYW1lOnN0YXJ0OmNsaWNrJywgJ2xldmVsOnN1Y2Nlc3M6Y2xpY2snLCAnbGV2ZWw6ZmFpbGVkOmNsaWNrJ10ubWFwKChldmVudFR5cGUpID0+IHtcbiAgICAgICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKGV2ZW50VHlwZSwgKCkgPT4gdGhpcy5zdGFydE5ld0xldmVsKCkpO1xuICAgICAgICB9KTtcbiAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2dhbWU6ZW5kOmNsaWNrJywgKCkgPT4gdGhpcy5yZXN0YXJ0KCkpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENhbGN1bGF0ZSB0aGUgc2NvcmUgd2l0aCBhdmFpbGFibGUgcGFyYW1ldGVyc1xuICAgICAqXG4gICAgICogQHJldHVybnMge251bWJlcn1cbiAgICAgKi9cbiAgICBwcml2YXRlIGNhbGN1bGF0ZU1heFNjb3JlKCk6IG51bWJlciB7XG4gICAgICAgIGxldCBtYXhTY29yZSA9IDA7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5sZXZlbHNQZXJHYW1lOyBpKyspIHtcbiAgICAgICAgICAgIGxldCBlbGVtZW50cyA9IHRoaXMuc3RhcnRFbGVtZW50c1BlckxldmVsICsgKGkgPT09IDAgPyAwIDogKHRoaXMuZWxlbWVudHNJbmNyZWFzZVBlckxldmVsICogaSkpO1xuICAgICAgICAgICAgbWF4U2NvcmUgKz0gKGVsZW1lbnRzICogdGhpcy5zY29yZVBlckVsZW1lbnQpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBtYXhTY29yZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUaGUgb25seSBwbGFjZSBmb3IgYSByZXF1ZXN0QW5pbWF0aW9uRnJhbWVcbiAgICAgKi9cbiAgICBwcml2YXRlIGdhbWVMb29wKCk6IHZvaWQge1xuICAgICAgICBpZiAodHlwZW9mIHRoaXMubGV2ZWwgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICB0aGlzLmxldmVsLnVwZGF0ZSgpO1xuICAgICAgICB9XG4gICAgICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZSgoKSA9PiB0aGlzLmdhbWVMb29wKCkpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFVwZGF0ZSB0aGUgZ2FtZSBieSBlaXRoZXIgdGhlIGVuZCBvciBhbnl0aGluZyBpbiBiZXR3ZWVuIGxldmVsc1xuICAgICAqXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHR5cGVcbiAgICAgKi9cbiAgICBwcml2YXRlIHVwZGF0ZSh0eXBlOiBzdHJpbmcpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5jdXJyZW50TGV2ZWxzUGxheWVkKys7XG4gICAgICAgIGlmICh0aGlzLmN1cnJlbnRMZXZlbHNQbGF5ZWQgPT09IHRoaXMubGV2ZWxzUGVyR2FtZSkge1xuICAgICAgICAgICAgdGhpcy5ndWkuZ2FtZUVuZCh0aGlzLm1heFNjb3JlKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuZ3VpLnNob3codHlwZSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVGltZSB0byBzdGFydCBhIG5ldyBsZXZlbCB3aXRoIG1hZG5lc3NcbiAgICAgKi9cbiAgICBwcml2YXRlIHN0YXJ0TmV3TGV2ZWwoKTogdm9pZCB7XG4gICAgICAgIGlmICh0aGlzLmxldmVsICYmIHRoaXMubGV2ZWwuZmFpbGVkID09PSBmYWxzZSkge1xuICAgICAgICAgICAgdGhpcy5zdGFydEVsZW1lbnRzUGVyTGV2ZWwgKz0gdGhpcy5lbGVtZW50c0luY3JlYXNlUGVyTGV2ZWw7XG4gICAgICAgIH1cblxuICAgICAgICBkZWxldGUgdGhpcy5sZXZlbDtcbiAgICAgICAgdGhpcy5ndWkuaGlkZSgpO1xuXG4gICAgICAgIHRoaXMubGV2ZWwgPSBuZXcgTGV2ZWwodGhpcy5zdGFydEVsZW1lbnRzUGVyTGV2ZWwsIHRoaXMuc2NvcmVQZXJFbGVtZW50KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTdGFydCBldmVyeXRoaW5nIGZyb20gdGhlIGJlZ2lubmluZ1xuICAgICAqL1xuICAgIHByaXZhdGUgcmVzdGFydCgpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5ndWkucmVzdGFydCgpO1xuICAgICAgICB0aGlzLmN1cnJlbnRMZXZlbHNQbGF5ZWQgPSAwO1xuICAgICAgICB0aGlzLnN0YXJ0RWxlbWVudHNQZXJMZXZlbCA9IGNvbmZpZy5nYW1lLnN0YXJ0RWxlbWVudHNQZXJMZXZlbDtcbiAgICAgICAgZGVsZXRlIHRoaXMubGV2ZWw7XG4gICAgfVxufVxuIl0sInNvdXJjZVJvb3QiOiIifQ==