!function(e){var t={};function s(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,s),r.l=!0,r.exports}s.m=e,s.c=t,s.d=function(e,t,i){s.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:i})},s.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s(s.s=1)}([function(e){e.exports={game:{levelsPerGame:10,startElementsPerLevel:5,elementsIncreasePerLevel:5,scorePerElement:10,secondsPerLevel:10,blockSpeed:{min:1,max:5},blockPixels:{min:10,max:150},player:{growthFactor:1.5,speed:3,speedIncreaseFactor:.2}},functionalities:{dataService:!0},dataService:{baseUrl:"https://api.mlab.com/api/1",apiKey:"X17utv1FH2dFTeUo4yhNGL54sA7CY2jS",databaseName:"typescript_scores",collectionName:"scores"}}},function(e,t,s){"use strict";s.r(t);var i=s(0);class r{constructor(e,t,s,i=""){this.x=t,this.y=s,this.el=document.createElement("div");let r=document.getElementById("main");if(null===r)throw new Error("<main> element doesn't exist!");if(this.x>-1&&this.y>-1&&(this.el.style.transform=`translate(${this.x}px, ${this.y}px)`),this.el.classList.add(`game-${e}`),""===i)r.appendChild(this.el);else{let e=document.querySelector(`.game-${i}`);if(null===e)throw new Error(`<.game-${i}> element doesn't exist!`);e.appendChild(this.el)}}getClientReact(){return this.el.getBoundingClientRect()}}class n extends r{constructor(){super("score",-1,-1,"gui"),this.score=0,this.renderTemplate(),this.el.querySelector(".score-count").innerHTML=this.score.toString(),this.el.classList.add("message","is-warning")}get(){return this.score}update(e,t=!1){this.score=t?e:this.score+e,this.el.querySelector(".score-count").innerHTML=this.score.toString()}renderTemplate(){this.el.innerHTML='\n            <div class="message-body">\n                <span>score: </span>\n                <span class="score-count"></span>\n            </div>\n        '}}class a{static addEventListener(e,t){a.functionMap[e]=t,window.addEventListener(e.split(".")[0],a.functionMap[e])}static removeEventListener(e){window.removeEventListener(e.split(".")[0],a.functionMap[e]),delete a.functionMap[e]}}a.functionMap={};class o extends r{constructor(){super("messagescreen",-1,-1,"gui"),this.isActive=!1,this.messages={"game:start":{header:"Welcome to Block-o-Block!",body:"It's time to catch them blocks!<br/><br/>Use your arrow keys to move your player around and press space to start.<br/><br/>Press -<strong>H</strong>- to view the highscore list",className:"is-info"},"game:end":{header:"Your game is over!",body:"You made it, your final score is __SCORE__ out of max __MAX_SCORE__ points.<br/><br/>Thanks for playing, press space to restart the madness.<br/><br/>Press -<strong>H</strong>- to view the highscore list",className:"is-success"},"level:success":{header:"YEAH! Level completed!",body:"Performing like a boss! Press space to proceed to the next level and catch even more blocks",className:"is-success"},"level:failed":{header:"AAH! Level failed!",body:"Try again and show us what you're made off! Press space to restart this level",className:"is-danger"}},this.el.classList.add("message"),this.renderTemplate(),this.show("game:start"),a.addEventListener("keyup.messagescreen",e=>this.keyBoardHandler(e))}keyBoardHandler(e){32===e.keyCode&&!0===this.isActive&&window.dispatchEvent(new Event(`${this.currentEvent}:click`))}show(e,t={}){let s=this.messages[e].header,i=this.messages[e].body;for(let e in t)i=i.replace(e,t[e]);this.el.querySelector(".message-header").innerHTML=s,this.el.querySelector(".message-body").innerHTML=i,this.el.classList.add("show",this.messages[e].className),this.currentEvent=e,this.isActive=!0}hide(){this.el.classList.remove("show","is-info","is-success","is-danger"),this.isActive=!1}renderTemplate(){this.el.innerHTML='\n            <div class="message-header"></div>\n            <div class="message-body"></div>\n        '}}class h{constructor(){this.endPointList=`/databases/${i.dataService.databaseName}/collections/${i.dataService.collectionName}?apiKey=${i.dataService.apiKey}`,this.endPointSave=`/databases/${i.dataService.databaseName}/collections/${i.dataService.collectionName}?apiKey=${i.dataService.apiKey}`}saveScore(e){if(!1===i.functionalities.dataService)return this.disabled();let t=`${i.dataService.baseUrl}${this.endPointSave}`;return fetch(t,{body:JSON.stringify({score:e}),headers:{"content-type":"application/json"},method:"POST",mode:"cors"}).then(e=>e.json())}getScores(){if(!1===i.functionalities.dataService)return this.disabled();let e=`${i.dataService.baseUrl}${this.endPointList}&s={"score": -1}&l=10`;return fetch(e,{mode:"cors"}).then(e=>e.json())}disabled(){return new Promise(e=>{e({error:"Dataservice is disabled"})})}}class l extends r{constructor(){super("highscorelist",-1,-1,"gui"),this.el.classList.add("message","is-warning"),this.renderTemplate(),this.dataService=new h}show(){this.dataService.getScores().then(e=>{this.el.querySelector(".tbody").innerHTML=this.getTbodyTemplate(e),this.el.classList.add("show")})}hide(){this.el.classList.remove("show")}getTbodyTemplate(e){return`\n            ${e.map((e,t)=>`<tr>\n                <td>${t+1}</td>\n                <td>${e._id.$oid}</td>\n                <td>${e.score.toString()}</td>\n            </tr>`).join("")}\n        `}renderTemplate(){this.el.innerHTML='\n            <div class="message-header">\n                <p>Top 10 High Scores (press -<strong>esc</strong>- to return)</p>\n            </div>\n            <div class="message-body">\n                <table class="table">\n                    <thead>\n                    <tr>\n                        <th>#</th>\n                        <th>MongoID</th>\n                        <th>Score</th>\n                    </tr>\n                    </thead>\n                    <tbody class="tbody"></tbody>\n                </table>\n            </div>\n        '}}class d extends r{constructor(){super("gui",-1,-1),this.highScoreListVisible=!1,this.score=new n,this.messageScreen=new o,window.addEventListener("level:scoreUpdate",e=>this.score.update(e.detail.score)),!0===i.functionalities.dataService&&(this.highScoreList=new l,a.addEventListener("keyup.highscorelist",e=>this.keyBoardHandler(e)))}keyBoardHandler(e){72===e.keyCode&&!1===this.highScoreListVisible?(this.highScoreListVisible=!0,this.highScoreList.show()):27===e.keyCode&&!0===this.highScoreListVisible&&(this.highScoreListVisible=!1,this.highScoreList.hide())}levelDone(e){this.messageScreen.show(e)}newLevel(){this.messageScreen.hide()}gameEnd(e){this.messageScreen.show("game:end",{__SCORE__:this.score.get().toString(),__MAX_SCORE__:e.toString()})}restart(){this.messageScreen.hide(),this.messageScreen.show("game:start"),this.score.update(0,!0)}getScore(){return this.score.get()}}class c{static getRandomColor(){let e=Math.round,t=Math.random;return`rgba(${e(255*t())},${e(255*t())},${e(255*t())},1)`}static getRandomInt(e,t){return Math.floor(Math.random()*(t-e+1))+e}static checkCollision(e,t){return e.left<=t.right&&t.left<=e.right&&e.top<=t.bottom&&t.top<=e.bottom}}class m extends r{constructor(e,t,s,i){super("block",0,0,"level"),this.destination={x:0,y:0},this.speed=t,this.width=s,this.height=i,this.color=e,this.el.style.backgroundImage=`repeating-linear-gradient(${c.getRandomInt(0,360)}deg, #000000, #000000 ${c.getRandomInt(2,10)}px, ${this.color} 10px, ${this.color} ${c.getRandomInt(20,40)}px)`,this.el.style.width=`${this.width}px`,this.el.style.height=`${this.height}px`,this.x=c.getRandomInt(0,window.outerWidth-this.width),this.y=c.getRandomInt(0,document.documentElement.clientHeight-this.height),this.el.style.transform=`translate(${this.x}px, ${this.y}px)`}destroy(){this.el.remove()}update(){this.x>this.destination.x-this.speed&&this.x<this.destination.x+this.speed&&(this.destination.x=c.getRandomInt(0,window.outerWidth-this.width)),this.y>this.destination.y-this.speed&&this.y<this.destination.y+this.speed&&(this.destination.y=c.getRandomInt(0,document.documentElement.clientHeight-this.height)),this.destination.x>=this.x?this.x+=this.speed:this.x-=this.speed,this.destination.y>=this.y?this.y+=this.speed:this.y-=this.speed,this.el.style.transform=`translate(${this.x}px, ${this.y}px)`}}class p extends r{constructor(){super("player",0,0,"level"),this.height=10,this.width=10,this.growthFactor=i.game.player.growthFactor,this.speed=i.game.player.speed,this.speedIncreaseFactor=i.game.player.speedIncreaseFactor,this.keysAllowed=[37,38,39,40],this.keysPressed=[],this.x=window.outerWidth/2-this.width/2,this.y=document.documentElement.clientHeight/2-this.height/2,this.el.style.width=`${this.width}px`,this.el.style.height=`${this.height}px`,this.el.style.borderRadius=`${this.width}px`,a.addEventListener("keydown.player",e=>this.keyDownHandler(e)),a.addEventListener("keyup.player",e=>this.keyUpHandler(e))}keyDownHandler(e){let t=e.keyCode;this.keysAllowed.indexOf(t)>-1&&-1===this.keysPressed.indexOf(t)&&this.keysPressed.push(t)}keyUpHandler(e){let t=e.keyCode,s=this.keysPressed.indexOf(t);this.keysAllowed.indexOf(t)>-1&&s>-1&&this.keysPressed.splice(s,1)}update(){this.keysPressed.forEach(e=>{switch(e){case 37:this.x-=this.speed;break;case 38:this.y-=this.speed;break;case 39:this.x+=this.speed;break;case 40:this.y+=this.speed;break;default:return}}),this.x<0&&(this.x=0),this.y<0&&(this.y=0),this.x>window.outerWidth-this.width&&(this.x=window.outerWidth-this.width),this.y>document.documentElement.clientHeight-this.height&&(this.y=document.documentElement.clientHeight-this.height),this.el.style.transform=`translate(${this.x}px, ${this.y}px)`}blockCaught(e){this.speed+=this.speedIncreaseFactor,this.width+=this.growthFactor,this.height+=this.growthFactor,this.el.style.height=`${this.height}px`,this.el.style.width=`${this.width}px`,this.el.style.borderRadius=`${this.width}px`,this.el.style.backgroundColor=e.color}destroy(){a.removeEventListener("keydown.player"),a.removeEventListener("keyup.player")}}class g extends r{constructor(){super("timer",-1,-1,"level"),this.seconds=i.game.secondsPerLevel,this.renderTemplate(),this.el.classList.add("message","is-primary"),this.el.querySelector(".seconds").innerHTML=this.seconds.toString(),this.intervalId=setInterval(()=>this.update(),1e3)}update(){this.seconds--,this.el.querySelector(".seconds").innerHTML=this.seconds.toString(),this.seconds<=3?(this.el.classList.remove("is-primary"),this.el.classList.add("is-danger")):(this.el.classList.add("is-primary"),this.el.classList.remove("is-danger")),0===this.seconds&&window.dispatchEvent(new Event("timer:done"))}destroy(){clearInterval(this.intervalId)}renderTemplate(){this.el.innerHTML='\n            <div class="message-body">\n                <span>time: </span>\n                <span class="seconds"></span>\n            </div>\n        '}}class u extends r{constructor(e,t){super("level",0,0),this.blocks=[],this.failed=!1,this.totalBlocks=e,this.scorePerBlock=t,this.player=new p,this.timer=new g;for(let e=0;e<this.totalBlocks;e++)this.blocks.push(new m(c.getRandomColor(),c.getRandomInt(i.game.blockSpeed.min,i.game.blockSpeed.max),c.getRandomInt(i.game.blockPixels.min,i.game.blockPixels.max),c.getRandomInt(i.game.blockPixels.min,i.game.blockPixels.max)));a.addEventListener("timer:done",()=>{this.failed=!0,this.destroy("level:failed")})}update(){this.player.update(),this.blocks.forEach((e,t)=>{e.update(),c.checkCollision(this.player.getClientReact(),e.getClientReact())&&!1===this.failed&&(this.player.blockCaught(e),e.destroy(),this.blocks.splice(t,1),window.dispatchEvent(new CustomEvent("level:scoreUpdate",{detail:{score:this.scorePerBlock}})),0===this.blocks.length&&this.destroy("level:success"))})}destroy(e){this.timer.destroy(),this.player.destroy(),this.blocks.forEach((e,t)=>{e.destroy(),this.blocks.splice(t,1)}),a.removeEventListener("timer:done"),window.dispatchEvent(new Event(e)),this.el.remove()}}window.addEventListener("load",()=>new class{constructor(){this.levelsPerGame=i.game.levelsPerGame,this.currentLevelsPlayed=0,this.startElementsPerLevel=i.game.startElementsPerLevel,this.elementsIncreasePerLevel=i.game.elementsIncreasePerLevel,this.scorePerElement=i.game.scorePerElement,this.gui=new d,this.maxScore=this.calculateMaxScore(),this.gameLoop(),this.dataService=new h,["level:success","level:failed"].map(e=>{window.addEventListener(e,e=>this.update(e.type))}),["game:start:click","level:success:click","level:failed:click"].map(e=>{window.addEventListener(e,()=>this.startNewLevel())}),window.addEventListener("game:end:click",()=>this.restart())}calculateMaxScore(){let e=0;for(let t=0;t<this.levelsPerGame;t++)e+=(this.startElementsPerLevel+(0===t?0:this.elementsIncreasePerLevel*t))*this.scorePerElement;return e}gameLoop(){void 0!==this.level&&this.level.update(),requestAnimationFrame(()=>this.gameLoop())}update(e){if(this.currentLevelsPlayed++,this.currentLevelsPlayed===this.levelsPerGame)return this.gui.gameEnd(this.maxScore),void this.saveScore();this.gui.levelDone(e)}startNewLevel(){this.level&&!1===this.level.failed&&(this.startElementsPerLevel+=this.elementsIncreasePerLevel),delete this.level,this.gui.newLevel(),this.level=new u(this.startElementsPerLevel,this.scorePerElement)}restart(){this.gui.restart(),this.currentLevelsPlayed=0,this.startElementsPerLevel=5}saveScore(){let e=this.gui.getScore();this.dataService.saveScore(e).then(e=>{console.log("Response after saving score",e)})}})}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vZGV2L2hlbHBlcnMvZG9tZWxlbWVudC50cyIsIndlYnBhY2s6Ly8vLi9kZXYvZ3VpL3Njb3JlLnRzIiwid2VicGFjazovLy8uL2Rldi9oZWxwZXJzL3dpbmRvd2V2ZW50aGFuZGxlci50cyIsIndlYnBhY2s6Ly8vLi9kZXYvZ3VpL21lc3NhZ2VzY3JlZW4udHMiLCJ3ZWJwYWNrOi8vLy4vZGV2L2RhdGFzZXJ2aWNlLnRzIiwid2VicGFjazovLy8uL2Rldi9ndWkvaGlnaHNjb3JlbGlzdC50cyIsIndlYnBhY2s6Ly8vLi9kZXYvZ3VpL2d1aS50cyIsIndlYnBhY2s6Ly8vLi9kZXYvaGVscGVycy91dGlscy50cyIsIndlYnBhY2s6Ly8vLi9kZXYvbGV2ZWwvYmxvY2sudHMiLCJ3ZWJwYWNrOi8vLy4vZGV2L2xldmVsL3BsYXllci50cyIsIndlYnBhY2s6Ly8vLi9kZXYvbGV2ZWwvdGltZXIudHMiLCJ3ZWJwYWNrOi8vLy4vZGV2L2xldmVsL2xldmVsLnRzIiwid2VicGFjazovLy8uL2Rldi9tYWluLnRzIiwid2VicGFjazovLy8uL2Rldi9nYW1lLnRzIl0sIm5hbWVzIjpbImluc3RhbGxlZE1vZHVsZXMiLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJleHBvcnRzIiwibW9kdWxlIiwiaSIsImwiLCJtb2R1bGVzIiwiY2FsbCIsIm0iLCJjIiwiZCIsIm5hbWUiLCJnZXR0ZXIiLCJvIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJjb25maWd1cmFibGUiLCJlbnVtZXJhYmxlIiwiZ2V0IiwiciIsInZhbHVlIiwibiIsIl9fZXNNb2R1bGUiLCJvYmplY3QiLCJwcm9wZXJ0eSIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwicCIsInMiLCJEb21FbGVtZW50IiwiW29iamVjdCBPYmplY3RdIiwidHlwZSIsIngiLCJ5IiwicGFyZW50Q2xhc3MiLCJ0aGlzIiwiZWwiLCJkb2N1bWVudCIsImNyZWF0ZUVsZW1lbnQiLCJtYWluIiwiZ2V0RWxlbWVudEJ5SWQiLCJFcnJvciIsInN0eWxlIiwidHJhbnNmb3JtIiwiY2xhc3NMaXN0IiwiYWRkIiwiYXBwZW5kQ2hpbGQiLCJwYXJlbnRFbCIsInF1ZXJ5U2VsZWN0b3IiLCJnZXRCb3VuZGluZ0NsaWVudFJlY3QiLCJzY29yZV9TY29yZSIsInN1cGVyIiwic2NvcmUiLCJyZW5kZXJUZW1wbGF0ZSIsImlubmVySFRNTCIsInRvU3RyaW5nIiwicmVzZXQiLCJXaW5kb3dFdmVudEhhbmRsZXIiLCJldmVudCIsImZ1bmMiLCJmdW5jdGlvbk1hcCIsIndpbmRvdyIsImFkZEV2ZW50TGlzdGVuZXIiLCJzcGxpdCIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJtZXNzYWdlc2NyZWVuX01lc3NhZ2VTY3JlZW4iLCJpc0FjdGl2ZSIsIm1lc3NhZ2VzIiwiZ2FtZTpzdGFydCIsImhlYWRlciIsImJvZHkiLCJjbGFzc05hbWUiLCJnYW1lOmVuZCIsImxldmVsOnN1Y2Nlc3MiLCJsZXZlbDpmYWlsZWQiLCJzaG93IiwiZSIsImtleUJvYXJkSGFuZGxlciIsImtleUNvZGUiLCJkaXNwYXRjaEV2ZW50IiwiRXZlbnQiLCJjdXJyZW50RXZlbnQiLCJib2R5UmVwbGFjZW1lbnRzIiwibWVzc2FnZUhlYWRlciIsIm1lc3NhZ2VCb2R5IiwicmVwbGFjZW1lbnQiLCJyZXBsYWNlIiwicmVtb3ZlIiwiZGF0YXNlcnZpY2VfRGF0YVNlcnZpY2UiLCJlbmRQb2ludExpc3QiLCJjb25maWciLCJkYXRhU2VydmljZSIsImRhdGFiYXNlTmFtZSIsImNvbGxlY3Rpb25OYW1lIiwiYXBpS2V5IiwiZW5kUG9pbnRTYXZlIiwiZnVuY3Rpb25hbGl0aWVzIiwiZGlzYWJsZWQiLCJ1cmwiLCJiYXNlVXJsIiwiZmV0Y2giLCJKU09OIiwic3RyaW5naWZ5IiwiaGVhZGVycyIsImNvbnRlbnQtdHlwZSIsIm1ldGhvZCIsIm1vZGUiLCJ0aGVuIiwicmVzcG9uc2UiLCJqc29uIiwiUHJvbWlzZSIsInJlc29sdmUiLCJlcnJvciIsImhpZ2hzY29yZWxpc3RfSGlnaFNjb3JlTGlzdCIsImdldFNjb3JlcyIsImRhdGEiLCJnZXRUYm9keVRlbXBsYXRlIiwibWFwIiwiaXRlbSIsImluZGV4IiwiX2lkIiwiJG9pZCIsImpvaW4iLCJndWlfR1VJIiwiaGlnaFNjb3JlTGlzdFZpc2libGUiLCJtZXNzYWdlU2NyZWVuIiwidXBkYXRlIiwiZGV0YWlsIiwiaGlnaFNjb3JlTGlzdCIsImhpZGUiLCJtYXhTY29yZSIsIl9fU0NPUkVfXyIsIl9fTUFYX1NDT1JFX18iLCJVdGlscyIsIk1hdGgiLCJyb3VuZCIsInJhbmRvbSIsIm1pbiIsIm1heCIsImZsb29yIiwiYSIsImIiLCJsZWZ0IiwicmlnaHQiLCJ0b3AiLCJib3R0b20iLCJibG9ja19CbG9jayIsImNvbG9yIiwic3BlZWQiLCJ3aWR0aCIsImhlaWdodCIsImRlc3RpbmF0aW9uIiwiYmFja2dyb3VuZEltYWdlIiwiZ2V0UmFuZG9tSW50Iiwib3V0ZXJXaWR0aCIsImRvY3VtZW50RWxlbWVudCIsImNsaWVudEhlaWdodCIsInBsYXllcl9QbGF5ZXIiLCJncm93dGhGYWN0b3IiLCJnYW1lIiwicGxheWVyIiwic3BlZWRJbmNyZWFzZUZhY3RvciIsImtleXNBbGxvd2VkIiwia2V5c1ByZXNzZWQiLCJib3JkZXJSYWRpdXMiLCJrZXlEb3duSGFuZGxlciIsImtleVVwSGFuZGxlciIsImtleSIsImluZGV4T2YiLCJwdXNoIiwia2V5UHJlc3NlZFBvc2l0aW9uIiwic3BsaWNlIiwiZm9yRWFjaCIsImJsb2NrIiwiYmFja2dyb3VuZENvbG9yIiwidGltZXJfVGltZXIiLCJzZWNvbmRzIiwic2Vjb25kc1BlckxldmVsIiwiaW50ZXJ2YWxJZCIsInNldEludGVydmFsIiwiY2xlYXJJbnRlcnZhbCIsImxldmVsX0xldmVsIiwidG90YWxCbG9ja3MiLCJzY29yZVBlckJsb2NrIiwiYmxvY2tzIiwiZmFpbGVkIiwidGltZXIiLCJnZXRSYW5kb21Db2xvciIsImJsb2NrU3BlZWQiLCJibG9ja1BpeGVscyIsImRlc3Ryb3kiLCJjaGVja0NvbGxpc2lvbiIsImdldENsaWVudFJlYWN0IiwiYmxvY2tDYXVnaHQiLCJDdXN0b21FdmVudCIsImxlbmd0aCIsImV2ZW50VHlwZSIsImxldmVsc1BlckdhbWUiLCJjdXJyZW50TGV2ZWxzUGxheWVkIiwic3RhcnRFbGVtZW50c1BlckxldmVsIiwiZWxlbWVudHNJbmNyZWFzZVBlckxldmVsIiwic2NvcmVQZXJFbGVtZW50IiwiZ3VpIiwiY2FsY3VsYXRlTWF4U2NvcmUiLCJnYW1lTG9vcCIsInN0YXJ0TmV3TGV2ZWwiLCJyZXN0YXJ0IiwibGV2ZWwiLCJyZXF1ZXN0QW5pbWF0aW9uRnJhbWUiLCJnYW1lRW5kIiwic2F2ZVNjb3JlIiwibGV2ZWxEb25lIiwibmV3TGV2ZWwiLCJnZXRTY29yZSIsImNvbnNvbGUiLCJsb2ciXSwibWFwcGluZ3MiOiJhQUNBLElBQUFBLEtBR0EsU0FBQUMsRUFBQUMsR0FHQSxHQUFBRixFQUFBRSxHQUNBLE9BQUFGLEVBQUFFLEdBQUFDLFFBR0EsSUFBQUMsRUFBQUosRUFBQUUsSUFDQUcsRUFBQUgsRUFDQUksR0FBQSxFQUNBSCxZQVVBLE9BTkFJLEVBQUFMLEdBQUFNLEtBQUFKLEVBQUFELFFBQUFDLElBQUFELFFBQUFGLEdBR0FHLEVBQUFFLEdBQUEsRUFHQUYsRUFBQUQsUUFLQUYsRUFBQVEsRUFBQUYsRUFHQU4sRUFBQVMsRUFBQVYsRUFHQUMsRUFBQVUsRUFBQSxTQUFBUixFQUFBUyxFQUFBQyxHQUNBWixFQUFBYSxFQUFBWCxFQUFBUyxJQUNBRyxPQUFBQyxlQUFBYixFQUFBUyxHQUNBSyxjQUFBLEVBQ0FDLFlBQUEsRUFDQUMsSUFBQU4sS0FNQVosRUFBQW1CLEVBQUEsU0FBQWpCLEdBQ0FZLE9BQUFDLGVBQUFiLEVBQUEsY0FBaURrQixPQUFBLEtBSWpEcEIsRUFBQXFCLEVBQUEsU0FBQWxCLEdBQ0EsSUFBQVMsRUFBQVQsS0FBQW1CLFdBQ0EsV0FBMkIsT0FBQW5CLEVB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bEosS0FBS29LLHNCQUF1QnBLLEtBQUtzSyxpQkFNcEQzSyxVQUNKSyxLQUFLdUssSUFBSUksVUFDVDNLLEtBQUttSyxvQkFBc0IsRUFDM0JuSyxLQUFLb0ssc0JBQXdCLEVBTXpCekssWUFDSixJQUFJc0IsRUFBUWpCLEtBQUt1SyxJQUFJVyxXQUNyQmxMLEtBQUt3RCxZQUFZdUgsVUFBVTlKLEdBQU91RCxLQUFNUSxJQUNwQ21HLFFBQVFDLElBQUksOEJBQStCcEciLCJmaWxlIjoibWFpbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIiBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbiBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG5cbiBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbiBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKSB7XG4gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4gXHRcdH1cbiBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbiBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuIFx0XHRcdGk6IG1vZHVsZUlkLFxuIFx0XHRcdGw6IGZhbHNlLFxuIFx0XHRcdGV4cG9ydHM6IHt9XG4gXHRcdH07XG5cbiBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG4gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbiBcdFx0bW9kdWxlLmwgPSB0cnVlO1xuXG4gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbiBcdH1cblxuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbiBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG5cbiBcdC8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb24gZm9yIGhhcm1vbnkgZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7XG4gXHRcdGlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwge1xuIFx0XHRcdFx0Y29uZmlndXJhYmxlOiBmYWxzZSxcbiBcdFx0XHRcdGVudW1lcmFibGU6IHRydWUsXG4gXHRcdFx0XHRnZXQ6IGdldHRlclxuIFx0XHRcdH0pO1xuIFx0XHR9XG4gXHR9O1xuXG4gXHQvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSBmdW5jdGlvbihleHBvcnRzKSB7XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG4gXHR9O1xuXG4gXHQvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlc1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5uID0gZnVuY3Rpb24obW9kdWxlKSB7XG4gXHRcdHZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgP1xuIFx0XHRcdGZ1bmN0aW9uIGdldERlZmF1bHQoKSB7IHJldHVybiBtb2R1bGVbJ2RlZmF1bHQnXTsgfSA6XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0TW9kdWxlRXhwb3J0cygpIHsgcmV0dXJuIG1vZHVsZTsgfTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgJ2EnLCBnZXR0ZXIpO1xuIFx0XHRyZXR1cm4gZ2V0dGVyO1xuIFx0fTtcblxuIFx0Ly8gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbihvYmplY3QsIHByb3BlcnR5KSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSk7IH07XG5cbiBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuXG5cbiBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuIFx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oX193ZWJwYWNrX3JlcXVpcmVfXy5zID0gMSk7XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBEb21FbGVtZW50IHtcbiAgICBwcm90ZWN0ZWQgZWw6IEhUTUxFbGVtZW50O1xuICAgIHByb3RlY3RlZCB4OiBudW1iZXI7XG4gICAgcHJvdGVjdGVkIHk6IG51bWJlcjtcblxuICAgIGNvbnN0cnVjdG9yKHR5cGU6IHN0cmluZywgeDogbnVtYmVyLCB5OiBudW1iZXIsIHBhcmVudENsYXNzOiBzdHJpbmcgPSAnJykge1xuICAgICAgICB0aGlzLnggPSB4O1xuICAgICAgICB0aGlzLnkgPSB5O1xuXG4gICAgICAgIHRoaXMuZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgbGV0IG1haW4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFpbicpO1xuICAgICAgICBpZiAobWFpbiA9PT0gbnVsbCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiPG1haW4+IGVsZW1lbnQgZG9lc24ndCBleGlzdCFcIik7XG4gICAgICAgIH1cblxuICAgICAgICAvLy0xIGNoZWNrIGlzIHRvIGxldCBDU1MgZG8gaXRzIG93biBqb2IgQHRvZG8gY2xlYW5lciBzb2x1dGlvbj9cbiAgICAgICAgaWYgKHRoaXMueCA+IC0xICYmIHRoaXMueSA+IC0xKSB7XG4gICAgICAgICAgICB0aGlzLmVsLnN0eWxlLnRyYW5zZm9ybSA9IGB0cmFuc2xhdGUoJHt0aGlzLnh9cHgsICR7dGhpcy55fXB4KWA7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5lbC5jbGFzc0xpc3QuYWRkKGBnYW1lLSR7dHlwZX1gKTtcblxuICAgICAgICBpZiAocGFyZW50Q2xhc3MgPT09ICcnKSB7XG4gICAgICAgICAgICBtYWluLmFwcGVuZENoaWxkKHRoaXMuZWwpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgbGV0IHBhcmVudEVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgLmdhbWUtJHtwYXJlbnRDbGFzc31gKTtcbiAgICAgICAgICAgIGlmIChwYXJlbnRFbCA9PT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgPC5nYW1lLSR7cGFyZW50Q2xhc3N9PiBlbGVtZW50IGRvZXNuJ3QgZXhpc3QhYCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBwYXJlbnRFbC5hcHBlbmRDaGlsZCh0aGlzLmVsKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEByZXR1cm5zIENsaWVudFJlY3RcbiAgICAgKi9cbiAgICBwdWJsaWMgZ2V0Q2xpZW50UmVhY3QoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmVsLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICAgIH1cbn1cbiIsImltcG9ydCBEb21FbGVtZW50IGZyb20gXCIuLi9oZWxwZXJzL2RvbWVsZW1lbnRcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2NvcmUgZXh0ZW5kcyBEb21FbGVtZW50IHtcbiAgICBwcml2YXRlIHNjb3JlOiBudW1iZXIgPSAwO1xuXG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHN1cGVyKCdzY29yZScsIC0xLCAtMSwgJ2d1aScpO1xuXG4gICAgICAgIHRoaXMucmVuZGVyVGVtcGxhdGUoKTtcbiAgICAgICAgdGhpcy5lbC5xdWVyeVNlbGVjdG9yKCcuc2NvcmUtY291bnQnKS5pbm5lckhUTUwgPSB0aGlzLnNjb3JlLnRvU3RyaW5nKCk7XG4gICAgICAgIHRoaXMuZWwuY2xhc3NMaXN0LmFkZCgnbWVzc2FnZScsICdpcy13YXJuaW5nJyk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmV0cmlldmUgY3VycmVudCBzY29yZVxuICAgICAqXG4gICAgICogQHJldHVybnMge251bWJlcn1cbiAgICAgKi9cbiAgICBwdWJsaWMgZ2V0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5zY29yZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBVcGRhdGUgdGhlIHNjb3JlIGJhc2VkIG9uIGEgQ3VzdG9tIEV2ZW50IGZyb20gdGhlIEJsb2NrIG9iamVjdFxuICAgICAqXG4gICAgICogQHBhcmFtIHNjb3JlXG4gICAgICogQHBhcmFtIFtyZXNldF1cbiAgICAgKi9cbiAgICBwdWJsaWMgdXBkYXRlKHNjb3JlOiBudW1iZXIsIHJlc2V0OiBib29sZWFuID0gZmFsc2UpIHtcbiAgICAgICAgdGhpcy5zY29yZSA9IHJlc2V0ID8gc2NvcmUgOiB0aGlzLnNjb3JlICsgc2NvcmU7XG4gICAgICAgIHRoaXMuZWwucXVlcnlTZWxlY3RvcignLnNjb3JlLWNvdW50JykuaW5uZXJIVE1MID0gdGhpcy5zY29yZS50b1N0cmluZygpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRlbXBsYXRlIG5lZWRlZCB0byBzaG93IG1vcmUgZWxlbWVudHNcbiAgICAgKi9cbiAgICBwcml2YXRlIHJlbmRlclRlbXBsYXRlKCkge1xuICAgICAgICB0aGlzLmVsLmlubmVySFRNTCA9IGBcbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJtZXNzYWdlLWJvZHlcIj5cbiAgICAgICAgICAgICAgICA8c3Bhbj5zY29yZTogPC9zcGFuPlxuICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPVwic2NvcmUtY291bnRcIj48L3NwYW4+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgYDtcbiAgICB9XG59XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBXaW5kb3dFdmVudEhhbmRsZXIge1xuICAgIHByaXZhdGUgc3RhdGljIGZ1bmN0aW9uTWFwOiB7IFtrOiBzdHJpbmddOiBhbnkgfSA9IHt9O1xuXG4gICAgcHVibGljIHN0YXRpYyBhZGRFdmVudExpc3RlbmVyKGV2ZW50OiBzdHJpbmcsIGZ1bmM6IGFueSkge1xuICAgICAgICBXaW5kb3dFdmVudEhhbmRsZXIuZnVuY3Rpb25NYXBbZXZlbnRdID0gZnVuYztcbiAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoZXZlbnQuc3BsaXQoJy4nKVswXSwgV2luZG93RXZlbnRIYW5kbGVyLmZ1bmN0aW9uTWFwW2V2ZW50XSk7XG4gICAgfVxuXG4gICAgcHVibGljIHN0YXRpYyByZW1vdmVFdmVudExpc3RlbmVyKGV2ZW50OiBzdHJpbmcpIHtcbiAgICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoZXZlbnQuc3BsaXQoJy4nKVswXSwgV2luZG93RXZlbnRIYW5kbGVyLmZ1bmN0aW9uTWFwW2V2ZW50XSk7XG4gICAgICAgIGRlbGV0ZSBXaW5kb3dFdmVudEhhbmRsZXIuZnVuY3Rpb25NYXBbZXZlbnRdO1xuICAgIH1cbn1cbiIsImltcG9ydCBEb21FbGVtZW50IGZyb20gXCIuLi9oZWxwZXJzL2RvbWVsZW1lbnRcIjtcbmltcG9ydCBXaW5kb3dFdmVudEhhbmRsZXIgZnJvbSBcIi4uL2hlbHBlcnMvd2luZG93ZXZlbnRoYW5kbGVyXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIE1lc3NhZ2VTY3JlZW4gZXh0ZW5kcyBEb21FbGVtZW50IHtcbiAgICBwcml2YXRlIGN1cnJlbnRFdmVudCE6IHN0cmluZztcbiAgICBwcml2YXRlIGlzQWN0aXZlOiBib29sZWFuID0gZmFsc2U7XG5cbiAgICBwcml2YXRlIG1lc3NhZ2VzOiB7IFtrOiBzdHJpbmddOiB7ICdoZWFkZXInOiBzdHJpbmcsICdib2R5Jzogc3RyaW5nLCAnY2xhc3NOYW1lJzogc3RyaW5nIH0gfSA9IHtcbiAgICAgICAgJ2dhbWU6c3RhcnQnOiB7XG4gICAgICAgICAgICAnaGVhZGVyJzogJ1dlbGNvbWUgdG8gQmxvY2stby1CbG9jayEnLFxuICAgICAgICAgICAgJ2JvZHknOiAnSXRcXCdzIHRpbWUgdG8gY2F0Y2ggdGhlbSBibG9ja3MhPGJyLz48YnIvPlVzZSB5b3VyIGFycm93IGtleXMgdG8gbW92ZSB5b3VyIHBsYXllciBhcm91bmQgYW5kIHByZXNzIHNwYWNlIHRvIHN0YXJ0Ljxici8+PGJyLz5QcmVzcyAtPHN0cm9uZz5IPC9zdHJvbmc+LSB0byB2aWV3IHRoZSBoaWdoc2NvcmUgbGlzdCcsXG4gICAgICAgICAgICAnY2xhc3NOYW1lJzogJ2lzLWluZm8nXG4gICAgICAgIH0sXG4gICAgICAgICdnYW1lOmVuZCc6IHtcbiAgICAgICAgICAgICdoZWFkZXInOiAnWW91ciBnYW1lIGlzIG92ZXIhJyxcbiAgICAgICAgICAgICdib2R5JzogJ1lvdSBtYWRlIGl0LCB5b3VyIGZpbmFsIHNjb3JlIGlzIF9fU0NPUkVfXyBvdXQgb2YgbWF4IF9fTUFYX1NDT1JFX18gcG9pbnRzLjxici8+PGJyLz5UaGFua3MgZm9yIHBsYXlpbmcsIHByZXNzIHNwYWNlIHRvIHJlc3RhcnQgdGhlIG1hZG5lc3MuPGJyLz48YnIvPlByZXNzIC08c3Ryb25nPkg8L3N0cm9uZz4tIHRvIHZpZXcgdGhlIGhpZ2hzY29yZSBsaXN0JyxcbiAgICAgICAgICAgICdjbGFzc05hbWUnOiAnaXMtc3VjY2VzcydcbiAgICAgICAgfSxcbiAgICAgICAgJ2xldmVsOnN1Y2Nlc3MnOiB7XG4gICAgICAgICAgICAnaGVhZGVyJzogJ1lFQUghIExldmVsIGNvbXBsZXRlZCEnLFxuICAgICAgICAgICAgJ2JvZHknOiAnUGVyZm9ybWluZyBsaWtlIGEgYm9zcyEgUHJlc3Mgc3BhY2UgdG8gcHJvY2VlZCB0byB0aGUgbmV4dCBsZXZlbCBhbmQgY2F0Y2ggZXZlbiBtb3JlIGJsb2NrcycsXG4gICAgICAgICAgICAnY2xhc3NOYW1lJzogJ2lzLXN1Y2Nlc3MnXG4gICAgICAgIH0sXG4gICAgICAgICdsZXZlbDpmYWlsZWQnOiB7XG4gICAgICAgICAgICAnaGVhZGVyJzogJ0FBSCEgTGV2ZWwgZmFpbGVkIScsXG4gICAgICAgICAgICAnYm9keSc6ICdUcnkgYWdhaW4gYW5kIHNob3cgdXMgd2hhdCB5b3VcXCdyZSBtYWRlIG9mZiEgUHJlc3Mgc3BhY2UgdG8gcmVzdGFydCB0aGlzIGxldmVsJyxcbiAgICAgICAgICAgICdjbGFzc05hbWUnOiAnaXMtZGFuZ2VyJ1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICBzdXBlcignbWVzc2FnZXNjcmVlbicsIC0xLCAtMSwgJ2d1aScpO1xuICAgICAgICB0aGlzLmVsLmNsYXNzTGlzdC5hZGQoJ21lc3NhZ2UnKTtcblxuICAgICAgICB0aGlzLnJlbmRlclRlbXBsYXRlKCk7XG4gICAgICAgIHRoaXMuc2hvdygnZ2FtZTpzdGFydCcpO1xuICAgICAgICBXaW5kb3dFdmVudEhhbmRsZXIuYWRkRXZlbnRMaXN0ZW5lcigna2V5dXAubWVzc2FnZXNjcmVlbicsIChlOiBLZXlib2FyZEV2ZW50KSA9PiB0aGlzLmtleUJvYXJkSGFuZGxlcihlKSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogSGFuZGxlIHRoZSBzcGFjZWJhclxuICAgICAqXG4gICAgICogQHBhcmFtIHtLZXlib2FyZEV2ZW50fSBlXG4gICAgICovXG4gICAga2V5Qm9hcmRIYW5kbGVyKGU6IEtleWJvYXJkRXZlbnQpIHtcbiAgICAgICAgaWYgKGUua2V5Q29kZSA9PT0gMzIgJiYgdGhpcy5pc0FjdGl2ZSA9PT0gdHJ1ZSkge1xuICAgICAgICAgICAgd2luZG93LmRpc3BhdGNoRXZlbnQobmV3IEV2ZW50KGAke3RoaXMuY3VycmVudEV2ZW50fTpjbGlja2ApKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFNob3cgdGhlIGRlc2lyZWQgbWVzc2FnZSAodHlwZSBtYXRjaGVzIGluZGV4IGluIG9iamVjdClcbiAgICAgKlxuICAgICAqIEBwYXJhbSB0eXBlXG4gICAgICogQHBhcmFtIFtib2R5UmVwbGFjZW1lbnRzXVxuICAgICAqL1xuICAgIHB1YmxpYyBzaG93KHR5cGU6IHN0cmluZywgYm9keVJlcGxhY2VtZW50czogeyBbazogc3RyaW5nXTogc3RyaW5nIH0gPSB7fSkge1xuICAgICAgICBsZXQgbWVzc2FnZUhlYWRlciA9IHRoaXMubWVzc2FnZXNbdHlwZV0uaGVhZGVyO1xuICAgICAgICBsZXQgbWVzc2FnZUJvZHkgPSB0aGlzLm1lc3NhZ2VzW3R5cGVdLmJvZHk7XG4gICAgICAgIGZvciAobGV0IHJlcGxhY2VtZW50IGluIGJvZHlSZXBsYWNlbWVudHMpIHtcbiAgICAgICAgICAgIG1lc3NhZ2VCb2R5ID0gbWVzc2FnZUJvZHkucmVwbGFjZShyZXBsYWNlbWVudCwgYm9keVJlcGxhY2VtZW50c1tyZXBsYWNlbWVudF0pO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5lbC5xdWVyeVNlbGVjdG9yKCcubWVzc2FnZS1oZWFkZXInKS5pbm5lckhUTUwgPSBtZXNzYWdlSGVhZGVyO1xuICAgICAgICB0aGlzLmVsLnF1ZXJ5U2VsZWN0b3IoJy5tZXNzYWdlLWJvZHknKS5pbm5lckhUTUwgPSBtZXNzYWdlQm9keTtcblxuICAgICAgICB0aGlzLmVsLmNsYXNzTGlzdC5hZGQoJ3Nob3cnLCB0aGlzLm1lc3NhZ2VzW3R5cGVdLmNsYXNzTmFtZSk7XG4gICAgICAgIHRoaXMuY3VycmVudEV2ZW50ID0gdHlwZTtcbiAgICAgICAgdGhpcy5pc0FjdGl2ZSA9IHRydWU7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogSGlkZSBtZXNzYWdlIG9uIHNjcmVlblxuICAgICAqL1xuICAgIHB1YmxpYyBoaWRlKCkge1xuICAgICAgICB0aGlzLmVsLmNsYXNzTGlzdC5yZW1vdmUoJ3Nob3cnLCAnaXMtaW5mbycsICdpcy1zdWNjZXNzJywgJ2lzLWRhbmdlcicpO1xuICAgICAgICB0aGlzLmlzQWN0aXZlID0gZmFsc2U7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVGVtcGxhdGUgbmVlZGVkIHRvIHNob3cgbW9yZSBlbGVtZW50c1xuICAgICAqL1xuICAgIHByaXZhdGUgcmVuZGVyVGVtcGxhdGUoKSB7XG4gICAgICAgIHRoaXMuZWwuaW5uZXJIVE1MID0gYFxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cIm1lc3NhZ2UtaGVhZGVyXCI+PC9kaXY+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVwibWVzc2FnZS1ib2R5XCI+PC9kaXY+XG4gICAgICAgIGA7XG4gICAgfVxufVxuIiwiaW1wb3J0IGNvbmZpZyBmcm9tICcuL2NvbmZpZy5qc29uJztcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgRGF0YVNlcnZpY2Uge1xuICAgIHByaXZhdGUgZW5kUG9pbnRMaXN0OiBzdHJpbmcgPSBgL2RhdGFiYXNlcy8ke2NvbmZpZy5kYXRhU2VydmljZS5kYXRhYmFzZU5hbWV9L2NvbGxlY3Rpb25zLyR7Y29uZmlnLmRhdGFTZXJ2aWNlLmNvbGxlY3Rpb25OYW1lfT9hcGlLZXk9JHtjb25maWcuZGF0YVNlcnZpY2UuYXBpS2V5fWA7XG4gICAgcHJpdmF0ZSBlbmRQb2ludFNhdmU6IHN0cmluZyA9IGAvZGF0YWJhc2VzLyR7Y29uZmlnLmRhdGFTZXJ2aWNlLmRhdGFiYXNlTmFtZX0vY29sbGVjdGlvbnMvJHtjb25maWcuZGF0YVNlcnZpY2UuY29sbGVjdGlvbk5hbWV9P2FwaUtleT0ke2NvbmZpZy5kYXRhU2VydmljZS5hcGlLZXl9YDtcblxuICAgIC8qKlxuICAgICAqIFN0b3JlIHRoZSBsYXRlc3Qgc2NvcmUgaW4gdGhlIERCXG4gICAgICpcbiAgICAgKiBAcGFyYW0gc2NvcmVcbiAgICAgKiBAcmV0dXJucyB7UHJvbWlzZTx7fT59XG4gICAgICovXG4gICAgcHVibGljIHNhdmVTY29yZShzY29yZTogbnVtYmVyKSB7XG4gICAgICAgIGlmIChjb25maWcuZnVuY3Rpb25hbGl0aWVzLmRhdGFTZXJ2aWNlID09PSBmYWxzZSkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZGlzYWJsZWQoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGxldCB1cmwgPSBgJHtjb25maWcuZGF0YVNlcnZpY2UuYmFzZVVybH0ke3RoaXMuZW5kUG9pbnRTYXZlfWA7XG4gICAgICAgIHJldHVybiBmZXRjaCh1cmwsIHtcbiAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICAgICAgICBzY29yZTogc2NvcmVcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgICAgICdjb250ZW50LXR5cGUnOiAnYXBwbGljYXRpb24vanNvbidcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICAgIG1vZGU6ICdjb3JzJ1xuICAgICAgICB9KS50aGVuKHJlc3BvbnNlID0+IHJlc3BvbnNlLmpzb24oKSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IGFsbCB0aGUgY3VycmVudCBzY29yZXMgZnJvbSB0aGUgREJcbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHtQcm9taXNlPFtdPn1cbiAgICAgKi9cbiAgICBwdWJsaWMgZ2V0U2NvcmVzKCkge1xuICAgICAgICBpZiAoY29uZmlnLmZ1bmN0aW9uYWxpdGllcy5kYXRhU2VydmljZSA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmRpc2FibGVkKCk7XG4gICAgICAgIH1cblxuICAgICAgICBsZXQgdXJsID0gYCR7Y29uZmlnLmRhdGFTZXJ2aWNlLmJhc2VVcmx9JHt0aGlzLmVuZFBvaW50TGlzdH0mcz17XCJzY29yZVwiOiAtMX0mbD0xMGA7XG4gICAgICAgIHJldHVybiBmZXRjaCh1cmwsIHtcbiAgICAgICAgICAgIG1vZGU6ICdjb3JzJ1xuICAgICAgICB9KS50aGVuKHJlc3BvbnNlID0+IHJlc3BvbnNlLmpzb24oKSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2VuZXJhbCBtZXNzYWdlIHdoZW4gdGhpcyBzZXJ2aWNlIGlzIGluYWN0aXZlXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyB7UHJvbWlzZTx7fT59XG4gICAgICovXG4gICAgcHJpdmF0ZSBkaXNhYmxlZCgpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7XG4gICAgICAgICAgICByZXNvbHZlKHtcImVycm9yXCI6IFwiRGF0YXNlcnZpY2UgaXMgZGlzYWJsZWRcIn0pO1xuICAgICAgICB9KTtcbiAgICB9XG59XG4iLCJpbXBvcnQgRG9tRWxlbWVudCBmcm9tIFwiLi4vaGVscGVycy9kb21lbGVtZW50XCI7XG5pbXBvcnQgRGF0YVNlcnZpY2UgZnJvbSBcIi4uL2RhdGFzZXJ2aWNlXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEhpZ2hTY29yZUxpc3QgZXh0ZW5kcyBEb21FbGVtZW50IHtcbiAgICBwcml2YXRlIGRhdGFTZXJ2aWNlOiBEYXRhU2VydmljZTtcblxuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICBzdXBlcignaGlnaHNjb3JlbGlzdCcsIC0xLCAtMSwgJ2d1aScpO1xuICAgICAgICB0aGlzLmVsLmNsYXNzTGlzdC5hZGQoJ21lc3NhZ2UnLCAnaXMtd2FybmluZycpO1xuXG4gICAgICAgIHRoaXMucmVuZGVyVGVtcGxhdGUoKTtcbiAgICAgICAgdGhpcy5kYXRhU2VydmljZSA9IG5ldyBEYXRhU2VydmljZSgpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFNob3cgdGhlIGhpZ2hzY29yZSBsaXN0XG4gICAgICovXG4gICAgcHVibGljIHNob3coKSB7XG4gICAgICAgIHRoaXMuZGF0YVNlcnZpY2UuZ2V0U2NvcmVzKCkudGhlbigoZGF0YSkgPT4ge1xuICAgICAgICAgICAgbGV0IHRCb2R5ID0gdGhpcy5lbC5xdWVyeVNlbGVjdG9yKCcudGJvZHknKTtcbiAgICAgICAgICAgIHRCb2R5LmlubmVySFRNTCA9IHRoaXMuZ2V0VGJvZHlUZW1wbGF0ZShkYXRhKTtcbiAgICAgICAgICAgIHRoaXMuZWwuY2xhc3NMaXN0LmFkZCgnc2hvdycpO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBIaWRlIGl0IHBlcmlvZFxuICAgICAqL1xuICAgIHB1YmxpYyBoaWRlKCkge1xuICAgICAgICB0aGlzLmVsLmNsYXNzTGlzdC5yZW1vdmUoJ3Nob3cnKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm4gdGUgbG9vcGVkXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge1t7fV19IGRhdGFcbiAgICAgKiBAcmV0dXJucyB7c3RyaW5nfVxuICAgICAqL1xuICAgIHByaXZhdGUgZ2V0VGJvZHlUZW1wbGF0ZShkYXRhOiB7IHNjb3JlOiBudW1iZXIsIF9pZDogeyAkb2lkOiBzdHJpbmcgfSB9W10pIHtcbiAgICAgICAgcmV0dXJuIGBcbiAgICAgICAgICAgICR7ZGF0YS5tYXAoKGl0ZW0sIGluZGV4KSA9PiBgPHRyPlxuICAgICAgICAgICAgICAgIDx0ZD4ke2luZGV4ICsgMX08L3RkPlxuICAgICAgICAgICAgICAgIDx0ZD4ke2l0ZW0uX2lkLiRvaWR9PC90ZD5cbiAgICAgICAgICAgICAgICA8dGQ+JHtpdGVtLnNjb3JlLnRvU3RyaW5nKCl9PC90ZD5cbiAgICAgICAgICAgIDwvdHI+YCkuam9pbignJyl9XG4gICAgICAgIGA7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVGVtcGxhdGUgbmVlZGVkIHRvIHNob3cgbW9yZSBlbGVtZW50c1xuICAgICAqXG4gICAgICogQHBhcmFtIHRCb2R5XG4gICAgICovXG4gICAgcHJpdmF0ZSByZW5kZXJUZW1wbGF0ZSgpIHtcbiAgICAgICAgdGhpcy5lbC5pbm5lckhUTUwgPSBgXG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVwibWVzc2FnZS1oZWFkZXJcIj5cbiAgICAgICAgICAgICAgICA8cD5Ub3AgMTAgSGlnaCBTY29yZXMgKHByZXNzIC08c3Ryb25nPmVzYzwvc3Ryb25nPi0gdG8gcmV0dXJuKTwvcD5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cIm1lc3NhZ2UtYm9keVwiPlxuICAgICAgICAgICAgICAgIDx0YWJsZSBjbGFzcz1cInRhYmxlXCI+XG4gICAgICAgICAgICAgICAgICAgIDx0aGVhZD5cbiAgICAgICAgICAgICAgICAgICAgPHRyPlxuICAgICAgICAgICAgICAgICAgICAgICAgPHRoPiM8L3RoPlxuICAgICAgICAgICAgICAgICAgICAgICAgPHRoPk1vbmdvSUQ8L3RoPlxuICAgICAgICAgICAgICAgICAgICAgICAgPHRoPlNjb3JlPC90aD5cbiAgICAgICAgICAgICAgICAgICAgPC90cj5cbiAgICAgICAgICAgICAgICAgICAgPC90aGVhZD5cbiAgICAgICAgICAgICAgICAgICAgPHRib2R5IGNsYXNzPVwidGJvZHlcIj48L3Rib2R5PlxuICAgICAgICAgICAgICAgIDwvdGFibGU+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgYDtcbiAgICB9XG59XG4iLCJpbXBvcnQgU2NvcmUgZnJvbSAnLi9zY29yZSc7XG5pbXBvcnQgTWVzc2FnZVNjcmVlbiBmcm9tICcuL21lc3NhZ2VzY3JlZW4nO1xuaW1wb3J0IERvbUVsZW1lbnQgZnJvbSBcIi4uL2hlbHBlcnMvZG9tZWxlbWVudFwiO1xuaW1wb3J0IEhpZ2hTY29yZUxpc3QgZnJvbSBcIi4vaGlnaHNjb3JlbGlzdFwiO1xuaW1wb3J0IFdpbmRvd0V2ZW50SGFuZGxlciBmcm9tIFwiLi4vaGVscGVycy93aW5kb3dldmVudGhhbmRsZXJcIjtcbmltcG9ydCBjb25maWcgZnJvbSAnLi4vY29uZmlnLmpzb24nO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBHVUkgZXh0ZW5kcyBEb21FbGVtZW50IHtcbiAgICBwcml2YXRlIHNjb3JlOiBTY29yZTtcbiAgICBwcml2YXRlIG1lc3NhZ2VTY3JlZW46IE1lc3NhZ2VTY3JlZW47XG4gICAgcHJpdmF0ZSBoaWdoU2NvcmVMaXN0OiBIaWdoU2NvcmVMaXN0O1xuICAgIHByaXZhdGUgaGlnaFNjb3JlTGlzdFZpc2libGU6IGJvb2xlYW4gPSBmYWxzZTtcblxuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICBzdXBlcignZ3VpJywgLTEsIC0xKTtcblxuICAgICAgICB0aGlzLnNjb3JlID0gbmV3IFNjb3JlKCk7XG4gICAgICAgIHRoaXMubWVzc2FnZVNjcmVlbiA9IG5ldyBNZXNzYWdlU2NyZWVuKCk7XG4gICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdsZXZlbDpzY29yZVVwZGF0ZScsIChlKSA9PiB0aGlzLnNjb3JlLnVwZGF0ZSgoZSBhcyBDdXN0b21FdmVudCkuZGV0YWlsLnNjb3JlKSk7XG5cbiAgICAgICAgaWYgKGNvbmZpZy5mdW5jdGlvbmFsaXRpZXMuZGF0YVNlcnZpY2UgPT09IHRydWUpIHtcbiAgICAgICAgICAgIHRoaXMuaGlnaFNjb3JlTGlzdCA9IG5ldyBIaWdoU2NvcmVMaXN0KCk7XG4gICAgICAgICAgICBXaW5kb3dFdmVudEhhbmRsZXIuYWRkRXZlbnRMaXN0ZW5lcigna2V5dXAuaGlnaHNjb3JlbGlzdCcsIChlOiBLZXlib2FyZEV2ZW50KSA9PiB0aGlzLmtleUJvYXJkSGFuZGxlcihlKSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBIYW5kbGUgdGhlIHNwYWNlYmFyXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge0tleWJvYXJkRXZlbnR9IGVcbiAgICAgKi9cbiAgICBrZXlCb2FyZEhhbmRsZXIoZTogS2V5Ym9hcmRFdmVudCkge1xuICAgICAgICBpZiAoZS5rZXlDb2RlID09PSA3MiAmJiB0aGlzLmhpZ2hTY29yZUxpc3RWaXNpYmxlID09PSBmYWxzZSkge1xuICAgICAgICAgICAgdGhpcy5oaWdoU2NvcmVMaXN0VmlzaWJsZSA9IHRydWU7XG4gICAgICAgICAgICB0aGlzLmhpZ2hTY29yZUxpc3Quc2hvdygpO1xuICAgICAgICB9IGVsc2UgaWYgKGUua2V5Q29kZSA9PT0gMjcgJiYgdGhpcy5oaWdoU2NvcmVMaXN0VmlzaWJsZSA9PT0gdHJ1ZSkge1xuICAgICAgICAgICAgdGhpcy5oaWdoU2NvcmVMaXN0VmlzaWJsZSA9IGZhbHNlO1xuICAgICAgICAgICAgdGhpcy5oaWdoU2NvcmVMaXN0LmhpZGUoKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRyaWdnZXJlZCB3aGVuIGEgbGV2ZWwgaXMgZG9uZVxuICAgICAqXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHR5cGVcbiAgICAgKi9cbiAgICBwdWJsaWMgbGV2ZWxEb25lKHR5cGU6IHN0cmluZykge1xuICAgICAgICB0aGlzLm1lc3NhZ2VTY3JlZW4uc2hvdyh0eXBlKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUcmlnZ2VyZWQgd2hlbiBhIG5ldyBsZXZlbCBzdGFydHNcbiAgICAgKi9cbiAgICBwdWJsaWMgbmV3TGV2ZWwoKSB7XG4gICAgICAgIHRoaXMubWVzc2FnZVNjcmVlbi5oaWRlKCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVHJpZ2dlcmVkIHdoZW4gdGhlIGdhbWUgaXMgZG9uZVxuICAgICAqXG4gICAgICogQHBhcmFtIG1heFNjb3JlXG4gICAgICovXG4gICAgcHVibGljIGdhbWVFbmQobWF4U2NvcmU6IG51bWJlcikge1xuICAgICAgICB0aGlzLm1lc3NhZ2VTY3JlZW4uc2hvdygnZ2FtZTplbmQnLCB7XG4gICAgICAgICAgICAnX19TQ09SRV9fJzogdGhpcy5zY29yZS5nZXQoKS50b1N0cmluZygpLFxuICAgICAgICAgICAgJ19fTUFYX1NDT1JFX18nOiBtYXhTY29yZS50b1N0cmluZygpXG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRyaWdnZXJlZCB3aGVuIHdlIG5lZWQgdG8gcmVzdGFydCwgZ28gdG8gZmlyc3Qgc2NyZWVuIGFuZCBzZXQgc2NvcmUgdG8gMFxuICAgICAqL1xuICAgIHB1YmxpYyByZXN0YXJ0KCkge1xuICAgICAgICB0aGlzLm1lc3NhZ2VTY3JlZW4uaGlkZSgpO1xuICAgICAgICB0aGlzLm1lc3NhZ2VTY3JlZW4uc2hvdygnZ2FtZTpzdGFydCcpO1xuICAgICAgICB0aGlzLnNjb3JlLnVwZGF0ZSgwLCB0cnVlKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBAcmV0dXJucyB7bnVtYmVyfVxuICAgICAqL1xuICAgIHB1YmxpYyBnZXRTY29yZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc2NvcmUuZ2V0KCk7XG4gICAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgVXRpbHMge1xuICAgIHN0YXRpYyBnZXRSYW5kb21Db2xvcigpIHtcbiAgICAgICAgbGV0IG8gPSBNYXRoLnJvdW5kLCByID0gTWF0aC5yYW5kb20sIHMgPSAyNTU7XG4gICAgICAgIHJldHVybiBgcmdiYSgke28ocigpICogcyl9LCR7byhyKCkgKiBzKX0sJHtvKHIoKSAqIHMpfSwxKWA7XG4gICAgfVxuXG4gICAgc3RhdGljIGdldFJhbmRvbUludChtaW46IG51bWJlciwgbWF4OiBudW1iZXIpIHtcbiAgICAgICAgcmV0dXJuIE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIChtYXggLSBtaW4gKyAxKSkgKyBtaW47XG4gICAgfVxuXG4gICAgc3RhdGljIGNoZWNrQ29sbGlzaW9uKGE6IENsaWVudFJlY3QsIGI6IENsaWVudFJlY3QpIHtcbiAgICAgICAgcmV0dXJuIChhLmxlZnQgPD0gYi5yaWdodCAmJlxuICAgICAgICAgICAgYi5sZWZ0IDw9IGEucmlnaHQgJiZcbiAgICAgICAgICAgIGEudG9wIDw9IGIuYm90dG9tICYmXG4gICAgICAgICAgICBiLnRvcCA8PSBhLmJvdHRvbSk7XG4gICAgfVxufVxuIiwiaW1wb3J0IERvbUVsZW1lbnQgZnJvbSBcIi4uL2hlbHBlcnMvZG9tZWxlbWVudFwiO1xuaW1wb3J0IFV0aWxzIGZyb20gXCIuLi9oZWxwZXJzL3V0aWxzXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEJsb2NrIGV4dGVuZHMgRG9tRWxlbWVudCB7XG4gICAgcHJpdmF0ZSByZWFkb25seSBzcGVlZDogbnVtYmVyO1xuICAgIHByaXZhdGUgcmVhZG9ubHkgd2lkdGg6IG51bWJlcjtcbiAgICBwcml2YXRlIHJlYWRvbmx5IGhlaWdodDogbnVtYmVyO1xuICAgIHB1YmxpYyBjb2xvcjogc3RyaW5nO1xuICAgIHByaXZhdGUgZGVzdGluYXRpb24gPSB7eDogMCwgeTogMH07XG5cbiAgICBjb25zdHJ1Y3Rvcihjb2xvcjogc3RyaW5nLCBzcGVlZDogbnVtYmVyLCB3aWR0aDogbnVtYmVyLCBoZWlnaHQ6IG51bWJlcikge1xuICAgICAgICBzdXBlcignYmxvY2snLCAwLCAwLCAnbGV2ZWwnKTtcblxuICAgICAgICB0aGlzLnNwZWVkID0gc3BlZWQ7XG4gICAgICAgIHRoaXMud2lkdGggPSB3aWR0aDtcbiAgICAgICAgdGhpcy5oZWlnaHQgPSBoZWlnaHQ7XG4gICAgICAgIHRoaXMuY29sb3IgPSBjb2xvcjtcblxuICAgICAgICB0aGlzLmVsLnN0eWxlLmJhY2tncm91bmRJbWFnZSA9IGByZXBlYXRpbmctbGluZWFyLWdyYWRpZW50KCR7VXRpbHMuZ2V0UmFuZG9tSW50KDAsMzYwKX1kZWcsICMwMDAwMDAsICMwMDAwMDAgJHtVdGlscy5nZXRSYW5kb21JbnQoMiwxMCl9cHgsICR7dGhpcy5jb2xvcn0gMTBweCwgJHt0aGlzLmNvbG9yfSAke1V0aWxzLmdldFJhbmRvbUludCgyMCw0MCl9cHgpYDtcbiAgICAgICAgdGhpcy5lbC5zdHlsZS53aWR0aCA9IGAke3RoaXMud2lkdGh9cHhgO1xuICAgICAgICB0aGlzLmVsLnN0eWxlLmhlaWdodCA9IGAke3RoaXMuaGVpZ2h0fXB4YDtcblxuICAgICAgICB0aGlzLnggPSBVdGlscy5nZXRSYW5kb21JbnQoMCwgKHdpbmRvdy5vdXRlcldpZHRoIC0gdGhpcy53aWR0aCkpO1xuICAgICAgICB0aGlzLnkgPSBVdGlscy5nZXRSYW5kb21JbnQoMCwgKGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRIZWlnaHQgLSB0aGlzLmhlaWdodCkpO1xuICAgICAgICB0aGlzLmVsLnN0eWxlLnRyYW5zZm9ybSA9IGB0cmFuc2xhdGUoJHt0aGlzLnh9cHgsICR7dGhpcy55fXB4KWA7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogSGFuZGxlciBmb3IgY2xpY2tpbmcgdGhlIGJsb2Nrc1xuICAgICAqL1xuICAgIHB1YmxpYyBkZXN0cm95KCkge1xuICAgICAgICB0aGlzLmVsLnJlbW92ZSgpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIE1haW4gdXBkYXRlIGhhbmRsZXIgZm9yIHRoZSBnYW1lIGZvciBtb3Zpbmcgb3VyIGJsb2NrIHJhbmRvbWx5IG92ZXIgdGhlIHNjcmVlblxuICAgICAqL1xuICAgIHB1YmxpYyB1cGRhdGUoKSB7XG4gICAgICAgIGlmICh0aGlzLnggPiAodGhpcy5kZXN0aW5hdGlvbi54IC0gdGhpcy5zcGVlZCkgJiYgdGhpcy54IDwgKHRoaXMuZGVzdGluYXRpb24ueCArIHRoaXMuc3BlZWQpKSB7XG4gICAgICAgICAgICB0aGlzLmRlc3RpbmF0aW9uLnggPSBVdGlscy5nZXRSYW5kb21JbnQoMCwgKHdpbmRvdy5vdXRlcldpZHRoIC0gdGhpcy53aWR0aCkpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnkgPiAodGhpcy5kZXN0aW5hdGlvbi55IC0gdGhpcy5zcGVlZCkgJiYgdGhpcy55IDwgKHRoaXMuZGVzdGluYXRpb24ueSArIHRoaXMuc3BlZWQpKSB7XG4gICAgICAgICAgICB0aGlzLmRlc3RpbmF0aW9uLnkgPSBVdGlscy5nZXRSYW5kb21JbnQoMCwgKGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRIZWlnaHQgLSB0aGlzLmhlaWdodCkpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHRoaXMuZGVzdGluYXRpb24ueCA+PSB0aGlzLngpIHtcbiAgICAgICAgICAgIHRoaXMueCArPSB0aGlzLnNwZWVkO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy54IC09IHRoaXMuc3BlZWQ7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGhpcy5kZXN0aW5hdGlvbi55ID49IHRoaXMueSkge1xuICAgICAgICAgICAgdGhpcy55ICs9IHRoaXMuc3BlZWQ7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnkgLT0gdGhpcy5zcGVlZDtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuZWwuc3R5bGUudHJhbnNmb3JtID0gYHRyYW5zbGF0ZSgke3RoaXMueH1weCwgJHt0aGlzLnl9cHgpYDtcbiAgICB9XG59XG4iLCJpbXBvcnQgY29uZmlnIGZyb20gJy4uL2NvbmZpZy5qc29uJztcbmltcG9ydCBEb21FbGVtZW50IGZyb20gXCIuLi9oZWxwZXJzL2RvbWVsZW1lbnRcIjtcbmltcG9ydCBCbG9jayBmcm9tIFwiLi9ibG9ja1wiO1xuaW1wb3J0IFdpbmRvd0V2ZW50SGFuZGxlciBmcm9tIFwiLi4vaGVscGVycy93aW5kb3dldmVudGhhbmRsZXJcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUGxheWVyIGV4dGVuZHMgRG9tRWxlbWVudCB7XG4gICAgcHJpdmF0ZSBoZWlnaHQ6IG51bWJlciA9IDEwO1xuICAgIHByaXZhdGUgd2lkdGg6IG51bWJlciA9IDEwO1xuICAgIHByaXZhdGUgZ3Jvd3RoRmFjdG9yOiBudW1iZXIgPSBjb25maWcuZ2FtZS5wbGF5ZXIuZ3Jvd3RoRmFjdG9yO1xuICAgIHByaXZhdGUgc3BlZWQ6IG51bWJlciA9IGNvbmZpZy5nYW1lLnBsYXllci5zcGVlZDtcbiAgICBwcml2YXRlIHNwZWVkSW5jcmVhc2VGYWN0b3I6IG51bWJlciA9IGNvbmZpZy5nYW1lLnBsYXllci5zcGVlZEluY3JlYXNlRmFjdG9yO1xuICAgIHByaXZhdGUga2V5c0FsbG93ZWQ6IG51bWJlcltdID0gWzM3LCAzOCwgMzksIDQwXTtcbiAgICBwcml2YXRlIGtleXNQcmVzc2VkOiBudW1iZXJbXSA9IFtdO1xuXG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHN1cGVyKCdwbGF5ZXInLCAwLCAwLCAnbGV2ZWwnKTtcbiAgICAgICAgdGhpcy54ID0gd2luZG93Lm91dGVyV2lkdGggLyAyIC0gdGhpcy53aWR0aCAvIDI7XG4gICAgICAgIHRoaXMueSA9IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRIZWlnaHQgLyAyIC0gdGhpcy5oZWlnaHQgLyAyO1xuXG4gICAgICAgIHRoaXMuZWwuc3R5bGUud2lkdGggPSBgJHt0aGlzLndpZHRofXB4YDtcbiAgICAgICAgdGhpcy5lbC5zdHlsZS5oZWlnaHQgPSBgJHt0aGlzLmhlaWdodH1weGA7XG4gICAgICAgIHRoaXMuZWwuc3R5bGUuYm9yZGVyUmFkaXVzID0gYCR7dGhpcy53aWR0aH1weGA7XG5cbiAgICAgICAgV2luZG93RXZlbnRIYW5kbGVyLmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24ucGxheWVyJywgKGU6IEtleWJvYXJkRXZlbnQpID0+IHRoaXMua2V5RG93bkhhbmRsZXIoZSkpO1xuICAgICAgICBXaW5kb3dFdmVudEhhbmRsZXIuYWRkRXZlbnRMaXN0ZW5lcigna2V5dXAucGxheWVyJywgKGU6IEtleWJvYXJkRXZlbnQpID0+IHRoaXMua2V5VXBIYW5kbGVyKGUpKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBLZXkgZG93biBoYW5kbGVyIGZvciBtb3ZpbmcgdGhlIHBsYXllclxuICAgICAqXG4gICAgICogQHBhcmFtIGVcbiAgICAgKi9cbiAgICBwcml2YXRlIGtleURvd25IYW5kbGVyKGU6IEtleWJvYXJkRXZlbnQpIHtcbiAgICAgICAgbGV0IGtleSA9IGUua2V5Q29kZTtcbiAgICAgICAgaWYgKHRoaXMua2V5c0FsbG93ZWQuaW5kZXhPZihrZXkpID4gLTEgJiYgdGhpcy5rZXlzUHJlc3NlZC5pbmRleE9mKGtleSkgPT09IC0xKSB7XG4gICAgICAgICAgICB0aGlzLmtleXNQcmVzc2VkLnB1c2goa2V5KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEtleSBkb3duIGhhbmRsZXIgZm9yIG1vdmluZyB0aGUgcGxheWVyXG4gICAgICpcbiAgICAgKiBAcGFyYW0gZVxuICAgICAqL1xuICAgIHByaXZhdGUga2V5VXBIYW5kbGVyKGU6IEtleWJvYXJkRXZlbnQpIHtcbiAgICAgICAgbGV0IGtleSA9IGUua2V5Q29kZTtcbiAgICAgICAgbGV0IGtleVByZXNzZWRQb3NpdGlvbiA9IHRoaXMua2V5c1ByZXNzZWQuaW5kZXhPZihrZXkpO1xuICAgICAgICBpZiAodGhpcy5rZXlzQWxsb3dlZC5pbmRleE9mKGtleSkgPiAtMSAmJiBrZXlQcmVzc2VkUG9zaXRpb24gPiAtMSkge1xuICAgICAgICAgICAgdGhpcy5rZXlzUHJlc3NlZC5zcGxpY2Uoa2V5UHJlc3NlZFBvc2l0aW9uLCAxKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFVwZGF0ZSB0aGUgYWN0dWFsIHBvc2l0aW9uIGJhc2VkIG9uIGVhcmxpZXIgZXZlbnRzXG4gICAgICovXG4gICAgcHVibGljIHVwZGF0ZSgpIHtcbiAgICAgICAgdGhpcy5rZXlzUHJlc3NlZC5mb3JFYWNoKChrZXkpID0+IHtcbiAgICAgICAgICAgIHN3aXRjaCAoa2V5KSB7XG4gICAgICAgICAgICAgICAgY2FzZSAzNzpcbiAgICAgICAgICAgICAgICAgICAgdGhpcy54IC09IHRoaXMuc3BlZWQ7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgY2FzZSAzODpcbiAgICAgICAgICAgICAgICAgICAgdGhpcy55IC09IHRoaXMuc3BlZWQ7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgY2FzZSAzOTpcbiAgICAgICAgICAgICAgICAgICAgdGhpcy54ICs9IHRoaXMuc3BlZWQ7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgY2FzZSA0MDpcbiAgICAgICAgICAgICAgICAgICAgdGhpcy55ICs9IHRoaXMuc3BlZWQ7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICAvL0NoZWNrcyB0byBzdGF5IGluIGJvdW5kc1xuICAgICAgICBpZiAodGhpcy54IDwgMCkge1xuICAgICAgICAgICAgdGhpcy54ID0gMDtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy55IDwgMCkge1xuICAgICAgICAgICAgdGhpcy55ID0gMDtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy54ID4gKHdpbmRvdy5vdXRlcldpZHRoIC0gdGhpcy53aWR0aCkpIHtcbiAgICAgICAgICAgIHRoaXMueCA9ICh3aW5kb3cub3V0ZXJXaWR0aCAtIHRoaXMud2lkdGgpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnkgPiAoZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudEhlaWdodCAtIHRoaXMuaGVpZ2h0KSkge1xuICAgICAgICAgICAgdGhpcy55ID0gKGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRIZWlnaHQgLSB0aGlzLmhlaWdodCk7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLmVsLnN0eWxlLnRyYW5zZm9ybSA9IGB0cmFuc2xhdGUoJHt0aGlzLnh9cHgsICR7dGhpcy55fXB4KWA7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVXBkYXRlIHBsYXllciB3aGVuIGEgYmxvY2sgZ290IGNhdWdodFxuICAgICAqXG4gICAgICogQHBhcmFtIGJsb2NrXG4gICAgICovXG4gICAgcHVibGljIGJsb2NrQ2F1Z2h0KGJsb2NrOiBCbG9jaykge1xuICAgICAgICB0aGlzLnNwZWVkICs9IHRoaXMuc3BlZWRJbmNyZWFzZUZhY3RvcjtcbiAgICAgICAgdGhpcy53aWR0aCArPSB0aGlzLmdyb3d0aEZhY3RvcjtcbiAgICAgICAgdGhpcy5oZWlnaHQgKz0gdGhpcy5ncm93dGhGYWN0b3I7XG5cbiAgICAgICAgdGhpcy5lbC5zdHlsZS5oZWlnaHQgPSBgJHt0aGlzLmhlaWdodH1weGA7XG4gICAgICAgIHRoaXMuZWwuc3R5bGUud2lkdGggPSBgJHt0aGlzLndpZHRofXB4YDtcbiAgICAgICAgdGhpcy5lbC5zdHlsZS5ib3JkZXJSYWRpdXMgPSBgJHt0aGlzLndpZHRofXB4YDtcbiAgICAgICAgdGhpcy5lbC5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBibG9jay5jb2xvcjtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDbGVhbiB1cCFcbiAgICAgKi9cbiAgICBwdWJsaWMgZGVzdHJveSgpIHtcbiAgICAgICAgV2luZG93RXZlbnRIYW5kbGVyLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2tleWRvd24ucGxheWVyJyk7XG4gICAgICAgIFdpbmRvd0V2ZW50SGFuZGxlci5yZW1vdmVFdmVudExpc3RlbmVyKCdrZXl1cC5wbGF5ZXInKTtcbiAgICB9XG59XG4iLCJpbXBvcnQgY29uZmlnIGZyb20gJy4uL2NvbmZpZy5qc29uJztcbmltcG9ydCBEb21FbGVtZW50IGZyb20gXCIuLi9oZWxwZXJzL2RvbWVsZW1lbnRcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgVGltZXIgZXh0ZW5kcyBEb21FbGVtZW50IHtcbiAgICBzZWNvbmRzOiBudW1iZXIgPSBjb25maWcuZ2FtZS5zZWNvbmRzUGVyTGV2ZWw7XG4gICAgaW50ZXJ2YWxJZDogbnVtYmVyO1xuXG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHN1cGVyKCd0aW1lcicsIC0xLCAtMSwgJ2xldmVsJyk7XG5cbiAgICAgICAgdGhpcy5yZW5kZXJUZW1wbGF0ZSgpO1xuICAgICAgICB0aGlzLmVsLmNsYXNzTGlzdC5hZGQoJ21lc3NhZ2UnLCAnaXMtcHJpbWFyeScpO1xuICAgICAgICB0aGlzLmVsLnF1ZXJ5U2VsZWN0b3IoJy5zZWNvbmRzJykuaW5uZXJIVE1MID0gdGhpcy5zZWNvbmRzLnRvU3RyaW5nKCk7XG5cbiAgICAgICAgdGhpcy5pbnRlcnZhbElkID0gc2V0SW50ZXJ2YWwoKCkgPT4gdGhpcy51cGRhdGUoKSwgMTAwMCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ291bnRkb3duIG9mIHNlY29uZHNcbiAgICAgKi9cbiAgICBwcml2YXRlIHVwZGF0ZSgpIHtcbiAgICAgICAgdGhpcy5zZWNvbmRzLS07XG4gICAgICAgIHRoaXMuZWwucXVlcnlTZWxlY3RvcignLnNlY29uZHMnKS5pbm5lckhUTUwgPSB0aGlzLnNlY29uZHMudG9TdHJpbmcoKTtcblxuICAgICAgICBpZiAodGhpcy5zZWNvbmRzIDw9IDMpIHtcbiAgICAgICAgICAgIHRoaXMuZWwuY2xhc3NMaXN0LnJlbW92ZSgnaXMtcHJpbWFyeScpO1xuICAgICAgICAgICAgdGhpcy5lbC5jbGFzc0xpc3QuYWRkKCdpcy1kYW5nZXInKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuZWwuY2xhc3NMaXN0LmFkZCgnaXMtcHJpbWFyeScpO1xuICAgICAgICAgICAgdGhpcy5lbC5jbGFzc0xpc3QucmVtb3ZlKCdpcy1kYW5nZXInKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0aGlzLnNlY29uZHMgPT09IDApIHtcbiAgICAgICAgICAgIHdpbmRvdy5kaXNwYXRjaEV2ZW50KG5ldyBFdmVudCgndGltZXI6ZG9uZScpKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHB1YmxpYyBkZXN0cm95KCkge1xuICAgICAgICBjbGVhckludGVydmFsKHRoaXMuaW50ZXJ2YWxJZCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVGVtcGxhdGUgbmVlZGVkIHRvIHNob3cgbW9yZSBlbGVtZW50c1xuICAgICAqL1xuICAgIHByaXZhdGUgcmVuZGVyVGVtcGxhdGUoKSB7XG4gICAgICAgIHRoaXMuZWwuaW5uZXJIVE1MID0gYFxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cIm1lc3NhZ2UtYm9keVwiPlxuICAgICAgICAgICAgICAgIDxzcGFuPnRpbWU6IDwvc3Bhbj5cbiAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz1cInNlY29uZHNcIj48L3NwYW4+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgYDtcbiAgICB9XG59XG4iLCJpbXBvcnQgY29uZmlnIGZyb20gJy4uL2NvbmZpZy5qc29uJztcbmltcG9ydCBEb21FbGVtZW50IGZyb20gXCIuLi9oZWxwZXJzL2RvbWVsZW1lbnRcIjtcbmltcG9ydCBCbG9jayBmcm9tIFwiLi9ibG9ja1wiO1xuaW1wb3J0IFBsYXllciBmcm9tIFwiLi9wbGF5ZXJcIjtcbmltcG9ydCBUaW1lciBmcm9tIFwiLi90aW1lclwiO1xuaW1wb3J0IFV0aWxzIGZyb20gXCIuLi9oZWxwZXJzL3V0aWxzXCI7XG5pbXBvcnQgV2luZG93RXZlbnRIYW5kbGVyIGZyb20gXCIuLi9oZWxwZXJzL3dpbmRvd2V2ZW50aGFuZGxlclwiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBMZXZlbCBleHRlbmRzIERvbUVsZW1lbnQge1xuICAgIHByaXZhdGUgcmVhZG9ubHkgdG90YWxCbG9ja3M6IG51bWJlcjtcbiAgICBwcml2YXRlIHJlYWRvbmx5IHNjb3JlUGVyQmxvY2s6IG51bWJlcjtcbiAgICBwcml2YXRlIGJsb2NrczogQmxvY2tbXSA9IFtdO1xuICAgIHByaXZhdGUgcGxheWVyOiBQbGF5ZXI7XG4gICAgcHJpdmF0ZSB0aW1lcjogVGltZXI7XG4gICAgcHVibGljIGZhaWxlZCA9IGZhbHNlO1xuXG4gICAgY29uc3RydWN0b3IodG90YWxCbG9ja3M6IG51bWJlciwgc2NvcmVQZXJCbG9jazogbnVtYmVyKSB7XG4gICAgICAgIHN1cGVyKCdsZXZlbCcsIDAsIDApO1xuXG4gICAgICAgIHRoaXMudG90YWxCbG9ja3MgPSB0b3RhbEJsb2NrcztcbiAgICAgICAgdGhpcy5zY29yZVBlckJsb2NrID0gc2NvcmVQZXJCbG9jaztcbiAgICAgICAgdGhpcy5wbGF5ZXIgPSBuZXcgUGxheWVyKCk7XG4gICAgICAgIHRoaXMudGltZXIgPSBuZXcgVGltZXIoKTtcblxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMudG90YWxCbG9ja3M7IGkrKykge1xuICAgICAgICAgICAgdGhpcy5ibG9ja3MucHVzaChuZXcgQmxvY2soVXRpbHMuZ2V0UmFuZG9tQ29sb3IoKSwgVXRpbHMuZ2V0UmFuZG9tSW50KGNvbmZpZy5nYW1lLmJsb2NrU3BlZWQubWluLCBjb25maWcuZ2FtZS5ibG9ja1NwZWVkLm1heCksIFV0aWxzLmdldFJhbmRvbUludChjb25maWcuZ2FtZS5ibG9ja1BpeGVscy5taW4sIGNvbmZpZy5nYW1lLmJsb2NrUGl4ZWxzLm1heCksIFV0aWxzLmdldFJhbmRvbUludChjb25maWcuZ2FtZS5ibG9ja1BpeGVscy5taW4sIGNvbmZpZy5nYW1lLmJsb2NrUGl4ZWxzLm1heCkpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIFdpbmRvd0V2ZW50SGFuZGxlci5hZGRFdmVudExpc3RlbmVyKCd0aW1lcjpkb25lJywgKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5mYWlsZWQgPSB0cnVlO1xuICAgICAgICAgICAgdGhpcy5kZXN0cm95KCdsZXZlbDpmYWlsZWQnKTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2hlY2tzIGZvciBjb2xsaXNpb24gYW5kIHBvdGVudGlhbCBzdWNjZXNzIG9mIHRoaXMgbGV2ZWxcbiAgICAgKi9cbiAgICBwdWJsaWMgdXBkYXRlKCkge1xuICAgICAgICB0aGlzLnBsYXllci51cGRhdGUoKTtcbiAgICAgICAgdGhpcy5ibG9ja3MuZm9yRWFjaCgoYmxvY2ssIGluZGV4KSA9PiB7XG4gICAgICAgICAgICBibG9jay51cGRhdGUoKTtcblxuICAgICAgICAgICAgaWYgKFV0aWxzLmNoZWNrQ29sbGlzaW9uKHRoaXMucGxheWVyLmdldENsaWVudFJlYWN0KCksIGJsb2NrLmdldENsaWVudFJlYWN0KCkpICYmIHRoaXMuZmFpbGVkID09PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgIHRoaXMucGxheWVyLmJsb2NrQ2F1Z2h0KGJsb2NrKTtcbiAgICAgICAgICAgICAgICBibG9jay5kZXN0cm95KCk7XG4gICAgICAgICAgICAgICAgdGhpcy5ibG9ja3Muc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgICAgICAgICAgICB3aW5kb3cuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoJ2xldmVsOnNjb3JlVXBkYXRlJywge2RldGFpbDoge3Njb3JlOiB0aGlzLnNjb3JlUGVyQmxvY2t9fSkpO1xuXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuYmxvY2tzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmRlc3Ryb3koJ2xldmVsOnN1Y2Nlc3MnKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIERlc3Ryb3kgb2JqZWN0ICYgdGltZXIgYW5kIHRyaWdnZXIgZXZlbnQgdG8gbm90aWZ5IHRoZSB3b3JsZCBhYm91dCB0aGUgc3RhdHVzIG9mIHRoaXMgbGV2ZWxcbiAgICAgKlxuICAgICAqIEBwYXJhbSBldmVudFR5cGVcbiAgICAgKi9cbiAgICBwcml2YXRlIGRlc3Ryb3koZXZlbnRUeXBlOiBzdHJpbmcpIHtcbiAgICAgICAgdGhpcy50aW1lci5kZXN0cm95KCk7XG4gICAgICAgIHRoaXMucGxheWVyLmRlc3Ryb3koKTtcbiAgICAgICAgdGhpcy5ibG9ja3MuZm9yRWFjaCgoYmxvY2ssIGluZGV4KSA9PiB7XG4gICAgICAgICAgICBibG9jay5kZXN0cm95KCk7XG4gICAgICAgICAgICB0aGlzLmJsb2Nrcy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICB9KTtcbiAgICAgICAgV2luZG93RXZlbnRIYW5kbGVyLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3RpbWVyOmRvbmUnKTtcbiAgICAgICAgd2luZG93LmRpc3BhdGNoRXZlbnQobmV3IEV2ZW50KGV2ZW50VHlwZSkpO1xuICAgICAgICB0aGlzLmVsLnJlbW92ZSgpO1xuICAgIH1cbn1cbiIsImltcG9ydCBHYW1lIGZyb20gJy4vZ2FtZSc7XG5cbndpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwibG9hZFwiLCAoKSA9PiBuZXcgR2FtZSgpKTtcbiIsImltcG9ydCBjb25maWcgZnJvbSAnLi9jb25maWcuanNvbic7XG5pbXBvcnQgR1VJIGZyb20gJy4vZ3VpL2d1aSc7XG5pbXBvcnQgTGV2ZWwgZnJvbSBcIi4vbGV2ZWwvbGV2ZWxcIjtcbmltcG9ydCBEYXRhU2VydmljZSBmcm9tIFwiLi9kYXRhc2VydmljZVwiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBHYW1lIHtcbiAgICBwcml2YXRlIGxldmVsITogTGV2ZWw7XG4gICAgcHJpdmF0ZSBsZXZlbHNQZXJHYW1lOiBudW1iZXIgPSBjb25maWcuZ2FtZS5sZXZlbHNQZXJHYW1lO1xuICAgIHByaXZhdGUgY3VycmVudExldmVsc1BsYXllZDogbnVtYmVyID0gMDtcbiAgICBwcml2YXRlIHN0YXJ0RWxlbWVudHNQZXJMZXZlbDogbnVtYmVyID0gY29uZmlnLmdhbWUuc3RhcnRFbGVtZW50c1BlckxldmVsO1xuICAgIHByaXZhdGUgZWxlbWVudHNJbmNyZWFzZVBlckxldmVsOiBudW1iZXIgPSBjb25maWcuZ2FtZS5lbGVtZW50c0luY3JlYXNlUGVyTGV2ZWw7XG4gICAgcHJpdmF0ZSBzY29yZVBlckVsZW1lbnQ6IG51bWJlciA9IGNvbmZpZy5nYW1lLnNjb3JlUGVyRWxlbWVudDtcbiAgICBwcml2YXRlIHJlYWRvbmx5IG1heFNjb3JlOiBudW1iZXI7XG4gICAgcHJpdmF0ZSBndWk6IEdVSTtcbiAgICBwcml2YXRlIGRhdGFTZXJ2aWNlOiBEYXRhU2VydmljZTtcblxuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICB0aGlzLmd1aSA9IG5ldyBHVUkoKTtcbiAgICAgICAgdGhpcy5tYXhTY29yZSA9IHRoaXMuY2FsY3VsYXRlTWF4U2NvcmUoKTtcbiAgICAgICAgdGhpcy5nYW1lTG9vcCgpO1xuICAgICAgICB0aGlzLmRhdGFTZXJ2aWNlID0gbmV3IERhdGFTZXJ2aWNlKCk7XG5cbiAgICAgICAgWydsZXZlbDpzdWNjZXNzJywgJ2xldmVsOmZhaWxlZCddLm1hcCgoZXZlbnRUeXBlKSA9PiB7XG4gICAgICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihldmVudFR5cGUsIChlKSA9PiB0aGlzLnVwZGF0ZShlLnR5cGUpKTtcbiAgICAgICAgfSk7XG4gICAgICAgIFsnZ2FtZTpzdGFydDpjbGljaycsICdsZXZlbDpzdWNjZXNzOmNsaWNrJywgJ2xldmVsOmZhaWxlZDpjbGljayddLm1hcCgoZXZlbnRUeXBlKSA9PiB7XG4gICAgICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihldmVudFR5cGUsICgpID0+IHRoaXMuc3RhcnROZXdMZXZlbCgpKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdnYW1lOmVuZDpjbGljaycsICgpID0+IHRoaXMucmVzdGFydCgpKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDYWxjdWxhdGUgdGhlIHNjb3JlIHdpdGggYXZhaWxhYmxlIHBhcmFtZXRlcnNcbiAgICAgKlxuICAgICAqIEB0b2RvIERvIEkgcmVhbGx5IG5lZWQgdG8gdG8gdGhpcyBzbyBpbmVmZmljaWVudC4uP1xuICAgICAqIEByZXR1cm5zIHtudW1iZXJ9XG4gICAgICovXG4gICAgcHJpdmF0ZSBjYWxjdWxhdGVNYXhTY29yZSgpIHtcbiAgICAgICAgbGV0IG1heFNjb3JlID0gMDtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmxldmVsc1BlckdhbWU7IGkrKykge1xuICAgICAgICAgICAgbGV0IGVsZW1lbnRzID0gdGhpcy5zdGFydEVsZW1lbnRzUGVyTGV2ZWwgKyAoaSA9PT0gMCA/IDAgOiAodGhpcy5lbGVtZW50c0luY3JlYXNlUGVyTGV2ZWwgKiBpKSk7XG4gICAgICAgICAgICBtYXhTY29yZSArPSAoZWxlbWVudHMgKiB0aGlzLnNjb3JlUGVyRWxlbWVudCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG1heFNjb3JlO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRoZSBvbmx5IHBsYWNlIGZvciBhIHJlcXVlc3RBbmltYXRpb25GcmFtZVxuICAgICAqL1xuICAgIHByaXZhdGUgZ2FtZUxvb3AoKSB7XG4gICAgICAgIGlmICh0eXBlb2YgdGhpcy5sZXZlbCAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgIHRoaXMubGV2ZWwudXBkYXRlKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKCgpID0+IHRoaXMuZ2FtZUxvb3AoKSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVXBkYXRlIHRoZSBnYW1lIGJ5IGVpdGhlciB0aGUgZW5kIG9yIGFueXRoaW5nIGluIGJldHdlZW4gbGV2ZWxzXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gdHlwZVxuICAgICAqL1xuICAgIHByaXZhdGUgdXBkYXRlKHR5cGU6IHN0cmluZykge1xuICAgICAgICB0aGlzLmN1cnJlbnRMZXZlbHNQbGF5ZWQrKztcbiAgICAgICAgaWYgKHRoaXMuY3VycmVudExldmVsc1BsYXllZCA9PT0gdGhpcy5sZXZlbHNQZXJHYW1lKSB7XG4gICAgICAgICAgICB0aGlzLmd1aS5nYW1lRW5kKHRoaXMubWF4U2NvcmUpO1xuICAgICAgICAgICAgdGhpcy5zYXZlU2NvcmUoKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuZ3VpLmxldmVsRG9uZSh0eXBlKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUaW1lIHRvIHN0YXJ0IGEgbmV3IGxldmVsIHdpdGggbWFkbmVzc1xuICAgICAqL1xuICAgIHByaXZhdGUgc3RhcnROZXdMZXZlbCgpIHtcbiAgICAgICAgaWYgKHRoaXMubGV2ZWwgJiYgdGhpcy5sZXZlbC5mYWlsZWQgPT09IGZhbHNlKSB7XG4gICAgICAgICAgICB0aGlzLnN0YXJ0RWxlbWVudHNQZXJMZXZlbCArPSB0aGlzLmVsZW1lbnRzSW5jcmVhc2VQZXJMZXZlbDtcbiAgICAgICAgfVxuXG4gICAgICAgIGRlbGV0ZSB0aGlzLmxldmVsO1xuICAgICAgICB0aGlzLmd1aS5uZXdMZXZlbCgpO1xuXG4gICAgICAgIHRoaXMubGV2ZWwgPSBuZXcgTGV2ZWwodGhpcy5zdGFydEVsZW1lbnRzUGVyTGV2ZWwsIHRoaXMuc2NvcmVQZXJFbGVtZW50KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTdGFydCBldmVyeXRoaW5nIGZyb20gdGhlIGJlZ2lubmluZ1xuICAgICAqL1xuICAgIHByaXZhdGUgcmVzdGFydCgpIHtcbiAgICAgICAgdGhpcy5ndWkucmVzdGFydCgpO1xuICAgICAgICB0aGlzLmN1cnJlbnRMZXZlbHNQbGF5ZWQgPSAwO1xuICAgICAgICB0aGlzLnN0YXJ0RWxlbWVudHNQZXJMZXZlbCA9IDU7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2FsbCB0aGUgZGF0YSBzZXJ2aWNlIGFuZCBsZXQgaXQgZG8gaXRzIG1hZ2ljXG4gICAgICovXG4gICAgcHJpdmF0ZSBzYXZlU2NvcmUoKSB7XG4gICAgICAgIGxldCBzY29yZSA9IHRoaXMuZ3VpLmdldFNjb3JlKCk7XG4gICAgICAgIHRoaXMuZGF0YVNlcnZpY2Uuc2F2ZVNjb3JlKHNjb3JlKS50aGVuKChkYXRhKSA9PiB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnUmVzcG9uc2UgYWZ0ZXIgc2F2aW5nIHNjb3JlJywgZGF0YSk7XG4gICAgICAgIH0pO1xuICAgIH1cbn1cbiJdLCJzb3VyY2VSb290IjoiIn0=