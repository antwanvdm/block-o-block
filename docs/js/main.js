!function(e){var t={};function s(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,s),r.l=!0,r.exports}s.m=e,s.c=t,s.d=function(e,t,i){s.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:i})},s.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s(s.s=1)}([function(e){e.exports={functionalities:{dataService:!0},dataService:{baseUrl:"https://api.mlab.com/api/1",apiKey:"X17utv1FH2dFTeUo4yhNGL54sA7CY2jS",databaseName:"typescript_scores",collectionName:"scores"}}},function(e,t,s){"use strict";s.r(t);class i{constructor(e,t,s,i=""){this.x=t,this.y=s,this.el=document.createElement("div");let r=document.getElementById("main");if(null===r)throw new Error("<main> element doesn't exist!");if(this.x>-1&&this.y>-1&&(this.el.style.transform=`translate(${this.x}px, ${this.y}px)`),this.el.classList.add(`game-${e}`),""===i)r.appendChild(this.el);else{let e=document.querySelector(`.game-${i}`);if(null===e)throw new Error(`<.game-${i}> element doesn't exist!`);e.appendChild(this.el)}}getClientReact(){return this.el.getBoundingClientRect()}}class r extends i{constructor(){super("score",-1,-1,"gui"),this.score=0,this.renderTemplate(),this.el.querySelector(".message-body").innerHTML=`score: ${this.score.toString()}`,this.el.classList.add("message","is-warning")}get(){return this.score}update(e,t=!1){this.score=t?e:this.score+e,this.el.querySelector(".message-body").innerHTML=`score: ${this.score.toString()}`}renderTemplate(){this.el.innerHTML='\n            <div class="message-body"></div>\n        '}}class n{static addEventListener(e,t){n.functionMap[e]=t,window.addEventListener(e.split(".")[0],n.functionMap[e])}static removeEventListener(e){window.removeEventListener(e.split(".")[0],n.functionMap[e]),delete n.functionMap[e]}}n.functionMap={};class a extends i{constructor(){super("messagescreen",0,0,"gui"),this.height=200,this.width=400,this.isActive=!1,this.messages={"game:start":{header:"Welcome to Block-o-Block!",body:"It's time to catch them blocks!<br/><br/>Use your arrow keys to move your player around and press space to start.",className:"is-info"},"game:end":{header:"Your game is over!",body:"You made it, your final score is __SCORE__ out of max __MAX_SCORE__ points.<br/><br/>Thanks for playing, press space to restart the madness",className:"is-success"},"level:success":{header:"YEAH! Level completed!",body:"Performing like a boss! Press space to proceed to the next level and catch even more blocks",className:"is-success"},"level:failed":{header:"AAH! Level failed!",body:"Try again and show us what you're made off! Press space to restart this level",className:"is-danger"}},this.x=window.outerWidth/2-this.width/2,this.y=document.documentElement.clientHeight/2-this.height/2,this.el.classList.add("message"),this.el.style.width=`${this.width}px`,this.el.style.transform=`translate(${this.x}px, ${this.y}px)`,this.renderTemplate(),this.show("game:start"),n.addEventListener("keyup.messagescreen",e=>this.keyBoardHandler(e))}keyBoardHandler(e){32===e.keyCode&&!0===this.isActive&&window.dispatchEvent(new Event(`${this.currentEvent}:click`))}show(e,t={}){let s=this.messages[e].header,i=this.messages[e].body;for(let e in t)i=i.replace(e,t[e]);this.el.querySelector(".message-header").innerHTML=s,this.el.querySelector(".message-body").innerHTML=i,this.el.classList.add("show",this.messages[e].className),this.currentEvent=e,this.isActive=!0}hide(){this.el.classList.remove("show","is-info","is-success","is-danger"),this.isActive=!1}renderTemplate(){this.el.innerHTML='\n            <div class="message-header"></div>\n            <div class="message-body"></div>\n        '}}class h extends i{constructor(){super("gui",0,0),this.score=new r,this.messageScreen=new a,window.addEventListener("level:scoreUpdate",e=>this.score.update(e.detail.score))}levelDone(e){this.messageScreen.show(e)}newLevel(){this.messageScreen.hide()}gameEnd(e){this.messageScreen.show("game:end",{__SCORE__:this.score.get().toString(),__MAX_SCORE__:e.toString()})}restart(){this.messageScreen.hide(),this.messageScreen.show("game:start"),this.score.update(0,!0)}getScore(){return this.score.get()}}class o{static getRandomColor(){let e=Math.round,t=Math.random;return`rgba(${e(255*t())},${e(255*t())},${e(255*t())},1)`}static getRandomInt(e,t){return Math.floor(Math.random()*(t-e+1))+e}static checkCollision(e,t){return e.left<=t.right&&t.left<=e.right&&e.top<=t.bottom&&t.top<=e.bottom}}class l extends i{constructor(e,t,s,i){super("block",0,0,"level"),this.destination={x:0,y:0},this.speed=t,this.width=s,this.height=i,this.color=e,this.el.style.backgroundImage=`repeating-linear-gradient(${o.getRandomInt(0,360)}deg, #000000, #000000 ${o.getRandomInt(2,10)}px, ${this.color} 10px, ${this.color} ${o.getRandomInt(20,40)}px)`,this.el.style.width=`${this.width}px`,this.el.style.height=`${this.height}px`,this.x=o.getRandomInt(0,window.outerWidth-this.width),this.y=o.getRandomInt(0,document.documentElement.clientHeight-this.height),this.el.style.transform=`translate(${this.x}px, ${this.y}px)`}destroy(){this.el.remove()}update(){this.x>this.destination.x-this.speed&&this.x<this.destination.x+this.speed&&(this.destination.x=o.getRandomInt(0,window.outerWidth-this.width)),this.y>this.destination.y-this.speed&&this.y<this.destination.y+this.speed&&(this.destination.y=o.getRandomInt(0,document.documentElement.clientHeight-this.height)),this.destination.x>=this.x?this.x+=this.speed:this.x-=this.speed,this.destination.y>=this.y?this.y+=this.speed:this.y-=this.speed,this.el.style.transform=`translate(${this.x}px, ${this.y}px)`}}class d extends i{constructor(){super("player",0,0,"level"),this.height=10,this.width=10,this.growthFactor=1.5,this.speed=2,this.speedIncreaseFactor=.2,this.keysAllowed=[37,38,39,40],this.keysPressed=[],this.x=window.outerWidth/2-this.width/2,this.y=document.documentElement.clientHeight/2-this.height/2,this.el.style.width=`${this.width}px`,this.el.style.height=`${this.height}px`,this.el.style.borderRadius=`${this.width}px`,n.addEventListener("keydown.player",e=>this.keyDownHandler(e)),n.addEventListener("keyup.player",e=>this.keyUpHandler(e))}keyDownHandler(e){let t=e.keyCode;this.keysAllowed.indexOf(t)>-1&&-1===this.keysPressed.indexOf(t)&&this.keysPressed.push(t)}keyUpHandler(e){let t=e.keyCode,s=this.keysPressed.indexOf(t);this.keysAllowed.indexOf(t)>-1&&s>-1&&this.keysPressed.splice(s,1)}update(){this.keysPressed.forEach(e=>{switch(e){case 37:this.x-=this.speed;break;case 38:this.y-=this.speed;break;case 39:this.x+=this.speed;break;case 40:this.y+=this.speed;break;default:return}}),this.x<0&&(this.x=0),this.y<0&&(this.y=0),this.x>window.outerWidth-this.width&&(this.x=window.outerWidth-this.width),this.y>document.documentElement.clientHeight-this.height&&(this.y=document.documentElement.clientHeight-this.height),this.el.style.transform=`translate(${this.x}px, ${this.y}px)`}blockCaught(e){this.speed+=this.speedIncreaseFactor,this.width+=this.growthFactor,this.height+=this.growthFactor,this.el.style.height=`${this.height}px`,this.el.style.width=`${this.width}px`,this.el.style.borderRadius=`${this.width}px`,this.el.style.backgroundColor=e.color}destroy(){n.removeEventListener("keydown.player"),n.removeEventListener("keyup.player")}}class c extends i{constructor(){super("timer",-1,-1,"level"),this.seconds=10,this.renderTemplate(),this.el.classList.add("message","is-primary"),this.el.querySelector(".message-body").innerHTML=`time: ${this.seconds}`,this.intervalId=setInterval(()=>this.update(),1e3)}update(){this.seconds--,this.el.querySelector(".message-body").innerHTML=`time: ${this.seconds}`,0===this.seconds&&window.dispatchEvent(new Event("timer:done"))}destroy(){clearInterval(this.intervalId)}renderTemplate(){this.el.innerHTML='\n            <div class="message-body"></div>\n        '}}class m extends i{constructor(e,t){super("level",0,0),this.blocks=[],this.failed=!1,this.totalBlocks=e,this.scorePerBlock=t,this.player=new d,this.timer=new c;for(let e=0;e<this.totalBlocks;e++)this.blocks.push(new l(o.getRandomColor(),o.getRandomInt(1,5),o.getRandomInt(10,150),o.getRandomInt(10,150)));n.addEventListener("timer:done",()=>{this.failed=!0,this.destroy("level:failed")})}update(){this.player.update(),this.blocks.forEach((e,t)=>{e.update(),o.checkCollision(this.player.getClientReact(),e.getClientReact())&&!1===this.failed&&(this.player.blockCaught(e),e.destroy(),this.blocks.splice(t,1),window.dispatchEvent(new CustomEvent("level:scoreUpdate",{detail:{score:this.scorePerBlock}})),0===this.blocks.length&&this.destroy("level:success"))})}destroy(e){this.timer.destroy(),this.player.destroy(),this.blocks.forEach((e,t)=>{e.destroy(),this.blocks.splice(t,1)}),n.removeEventListener("timer:done"),window.dispatchEvent(new Event(e)),this.el.remove()}}var u=s(0);class p{constructor(){this.endPointList=`/databases/${u.dataService.databaseName}/collections/${u.dataService.collectionName}?apiKey=${u.dataService.apiKey}`,this.endPointSave=`/databases/${u.dataService.databaseName}/collections/${u.dataService.collectionName}?apiKey=${u.dataService.apiKey}`}saveScore(e){if(!1===u.functionalities.dataService)return this.disabled();let t=`${u.dataService.baseUrl}${this.endPointSave}`;return fetch(t,{body:JSON.stringify({score:e}),headers:{"content-type":"application/json"},method:"POST",mode:"cors"}).then(e=>e.json())}getScores(){if(!1===u.functionalities.dataService)return this.disabled();let e=`${u.dataService.baseUrl}${this.endPointList}`;return fetch(e,{mode:"cors"}).then(e=>e.json())}disabled(){return new Promise(e=>{e({error:"Dataservice is disabled"})})}}window.addEventListener("load",()=>new class{constructor(){this.levelsPerGame=10,this.currentLevelsPlayed=0,this.elementsPerLevel=5,this.elementsIncreasePerLevel=5,this.scorePerElement=10,this.gui=new h,this.maxScore=this.calculateMaxScore(),this.gameLoop(),this.dataService=new p,this.dataService.getScores().then(e=>{console.log("Current scores",e)}),["level:success","level:failed"].map(e=>{window.addEventListener(e,e=>this.update(e.type))}),["game:start:click","level:success:click","level:failed:click"].map(e=>{window.addEventListener(e,()=>this.startNewLevel())}),window.addEventListener("game:end:click",()=>this.restart())}calculateMaxScore(){let e=0;for(let t=0;t<this.levelsPerGame;t++)e+=(this.elementsPerLevel+(0===t?0:this.elementsIncreasePerLevel*t))*this.scorePerElement;return e}gameLoop(){void 0!==this.level&&this.level.update(),requestAnimationFrame(()=>this.gameLoop())}update(e){if(this.currentLevelsPlayed++,this.currentLevelsPlayed===this.levelsPerGame)return this.gui.gameEnd(this.maxScore),void this.saveScore();this.gui.levelDone(e)}startNewLevel(){this.level&&!1===this.level.failed&&(this.elementsPerLevel+=this.elementsIncreasePerLevel),delete this.level,this.gui.newLevel(),this.level=new m(this.elementsPerLevel,this.scorePerElement)}restart(){this.gui.restart(),this.currentLevelsPlayed=0,this.elementsPerLevel=5}saveScore(){let e=this.gui.getScore();this.dataService.saveScore(e).then(e=>{console.log("Response after saving score",e)})}})}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vZGV2L2hlbHBlcnMvZG9tZWxlbWVudC50cyIsIndlYnBhY2s6Ly8vLi9kZXYvZ3VpL3Njb3JlLnRzIiwid2VicGFjazovLy8uL2Rldi9oZWxwZXJzL3dpbmRvd2V2ZW50aGFuZGxlci50cyIsIndlYnBhY2s6Ly8vLi9kZXYvZ3VpL21lc3NhZ2VzY3JlZW4udHMiLCJ3ZWJwYWNrOi8vLy4vZGV2L2d1aS9ndWkudHMiLCJ3ZWJwYWNrOi8vLy4vZGV2L2hlbHBlcnMvdXRpbHMudHMiLCJ3ZWJwYWNrOi8vLy4vZGV2L2xldmVsL2Jsb2NrLnRzIiwid2VicGFjazovLy8uL2Rldi9sZXZlbC9wbGF5ZXIudHMiLCJ3ZWJwYWNrOi8vLy4vZGV2L2xldmVsL3RpbWVyLnRzIiwid2VicGFjazovLy8uL2Rldi9sZXZlbC9sZXZlbC50cyIsIndlYnBhY2s6Ly8vLi9kZXYvZGF0YXNlcnZpY2UudHMiLCJ3ZWJwYWNrOi8vLy4vZGV2L21haW4udHMiLCJ3ZWJwYWNrOi8vLy4vZGV2L2dhbWUudHMiXSwibmFtZXMiOlsiaW5zdGFsbGVkTW9kdWxlcyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImV4cG9ydHMiLCJtb2R1bGUiLCJpIiwibCIsIm1vZHVsZXMiLCJjYWxsIiwibSIsImMiLCJkIiwibmFtZSIsImdldHRlciIsIm8iLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImNvbmZpZ3VyYWJsZSIsImVudW1lcmFibGUiLCJnZXQiLCJyIiwidmFsdWUiLCJuIiwiX19lc01vZHVsZSIsIm9iamVjdCIsInByb3BlcnR5IiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJwIiwicyIsIkRvbUVsZW1lbnQiLCJbb2JqZWN0IE9iamVjdF0iLCJ0eXBlIiwieCIsInkiLCJwYXJlbnRDbGFzcyIsInRoaXMiLCJlbCIsImRvY3VtZW50IiwiY3JlYXRlRWxlbWVudCIsIm1haW4iLCJnZXRFbGVtZW50QnlJZCIsIkVycm9yIiwic3R5bGUiLCJ0cmFuc2Zvcm0iLCJjbGFzc0xpc3QiLCJhZGQiLCJhcHBlbmRDaGlsZCIsInBhcmVudEVsIiwicXVlcnlTZWxlY3RvciIsImdldEJvdW5kaW5nQ2xpZW50UmVjdCIsInNjb3JlX1Njb3JlIiwic3VwZXIiLCJzY29yZSIsInJlbmRlclRlbXBsYXRlIiwiaW5uZXJIVE1MIiwidG9TdHJpbmciLCJyZXNldCIsIldpbmRvd0V2ZW50SGFuZGxlciIsImV2ZW50IiwiZnVuYyIsImZ1bmN0aW9uTWFwIiwid2luZG93IiwiYWRkRXZlbnRMaXN0ZW5lciIsInNwbGl0IiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsIm1lc3NhZ2VzY3JlZW5fTWVzc2FnZVNjcmVlbiIsImhlaWdodCIsIndpZHRoIiwiaXNBY3RpdmUiLCJtZXNzYWdlcyIsImdhbWU6c3RhcnQiLCJoZWFkZXIiLCJib2R5IiwiY2xhc3NOYW1lIiwiZ2FtZTplbmQiLCJsZXZlbDpzdWNjZXNzIiwibGV2ZWw6ZmFpbGVkIiwib3V0ZXJXaWR0aCIsImRvY3VtZW50RWxlbWVudCIsImNsaWVudEhlaWdodCIsInNob3ciLCJlIiwia2V5Qm9hcmRIYW5kbGVyIiwia2V5Q29kZSIsImRpc3BhdGNoRXZlbnQiLCJFdmVudCIsImN1cnJlbnRFdmVudCIsImJvZHlSZXBsYWNlbWVudHMiLCJtZXNzYWdlSGVhZGVyIiwibWVzc2FnZUJvZHkiLCJyZXBsYWNlbWVudCIsInJlcGxhY2UiLCJyZW1vdmUiLCJndWlfR1VJIiwibWVzc2FnZVNjcmVlbiIsInVwZGF0ZSIsImRldGFpbCIsImhpZGUiLCJtYXhTY29yZSIsIl9fU0NPUkVfXyIsIl9fTUFYX1NDT1JFX18iLCJVdGlscyIsIk1hdGgiLCJyb3VuZCIsInJhbmRvbSIsIm1pbiIsIm1heCIsImZsb29yIiwiYSIsImIiLCJsZWZ0IiwicmlnaHQiLCJ0b3AiLCJib3R0b20iLCJibG9ja19CbG9jayIsImNvbG9yIiwic3BlZWQiLCJkZXN0aW5hdGlvbiIsImJhY2tncm91bmRJbWFnZSIsImdldFJhbmRvbUludCIsInBsYXllcl9QbGF5ZXIiLCJncm93dGhGYWN0b3IiLCJzcGVlZEluY3JlYXNlRmFjdG9yIiwia2V5c0FsbG93ZWQiLCJrZXlzUHJlc3NlZCIsImJvcmRlclJhZGl1cyIsImtleURvd25IYW5kbGVyIiwia2V5VXBIYW5kbGVyIiwia2V5IiwiaW5kZXhPZiIsInB1c2giLCJrZXlQcmVzc2VkUG9zaXRpb24iLCJzcGxpY2UiLCJmb3JFYWNoIiwiYmxvY2siLCJiYWNrZ3JvdW5kQ29sb3IiLCJ0aW1lcl9UaW1lciIsInNlY29uZHMiLCJpbnRlcnZhbElkIiwic2V0SW50ZXJ2YWwiLCJjbGVhckludGVydmFsIiwibGV2ZWxfTGV2ZWwiLCJ0b3RhbEJsb2NrcyIsInNjb3JlUGVyQmxvY2siLCJibG9ja3MiLCJmYWlsZWQiLCJwbGF5ZXIiLCJ0aW1lciIsImdldFJhbmRvbUNvbG9yIiwiZGVzdHJveSIsImluZGV4IiwiY2hlY2tDb2xsaXNpb24iLCJnZXRDbGllbnRSZWFjdCIsImJsb2NrQ2F1Z2h0IiwiQ3VzdG9tRXZlbnQiLCJsZW5ndGgiLCJldmVudFR5cGUiLCJkYXRhc2VydmljZV9EYXRhU2VydmljZSIsImVuZFBvaW50TGlzdCIsImNvbmZpZyIsImRhdGFTZXJ2aWNlIiwiZGF0YWJhc2VOYW1lIiwiY29sbGVjdGlvbk5hbWUiLCJhcGlLZXkiLCJlbmRQb2ludFNhdmUiLCJmdW5jdGlvbmFsaXRpZXMiLCJkaXNhYmxlZCIsInVybCIsImJhc2VVcmwiLCJmZXRjaCIsIkpTT04iLCJzdHJpbmdpZnkiLCJoZWFkZXJzIiwiY29udGVudC10eXBlIiwibWV0aG9kIiwibW9kZSIsInRoZW4iLCJyZXNwb25zZSIsImpzb24iLCJQcm9taXNlIiwicmVzb2x2ZSIsImVycm9yIiwibGV2ZWxzUGVyR2FtZSIsImN1cnJlbnRMZXZlbHNQbGF5ZWQiLCJlbGVtZW50c1BlckxldmVsIiwiZWxlbWVudHNJbmNyZWFzZVBlckxldmVsIiwic2NvcmVQZXJFbGVtZW50IiwiZ3VpIiwiY2FsY3VsYXRlTWF4U2NvcmUiLCJnYW1lTG9vcCIsImdldFNjb3JlcyIsImRhdGEiLCJjb25zb2xlIiwibG9nIiwibWFwIiwic3RhcnROZXdMZXZlbCIsInJlc3RhcnQiLCJsZXZlbCIsInJlcXVlc3RBbmltYXRpb25GcmFtZSIsImdhbWVFbmQiLCJzYXZlU2NvcmUiLCJsZXZlbERvbmUiLCJuZXdMZXZlbCIsImdldFNjb3JlIl0sIm1hcHBpbmdzIjoiYUFDQSxJQUFBQSxLQUdBLFNBQUFDLEVBQUFDLEdBR0EsR0FBQUYsRUFBQUUsR0FDQSxPQUFBRixFQUFBRSxHQUFBQyxRQUdBLElBQUFDLEVBQUFKLEVBQUFFLElBQ0FHLEVBQUFILEVBQ0FJLEdBQUEsRUFDQUgsWUFVQSxPQU5BSSxFQUFBTCxHQUFBTSxLQUFBSixFQUFBRCxRQUFBQyxJQUFBRCxRQUFBRixHQUdBRyxFQUFBRSxHQUFBLEVBR0FGLEVBQUFELFFBS0FGLEVBQUFRLEVBQUFGLEVBR0FOLEVBQUFTLEVBQUFWLEVBR0FDLEVBQUFVLEVBQUEsU0FBQVIsRUFBQVMsRUFBQUMsR0FDQVosRUFBQWEsRUFBQVgsRUFBQVMsSUFDQUcsT0FBQUMsZUFBQWIsRUFBQVMsR0FDQUssY0FBQSxFQUNBQyxZQUFBLEVBQ0FDLElBQUFOLEtBTUFaLEVBQUFtQixFQUFBLFNBQUFqQixHQUNBWSxPQUFBQyxlQUFBYixFQUFBLGNBQWlEa0IsT0FBQSxLQUlqRHBCLEVBQUFxQixFQUFBLFNBQUFsQixHQUNBLElBQUFTLEVBQUFULEtBQUFtQixXQUNBLFdBQTJCLE9BQUFuQixFQUFBLFNBQzNCLFdBQWlDLE9BQUFBLEdBRWpDLE9BREFILEVBQUFVLEVBQUFFLEVBQUEsSUFBQUEsR0FDQUEsR0FJQVosRUFBQWEsRUFBQSxTQUFBVSxFQUFBQyxHQUFzRCxPQUFBVixPQUFBVyxVQUFBQyxlQUFBbkIsS0FBQWdCLEVBQUFDLElBR3REeEIsRUFBQTJCLEVBQUEsR0FJQTNCLElBQUE0QixFQUFBLCtQQ25FY0MsRUFLVkMsWUFBWUMsRUFBY0MsRUFBV0MsRUFBV0Ms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SSw4QkFBK0JGIiwiZmlsZSI6Im1haW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIgXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuXG4gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXG4gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSkge1xuIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuIFx0XHR9XG4gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbiBcdFx0XHRpOiBtb2R1bGVJZCxcbiBcdFx0XHRsOiBmYWxzZSxcbiBcdFx0XHRleHBvcnRzOiB7fVxuIFx0XHR9O1xuXG4gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4gXHRcdG1vZHVsZS5sID0gdHJ1ZTtcblxuIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4gXHR9XG5cblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuXG4gXHQvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9uIGZvciBoYXJtb255IGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uZCA9IGZ1bmN0aW9uKGV4cG9ydHMsIG5hbWUsIGdldHRlcikge1xuIFx0XHRpZighX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIG5hbWUpKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIG5hbWUsIHtcbiBcdFx0XHRcdGNvbmZpZ3VyYWJsZTogZmFsc2UsXG4gXHRcdFx0XHRlbnVtZXJhYmxlOiB0cnVlLFxuIFx0XHRcdFx0Z2V0OiBnZXR0ZXJcbiBcdFx0XHR9KTtcbiBcdFx0fVxuIFx0fTtcblxuIFx0Ly8gZGVmaW5lIF9fZXNNb2R1bGUgb24gZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yID0gZnVuY3Rpb24oZXhwb3J0cykge1xuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7IHZhbHVlOiB0cnVlIH0pO1xuIFx0fTtcblxuIFx0Ly8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuIFx0XHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cbiBcdFx0XHRmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOlxuIFx0XHRcdGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTtcbiBcdFx0cmV0dXJuIGdldHRlcjtcbiBcdH07XG5cbiBcdC8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbFxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9O1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcblxuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IDEpO1xuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgRG9tRWxlbWVudCB7XG4gICAgcHJvdGVjdGVkIGVsOiBIVE1MRWxlbWVudDtcbiAgICBwcm90ZWN0ZWQgeDogbnVtYmVyO1xuICAgIHByb3RlY3RlZCB5OiBudW1iZXI7XG5cbiAgICBjb25zdHJ1Y3Rvcih0eXBlOiBzdHJpbmcsIHg6IG51bWJlciwgeTogbnVtYmVyLCBwYXJlbnRDbGFzczogc3RyaW5nID0gJycpIHtcbiAgICAgICAgdGhpcy54ID0geDtcbiAgICAgICAgdGhpcy55ID0geTtcblxuICAgICAgICB0aGlzLmVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgIGxldCBtYWluID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21haW4nKTtcbiAgICAgICAgaWYgKG1haW4gPT09IG51bGwpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIjxtYWluPiBlbGVtZW50IGRvZXNuJ3QgZXhpc3QhXCIpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8tMSBjaGVjayBpcyB0byBsZXQgQ1NTIGRvIGl0cyBvd24gam9iIEB0b2RvIGNsZWFuZXIgc29sdXRpb24/XG4gICAgICAgIGlmICh0aGlzLnggPiAtMSAmJiB0aGlzLnkgPiAtMSkge1xuICAgICAgICAgICAgdGhpcy5lbC5zdHlsZS50cmFuc2Zvcm0gPSBgdHJhbnNsYXRlKCR7dGhpcy54fXB4LCAke3RoaXMueX1weClgO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuZWwuY2xhc3NMaXN0LmFkZChgZ2FtZS0ke3R5cGV9YCk7XG5cbiAgICAgICAgaWYgKHBhcmVudENsYXNzID09PSAnJykge1xuICAgICAgICAgICAgbWFpbi5hcHBlbmRDaGlsZCh0aGlzLmVsKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGxldCBwYXJlbnRFbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYC5nYW1lLSR7cGFyZW50Q2xhc3N9YCk7XG4gICAgICAgICAgICBpZiAocGFyZW50RWwgPT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYDwuZ2FtZS0ke3BhcmVudENsYXNzfT4gZWxlbWVudCBkb2Vzbid0IGV4aXN0IWApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcGFyZW50RWwuYXBwZW5kQ2hpbGQodGhpcy5lbCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBAcmV0dXJucyBDbGllbnRSZWN0XG4gICAgICovXG4gICAgcHVibGljIGdldENsaWVudFJlYWN0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5lbC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICB9XG59XG4iLCJpbXBvcnQgRG9tRWxlbWVudCBmcm9tIFwiLi4vaGVscGVycy9kb21lbGVtZW50XCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFNjb3JlIGV4dGVuZHMgRG9tRWxlbWVudCB7XG4gICAgcHJpdmF0ZSBzY29yZTogbnVtYmVyID0gMDtcblxuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICBzdXBlcignc2NvcmUnLCAtMSwgLTEsICdndWknKTtcblxuICAgICAgICB0aGlzLnJlbmRlclRlbXBsYXRlKCk7XG4gICAgICAgIHRoaXMuZWwucXVlcnlTZWxlY3RvcignLm1lc3NhZ2UtYm9keScpLmlubmVySFRNTCA9IGBzY29yZTogJHt0aGlzLnNjb3JlLnRvU3RyaW5nKCl9YDtcbiAgICAgICAgdGhpcy5lbC5jbGFzc0xpc3QuYWRkKCdtZXNzYWdlJywgJ2lzLXdhcm5pbmcnKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZXRyaWV2ZSBjdXJyZW50IHNjb3JlXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyB7bnVtYmVyfVxuICAgICAqL1xuICAgIHB1YmxpYyBnZXQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnNjb3JlO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFVwZGF0ZSB0aGUgc2NvcmUgYmFzZWQgb24gYSBDdXN0b20gRXZlbnQgZnJvbSB0aGUgQmxvY2sgb2JqZWN0XG4gICAgICpcbiAgICAgKiBAcGFyYW0gc2NvcmVcbiAgICAgKiBAcGFyYW0gW3Jlc2V0XVxuICAgICAqL1xuICAgIHB1YmxpYyB1cGRhdGUoc2NvcmU6IG51bWJlciwgcmVzZXQ6IGJvb2xlYW4gPSBmYWxzZSkge1xuICAgICAgICB0aGlzLnNjb3JlID0gcmVzZXQgPyBzY29yZSA6IHRoaXMuc2NvcmUgKyBzY29yZTtcbiAgICAgICAgdGhpcy5lbC5xdWVyeVNlbGVjdG9yKCcubWVzc2FnZS1ib2R5JykuaW5uZXJIVE1MID0gYHNjb3JlOiAke3RoaXMuc2NvcmUudG9TdHJpbmcoKX1gO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRlbXBsYXRlIG5lZWRlZCB0byBzaG93IG1vcmUgZWxlbWVudHNcbiAgICAgKi9cbiAgICBwcml2YXRlIHJlbmRlclRlbXBsYXRlKCkge1xuICAgICAgICB0aGlzLmVsLmlubmVySFRNTCA9IGBcbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJtZXNzYWdlLWJvZHlcIj48L2Rpdj5cbiAgICAgICAgYDtcbiAgICB9XG59XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBXaW5kb3dFdmVudEhhbmRsZXIge1xuICAgIHByaXZhdGUgc3RhdGljIGZ1bmN0aW9uTWFwOiB7IFtrOiBzdHJpbmddOiBhbnkgfSA9IHt9O1xuXG4gICAgcHVibGljIHN0YXRpYyBhZGRFdmVudExpc3RlbmVyKGV2ZW50OiBzdHJpbmcsIGZ1bmM6IGFueSkge1xuICAgICAgICBXaW5kb3dFdmVudEhhbmRsZXIuZnVuY3Rpb25NYXBbZXZlbnRdID0gZnVuYztcbiAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoZXZlbnQuc3BsaXQoJy4nKVswXSwgV2luZG93RXZlbnRIYW5kbGVyLmZ1bmN0aW9uTWFwW2V2ZW50XSk7XG4gICAgfVxuXG4gICAgcHVibGljIHN0YXRpYyByZW1vdmVFdmVudExpc3RlbmVyKGV2ZW50OiBzdHJpbmcpIHtcbiAgICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoZXZlbnQuc3BsaXQoJy4nKVswXSwgV2luZG93RXZlbnRIYW5kbGVyLmZ1bmN0aW9uTWFwW2V2ZW50XSk7XG4gICAgICAgIGRlbGV0ZSBXaW5kb3dFdmVudEhhbmRsZXIuZnVuY3Rpb25NYXBbZXZlbnRdO1xuICAgIH1cbn1cbiIsImltcG9ydCBEb21FbGVtZW50IGZyb20gXCIuLi9oZWxwZXJzL2RvbWVsZW1lbnRcIjtcbmltcG9ydCBXaW5kb3dFdmVudEhhbmRsZXIgZnJvbSBcIi4uL2hlbHBlcnMvd2luZG93ZXZlbnRoYW5kbGVyXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIE1lc3NhZ2VTY3JlZW4gZXh0ZW5kcyBEb21FbGVtZW50IHtcbiAgICBwcml2YXRlIGhlaWdodDogbnVtYmVyID0gMjAwO1xuICAgIHByaXZhdGUgd2lkdGg6IG51bWJlciA9IDQwMDtcbiAgICBwcml2YXRlIGN1cnJlbnRFdmVudCE6IHN0cmluZztcbiAgICBwcml2YXRlIGlzQWN0aXZlOiBib29sZWFuID0gZmFsc2U7XG5cbiAgICBwcml2YXRlIG1lc3NhZ2VzOiB7IFtrOiBzdHJpbmddOiB7ICdoZWFkZXInOiBzdHJpbmcsICdib2R5Jzogc3RyaW5nLCAnY2xhc3NOYW1lJzogc3RyaW5nIH0gfSA9IHtcbiAgICAgICAgJ2dhbWU6c3RhcnQnOiB7XG4gICAgICAgICAgICAnaGVhZGVyJzogJ1dlbGNvbWUgdG8gQmxvY2stby1CbG9jayEnLFxuICAgICAgICAgICAgJ2JvZHknOiAnSXRcXCdzIHRpbWUgdG8gY2F0Y2ggdGhlbSBibG9ja3MhPGJyLz48YnIvPlVzZSB5b3VyIGFycm93IGtleXMgdG8gbW92ZSB5b3VyIHBsYXllciBhcm91bmQgYW5kIHByZXNzIHNwYWNlIHRvIHN0YXJ0LicsXG4gICAgICAgICAgICAnY2xhc3NOYW1lJzogJ2lzLWluZm8nXG4gICAgICAgIH0sXG4gICAgICAgICdnYW1lOmVuZCc6IHtcbiAgICAgICAgICAgICdoZWFkZXInOiAnWW91ciBnYW1lIGlzIG92ZXIhJyxcbiAgICAgICAgICAgICdib2R5JzogJ1lvdSBtYWRlIGl0LCB5b3VyIGZpbmFsIHNjb3JlIGlzIF9fU0NPUkVfXyBvdXQgb2YgbWF4IF9fTUFYX1NDT1JFX18gcG9pbnRzLjxici8+PGJyLz5UaGFua3MgZm9yIHBsYXlpbmcsIHByZXNzIHNwYWNlIHRvIHJlc3RhcnQgdGhlIG1hZG5lc3MnLFxuICAgICAgICAgICAgJ2NsYXNzTmFtZSc6ICdpcy1zdWNjZXNzJ1xuICAgICAgICB9LFxuICAgICAgICAnbGV2ZWw6c3VjY2Vzcyc6IHtcbiAgICAgICAgICAgICdoZWFkZXInOiAnWUVBSCEgTGV2ZWwgY29tcGxldGVkIScsXG4gICAgICAgICAgICAnYm9keSc6ICdQZXJmb3JtaW5nIGxpa2UgYSBib3NzISBQcmVzcyBzcGFjZSB0byBwcm9jZWVkIHRvIHRoZSBuZXh0IGxldmVsIGFuZCBjYXRjaCBldmVuIG1vcmUgYmxvY2tzJyxcbiAgICAgICAgICAgICdjbGFzc05hbWUnOiAnaXMtc3VjY2VzcydcbiAgICAgICAgfSxcbiAgICAgICAgJ2xldmVsOmZhaWxlZCc6IHtcbiAgICAgICAgICAgICdoZWFkZXInOiAnQUFIISBMZXZlbCBmYWlsZWQhJyxcbiAgICAgICAgICAgICdib2R5JzogJ1RyeSBhZ2FpbiBhbmQgc2hvdyB1cyB3aGF0IHlvdVxcJ3JlIG1hZGUgb2ZmISBQcmVzcyBzcGFjZSB0byByZXN0YXJ0IHRoaXMgbGV2ZWwnLFxuICAgICAgICAgICAgJ2NsYXNzTmFtZSc6ICdpcy1kYW5nZXInXG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHN1cGVyKCdtZXNzYWdlc2NyZWVuJywgMCwgMCwgJ2d1aScpO1xuXG4gICAgICAgIHRoaXMueCA9IHdpbmRvdy5vdXRlcldpZHRoIC8gMiAtIHRoaXMud2lkdGggLyAyO1xuICAgICAgICB0aGlzLnkgPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50SGVpZ2h0IC8gMiAtIHRoaXMuaGVpZ2h0IC8gMjtcblxuICAgICAgICB0aGlzLmVsLmNsYXNzTGlzdC5hZGQoJ21lc3NhZ2UnKTtcbiAgICAgICAgdGhpcy5lbC5zdHlsZS53aWR0aCA9IGAke3RoaXMud2lkdGh9cHhgO1xuICAgICAgICB0aGlzLmVsLnN0eWxlLnRyYW5zZm9ybSA9IGB0cmFuc2xhdGUoJHt0aGlzLnh9cHgsICR7dGhpcy55fXB4KWA7XG5cbiAgICAgICAgdGhpcy5yZW5kZXJUZW1wbGF0ZSgpO1xuICAgICAgICB0aGlzLnNob3coJ2dhbWU6c3RhcnQnKTtcbiAgICAgICAgV2luZG93RXZlbnRIYW5kbGVyLmFkZEV2ZW50TGlzdGVuZXIoJ2tleXVwLm1lc3NhZ2VzY3JlZW4nLCAoZTogS2V5Ym9hcmRFdmVudCkgPT4gdGhpcy5rZXlCb2FyZEhhbmRsZXIoZSkpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEhhbmRsZSB0aGUgc3BhY2ViYXJcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7S2V5Ym9hcmRFdmVudH0gZVxuICAgICAqL1xuICAgIGtleUJvYXJkSGFuZGxlcihlOiBLZXlib2FyZEV2ZW50KSB7XG4gICAgICAgIGlmIChlLmtleUNvZGUgPT09IDMyICYmIHRoaXMuaXNBY3RpdmUgPT09IHRydWUpIHtcbiAgICAgICAgICAgIHdpbmRvdy5kaXNwYXRjaEV2ZW50KG5ldyBFdmVudChgJHt0aGlzLmN1cnJlbnRFdmVudH06Y2xpY2tgKSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTaG93IHRoZSBkZXNpcmVkIG1lc3NhZ2UgKHR5cGUgbWF0Y2hlcyBpbmRleCBpbiBvYmplY3QpXG4gICAgICpcbiAgICAgKiBAcGFyYW0gdHlwZVxuICAgICAqIEBwYXJhbSBbYm9keVJlcGxhY2VtZW50c11cbiAgICAgKi9cbiAgICBwdWJsaWMgc2hvdyh0eXBlOiBzdHJpbmcsIGJvZHlSZXBsYWNlbWVudHM6IHsgW2s6IHN0cmluZ106IHN0cmluZyB9ID0ge30pIHtcbiAgICAgICAgbGV0IG1lc3NhZ2VIZWFkZXIgPSB0aGlzLm1lc3NhZ2VzW3R5cGVdLmhlYWRlcjtcbiAgICAgICAgbGV0IG1lc3NhZ2VCb2R5ID0gdGhpcy5tZXNzYWdlc1t0eXBlXS5ib2R5O1xuICAgICAgICBmb3IgKGxldCByZXBsYWNlbWVudCBpbiBib2R5UmVwbGFjZW1lbnRzKSB7XG4gICAgICAgICAgICBtZXNzYWdlQm9keSA9IG1lc3NhZ2VCb2R5LnJlcGxhY2UocmVwbGFjZW1lbnQsIGJvZHlSZXBsYWNlbWVudHNbcmVwbGFjZW1lbnRdKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuZWwucXVlcnlTZWxlY3RvcignLm1lc3NhZ2UtaGVhZGVyJykuaW5uZXJIVE1MID0gbWVzc2FnZUhlYWRlcjtcbiAgICAgICAgdGhpcy5lbC5xdWVyeVNlbGVjdG9yKCcubWVzc2FnZS1ib2R5JykuaW5uZXJIVE1MID0gbWVzc2FnZUJvZHk7XG5cbiAgICAgICAgdGhpcy5lbC5jbGFzc0xpc3QuYWRkKCdzaG93JywgdGhpcy5tZXNzYWdlc1t0eXBlXS5jbGFzc05hbWUpO1xuICAgICAgICB0aGlzLmN1cnJlbnRFdmVudCA9IHR5cGU7XG4gICAgICAgIHRoaXMuaXNBY3RpdmUgPSB0cnVlO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEhpZGUgbWVzc2FnZSBvbiBzY3JlZW5cbiAgICAgKi9cbiAgICBwdWJsaWMgaGlkZSgpIHtcbiAgICAgICAgdGhpcy5lbC5jbGFzc0xpc3QucmVtb3ZlKCdzaG93JywgJ2lzLWluZm8nLCAnaXMtc3VjY2VzcycsICdpcy1kYW5nZXInKTtcbiAgICAgICAgdGhpcy5pc0FjdGl2ZSA9IGZhbHNlO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRlbXBsYXRlIG5lZWRlZCB0byBzaG93IG1vcmUgZWxlbWVudHNcbiAgICAgKi9cbiAgICBwcml2YXRlIHJlbmRlclRlbXBsYXRlKCkge1xuICAgICAgICB0aGlzLmVsLmlubmVySFRNTCA9IGBcbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJtZXNzYWdlLWhlYWRlclwiPjwvZGl2PlxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cIm1lc3NhZ2UtYm9keVwiPjwvZGl2PlxuICAgICAgICBgO1xuICAgIH1cbn1cbiIsImltcG9ydCBTY29yZSBmcm9tICcuL3Njb3JlJztcbmltcG9ydCBNZXNzYWdlU2NyZWVuIGZyb20gJy4vbWVzc2FnZXNjcmVlbic7XG5pbXBvcnQgRG9tRWxlbWVudCBmcm9tIFwiLi4vaGVscGVycy9kb21lbGVtZW50XCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEdVSSBleHRlbmRzIERvbUVsZW1lbnQge1xuICAgIHByaXZhdGUgc2NvcmU6IFNjb3JlO1xuICAgIHByaXZhdGUgbWVzc2FnZVNjcmVlbjogTWVzc2FnZVNjcmVlbjtcblxuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICBzdXBlcignZ3VpJywgMCwgMCk7XG5cbiAgICAgICAgdGhpcy5zY29yZSA9IG5ldyBTY29yZSgpO1xuICAgICAgICB0aGlzLm1lc3NhZ2VTY3JlZW4gPSBuZXcgTWVzc2FnZVNjcmVlbigpO1xuXG4gICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdsZXZlbDpzY29yZVVwZGF0ZScsIChlKSA9PiB0aGlzLnNjb3JlLnVwZGF0ZSgoZSBhcyBDdXN0b21FdmVudCkuZGV0YWlsLnNjb3JlKSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVHJpZ2dlcmVkIHdoZW4gYSBsZXZlbCBpcyBkb25lXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gdHlwZVxuICAgICAqL1xuICAgIHB1YmxpYyBsZXZlbERvbmUodHlwZTogc3RyaW5nKSB7XG4gICAgICAgIHRoaXMubWVzc2FnZVNjcmVlbi5zaG93KHR5cGUpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRyaWdnZXJlZCB3aGVuIGEgbmV3IGxldmVsIHN0YXJ0c1xuICAgICAqL1xuICAgIHB1YmxpYyBuZXdMZXZlbCgpIHtcbiAgICAgICAgdGhpcy5tZXNzYWdlU2NyZWVuLmhpZGUoKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUcmlnZ2VyZWQgd2hlbiB0aGUgZ2FtZSBpcyBkb25lXG4gICAgICpcbiAgICAgKiBAcGFyYW0gbWF4U2NvcmVcbiAgICAgKi9cbiAgICBwdWJsaWMgZ2FtZUVuZChtYXhTY29yZTogbnVtYmVyKSB7XG4gICAgICAgIHRoaXMubWVzc2FnZVNjcmVlbi5zaG93KCdnYW1lOmVuZCcsIHtcbiAgICAgICAgICAgICdfX1NDT1JFX18nOiB0aGlzLnNjb3JlLmdldCgpLnRvU3RyaW5nKCksXG4gICAgICAgICAgICAnX19NQVhfU0NPUkVfXyc6IG1heFNjb3JlLnRvU3RyaW5nKClcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVHJpZ2dlcmVkIHdoZW4gd2UgbmVlZCB0byByZXN0YXJ0LCBnbyB0byBmaXJzdCBzY3JlZW4gYW5kIHNldCBzY29yZSB0byAwXG4gICAgICovXG4gICAgcHVibGljIHJlc3RhcnQoKSB7XG4gICAgICAgIHRoaXMubWVzc2FnZVNjcmVlbi5oaWRlKCk7XG4gICAgICAgIHRoaXMubWVzc2FnZVNjcmVlbi5zaG93KCdnYW1lOnN0YXJ0Jyk7XG4gICAgICAgIHRoaXMuc2NvcmUudXBkYXRlKDAsIHRydWUpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEByZXR1cm5zIHtudW1iZXJ9XG4gICAgICovXG4gICAgcHVibGljIGdldFNjb3JlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5zY29yZS5nZXQoKTtcbiAgICB9XG59XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBVdGlscyB7XG4gICAgc3RhdGljIGdldFJhbmRvbUNvbG9yKCkge1xuICAgICAgICBsZXQgbyA9IE1hdGgucm91bmQsIHIgPSBNYXRoLnJhbmRvbSwgcyA9IDI1NTtcbiAgICAgICAgcmV0dXJuIGByZ2JhKCR7byhyKCkgKiBzKX0sJHtvKHIoKSAqIHMpfSwke28ocigpICogcyl9LDEpYDtcbiAgICB9XG5cbiAgICBzdGF0aWMgZ2V0UmFuZG9tSW50KG1pbjogbnVtYmVyLCBtYXg6IG51bWJlcikge1xuICAgICAgICByZXR1cm4gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogKG1heCAtIG1pbiArIDEpKSArIG1pbjtcbiAgICB9XG5cbiAgICBzdGF0aWMgY2hlY2tDb2xsaXNpb24oYTogQ2xpZW50UmVjdCwgYjogQ2xpZW50UmVjdCkge1xuICAgICAgICByZXR1cm4gKGEubGVmdCA8PSBiLnJpZ2h0ICYmXG4gICAgICAgICAgICBiLmxlZnQgPD0gYS5yaWdodCAmJlxuICAgICAgICAgICAgYS50b3AgPD0gYi5ib3R0b20gJiZcbiAgICAgICAgICAgIGIudG9wIDw9IGEuYm90dG9tKTtcbiAgICB9XG59XG4iLCJpbXBvcnQgRG9tRWxlbWVudCBmcm9tIFwiLi4vaGVscGVycy9kb21lbGVtZW50XCI7XG5pbXBvcnQgVXRpbHMgZnJvbSBcIi4uL2hlbHBlcnMvdXRpbHNcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQmxvY2sgZXh0ZW5kcyBEb21FbGVtZW50IHtcbiAgICBwcml2YXRlIHJlYWRvbmx5IHNwZWVkOiBudW1iZXI7XG4gICAgcHJpdmF0ZSByZWFkb25seSB3aWR0aDogbnVtYmVyO1xuICAgIHByaXZhdGUgcmVhZG9ubHkgaGVpZ2h0OiBudW1iZXI7XG4gICAgcHVibGljIGNvbG9yOiBzdHJpbmc7XG4gICAgcHJpdmF0ZSBkZXN0aW5hdGlvbiA9IHt4OiAwLCB5OiAwfTtcblxuICAgIGNvbnN0cnVjdG9yKGNvbG9yOiBzdHJpbmcsIHNwZWVkOiBudW1iZXIsIHdpZHRoOiBudW1iZXIsIGhlaWdodDogbnVtYmVyKSB7XG4gICAgICAgIHN1cGVyKCdibG9jaycsIDAsIDAsICdsZXZlbCcpO1xuXG4gICAgICAgIHRoaXMuc3BlZWQgPSBzcGVlZDtcbiAgICAgICAgdGhpcy53aWR0aCA9IHdpZHRoO1xuICAgICAgICB0aGlzLmhlaWdodCA9IGhlaWdodDtcbiAgICAgICAgdGhpcy5jb2xvciA9IGNvbG9yO1xuXG4gICAgICAgIHRoaXMuZWwuc3R5bGUuYmFja2dyb3VuZEltYWdlID0gYHJlcGVhdGluZy1saW5lYXItZ3JhZGllbnQoJHtVdGlscy5nZXRSYW5kb21JbnQoMCwzNjApfWRlZywgIzAwMDAwMCwgIzAwMDAwMCAke1V0aWxzLmdldFJhbmRvbUludCgyLDEwKX1weCwgJHt0aGlzLmNvbG9yfSAxMHB4LCAke3RoaXMuY29sb3J9ICR7VXRpbHMuZ2V0UmFuZG9tSW50KDIwLDQwKX1weClgO1xuICAgICAgICB0aGlzLmVsLnN0eWxlLndpZHRoID0gYCR7dGhpcy53aWR0aH1weGA7XG4gICAgICAgIHRoaXMuZWwuc3R5bGUuaGVpZ2h0ID0gYCR7dGhpcy5oZWlnaHR9cHhgO1xuXG4gICAgICAgIHRoaXMueCA9IFV0aWxzLmdldFJhbmRvbUludCgwLCAod2luZG93Lm91dGVyV2lkdGggLSB0aGlzLndpZHRoKSk7XG4gICAgICAgIHRoaXMueSA9IFV0aWxzLmdldFJhbmRvbUludCgwLCAoZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudEhlaWdodCAtIHRoaXMuaGVpZ2h0KSk7XG4gICAgICAgIHRoaXMuZWwuc3R5bGUudHJhbnNmb3JtID0gYHRyYW5zbGF0ZSgke3RoaXMueH1weCwgJHt0aGlzLnl9cHgpYDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBIYW5kbGVyIGZvciBjbGlja2luZyB0aGUgYmxvY2tzXG4gICAgICovXG4gICAgcHVibGljIGRlc3Ryb3koKSB7XG4gICAgICAgIHRoaXMuZWwucmVtb3ZlKCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogTWFpbiB1cGRhdGUgaGFuZGxlciBmb3IgdGhlIGdhbWUgZm9yIG1vdmluZyBvdXIgYmxvY2sgcmFuZG9tbHkgb3ZlciB0aGUgc2NyZWVuXG4gICAgICovXG4gICAgcHVibGljIHVwZGF0ZSgpIHtcbiAgICAgICAgaWYgKHRoaXMueCA+ICh0aGlzLmRlc3RpbmF0aW9uLnggLSB0aGlzLnNwZWVkKSAmJiB0aGlzLnggPCAodGhpcy5kZXN0aW5hdGlvbi54ICsgdGhpcy5zcGVlZCkpIHtcbiAgICAgICAgICAgIHRoaXMuZGVzdGluYXRpb24ueCA9IFV0aWxzLmdldFJhbmRvbUludCgwLCAod2luZG93Lm91dGVyV2lkdGggLSB0aGlzLndpZHRoKSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMueSA+ICh0aGlzLmRlc3RpbmF0aW9uLnkgLSB0aGlzLnNwZWVkKSAmJiB0aGlzLnkgPCAodGhpcy5kZXN0aW5hdGlvbi55ICsgdGhpcy5zcGVlZCkpIHtcbiAgICAgICAgICAgIHRoaXMuZGVzdGluYXRpb24ueSA9IFV0aWxzLmdldFJhbmRvbUludCgwLCAoZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudEhlaWdodCAtIHRoaXMuaGVpZ2h0KSk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGhpcy5kZXN0aW5hdGlvbi54ID49IHRoaXMueCkge1xuICAgICAgICAgICAgdGhpcy54ICs9IHRoaXMuc3BlZWQ7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnggLT0gdGhpcy5zcGVlZDtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0aGlzLmRlc3RpbmF0aW9uLnkgPj0gdGhpcy55KSB7XG4gICAgICAgICAgICB0aGlzLnkgKz0gdGhpcy5zcGVlZDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMueSAtPSB0aGlzLnNwZWVkO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5lbC5zdHlsZS50cmFuc2Zvcm0gPSBgdHJhbnNsYXRlKCR7dGhpcy54fXB4LCAke3RoaXMueX1weClgO1xuICAgIH1cbn1cbiIsImltcG9ydCBEb21FbGVtZW50IGZyb20gXCIuLi9oZWxwZXJzL2RvbWVsZW1lbnRcIjtcbmltcG9ydCBCbG9jayBmcm9tIFwiLi9ibG9ja1wiO1xuaW1wb3J0IFdpbmRvd0V2ZW50SGFuZGxlciBmcm9tIFwiLi4vaGVscGVycy93aW5kb3dldmVudGhhbmRsZXJcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUGxheWVyIGV4dGVuZHMgRG9tRWxlbWVudCB7XG4gICAgcHJpdmF0ZSBoZWlnaHQ6IG51bWJlciA9IDEwO1xuICAgIHByaXZhdGUgd2lkdGg6IG51bWJlciA9IDEwO1xuICAgIHByaXZhdGUgZ3Jvd3RoRmFjdG9yOiBudW1iZXIgPSAxLjU7XG4gICAgcHJpdmF0ZSBzcGVlZDogbnVtYmVyID0gMjtcbiAgICBwcml2YXRlIHNwZWVkSW5jcmVhc2VGYWN0b3I6IG51bWJlciA9IDAuMjtcbiAgICBwcml2YXRlIGtleXNBbGxvd2VkOiBudW1iZXJbXSA9IFszNywgMzgsIDM5LCA0MF07XG4gICAgcHJpdmF0ZSBrZXlzUHJlc3NlZDogbnVtYmVyW10gPSBbXTtcblxuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICBzdXBlcigncGxheWVyJywgMCwgMCwgJ2xldmVsJyk7XG4gICAgICAgIHRoaXMueCA9IHdpbmRvdy5vdXRlcldpZHRoIC8gMiAtIHRoaXMud2lkdGggLyAyO1xuICAgICAgICB0aGlzLnkgPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50SGVpZ2h0IC8gMiAtIHRoaXMuaGVpZ2h0IC8gMjtcblxuICAgICAgICB0aGlzLmVsLnN0eWxlLndpZHRoID0gYCR7dGhpcy53aWR0aH1weGA7XG4gICAgICAgIHRoaXMuZWwuc3R5bGUuaGVpZ2h0ID0gYCR7dGhpcy5oZWlnaHR9cHhgO1xuICAgICAgICB0aGlzLmVsLnN0eWxlLmJvcmRlclJhZGl1cyA9IGAke3RoaXMud2lkdGh9cHhgO1xuXG4gICAgICAgIFdpbmRvd0V2ZW50SGFuZGxlci5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duLnBsYXllcicsIChlOiBLZXlib2FyZEV2ZW50KSA9PiB0aGlzLmtleURvd25IYW5kbGVyKGUpKTtcbiAgICAgICAgV2luZG93RXZlbnRIYW5kbGVyLmFkZEV2ZW50TGlzdGVuZXIoJ2tleXVwLnBsYXllcicsIChlOiBLZXlib2FyZEV2ZW50KSA9PiB0aGlzLmtleVVwSGFuZGxlcihlKSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogS2V5IGRvd24gaGFuZGxlciBmb3IgbW92aW5nIHRoZSBwbGF5ZXJcbiAgICAgKlxuICAgICAqIEBwYXJhbSBlXG4gICAgICovXG4gICAgcHJpdmF0ZSBrZXlEb3duSGFuZGxlcihlOiBLZXlib2FyZEV2ZW50KSB7XG4gICAgICAgIGxldCBrZXkgPSBlLmtleUNvZGU7XG4gICAgICAgIGlmICh0aGlzLmtleXNBbGxvd2VkLmluZGV4T2Yoa2V5KSA+IC0xICYmIHRoaXMua2V5c1ByZXNzZWQuaW5kZXhPZihrZXkpID09PSAtMSkge1xuICAgICAgICAgICAgdGhpcy5rZXlzUHJlc3NlZC5wdXNoKGtleSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBLZXkgZG93biBoYW5kbGVyIGZvciBtb3ZpbmcgdGhlIHBsYXllclxuICAgICAqXG4gICAgICogQHBhcmFtIGVcbiAgICAgKi9cbiAgICBwcml2YXRlIGtleVVwSGFuZGxlcihlOiBLZXlib2FyZEV2ZW50KSB7XG4gICAgICAgIGxldCBrZXkgPSBlLmtleUNvZGU7XG4gICAgICAgIGxldCBrZXlQcmVzc2VkUG9zaXRpb24gPSB0aGlzLmtleXNQcmVzc2VkLmluZGV4T2Yoa2V5KTtcbiAgICAgICAgaWYgKHRoaXMua2V5c0FsbG93ZWQuaW5kZXhPZihrZXkpID4gLTEgJiYga2V5UHJlc3NlZFBvc2l0aW9uID4gLTEpIHtcbiAgICAgICAgICAgIHRoaXMua2V5c1ByZXNzZWQuc3BsaWNlKGtleVByZXNzZWRQb3NpdGlvbiwgMSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBVcGRhdGUgdGhlIGFjdHVhbCBwb3NpdGlvbiBiYXNlZCBvbiBlYXJsaWVyIGV2ZW50c1xuICAgICAqL1xuICAgIHB1YmxpYyB1cGRhdGUoKSB7XG4gICAgICAgIHRoaXMua2V5c1ByZXNzZWQuZm9yRWFjaCgoa2V5KSA9PiB7XG4gICAgICAgICAgICBzd2l0Y2ggKGtleSkge1xuICAgICAgICAgICAgICAgIGNhc2UgMzc6XG4gICAgICAgICAgICAgICAgICAgIHRoaXMueCAtPSB0aGlzLnNwZWVkO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgIGNhc2UgMzg6XG4gICAgICAgICAgICAgICAgICAgIHRoaXMueSAtPSB0aGlzLnNwZWVkO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgIGNhc2UgMzk6XG4gICAgICAgICAgICAgICAgICAgIHRoaXMueCArPSB0aGlzLnNwZWVkO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgIGNhc2UgNDA6XG4gICAgICAgICAgICAgICAgICAgIHRoaXMueSArPSB0aGlzLnNwZWVkO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy9DaGVja3MgdG8gc3RheSBpbiBib3VuZHNcbiAgICAgICAgaWYgKHRoaXMueCA8IDApIHtcbiAgICAgICAgICAgIHRoaXMueCA9IDA7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMueSA8IDApIHtcbiAgICAgICAgICAgIHRoaXMueSA9IDA7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMueCA+ICh3aW5kb3cub3V0ZXJXaWR0aCAtIHRoaXMud2lkdGgpKSB7XG4gICAgICAgICAgICB0aGlzLnggPSAod2luZG93Lm91dGVyV2lkdGggLSB0aGlzLndpZHRoKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy55ID4gKGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRIZWlnaHQgLSB0aGlzLmhlaWdodCkpIHtcbiAgICAgICAgICAgIHRoaXMueSA9IChkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50SGVpZ2h0IC0gdGhpcy5oZWlnaHQpO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5lbC5zdHlsZS50cmFuc2Zvcm0gPSBgdHJhbnNsYXRlKCR7dGhpcy54fXB4LCAke3RoaXMueX1weClgO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFVwZGF0ZSBwbGF5ZXIgd2hlbiBhIGJsb2NrIGdvdCBjYXVnaHRcbiAgICAgKlxuICAgICAqIEBwYXJhbSBibG9ja1xuICAgICAqL1xuICAgIHB1YmxpYyBibG9ja0NhdWdodChibG9jazogQmxvY2spIHtcbiAgICAgICAgdGhpcy5zcGVlZCArPSB0aGlzLnNwZWVkSW5jcmVhc2VGYWN0b3I7XG4gICAgICAgIHRoaXMud2lkdGggKz0gdGhpcy5ncm93dGhGYWN0b3I7XG4gICAgICAgIHRoaXMuaGVpZ2h0ICs9IHRoaXMuZ3Jvd3RoRmFjdG9yO1xuXG4gICAgICAgIHRoaXMuZWwuc3R5bGUuaGVpZ2h0ID0gYCR7dGhpcy5oZWlnaHR9cHhgO1xuICAgICAgICB0aGlzLmVsLnN0eWxlLndpZHRoID0gYCR7dGhpcy53aWR0aH1weGA7XG4gICAgICAgIHRoaXMuZWwuc3R5bGUuYm9yZGVyUmFkaXVzID0gYCR7dGhpcy53aWR0aH1weGA7XG4gICAgICAgIHRoaXMuZWwuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gYmxvY2suY29sb3I7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2xlYW4gdXAhXG4gICAgICovXG4gICAgcHVibGljIGRlc3Ryb3koKSB7XG4gICAgICAgIFdpbmRvd0V2ZW50SGFuZGxlci5yZW1vdmVFdmVudExpc3RlbmVyKCdrZXlkb3duLnBsYXllcicpO1xuICAgICAgICBXaW5kb3dFdmVudEhhbmRsZXIucmVtb3ZlRXZlbnRMaXN0ZW5lcigna2V5dXAucGxheWVyJyk7XG4gICAgfVxufVxuIiwiaW1wb3J0IERvbUVsZW1lbnQgZnJvbSBcIi4uL2hlbHBlcnMvZG9tZWxlbWVudFwiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBUaW1lciBleHRlbmRzIERvbUVsZW1lbnQge1xuICAgIHNlY29uZHM6IG51bWJlciA9IDEwO1xuICAgIGludGVydmFsSWQ6IG51bWJlcjtcblxuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICBzdXBlcigndGltZXInLCAtMSwgLTEsICdsZXZlbCcpO1xuXG4gICAgICAgIHRoaXMucmVuZGVyVGVtcGxhdGUoKTtcbiAgICAgICAgdGhpcy5lbC5jbGFzc0xpc3QuYWRkKCdtZXNzYWdlJywgJ2lzLXByaW1hcnknKTtcbiAgICAgICAgdGhpcy5lbC5xdWVyeVNlbGVjdG9yKCcubWVzc2FnZS1ib2R5JykuaW5uZXJIVE1MID0gYHRpbWU6ICR7dGhpcy5zZWNvbmRzfWA7XG5cbiAgICAgICAgdGhpcy5pbnRlcnZhbElkID0gc2V0SW50ZXJ2YWwoKCkgPT4gdGhpcy51cGRhdGUoKSwgMTAwMCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ291bnRkb3duIG9mIHNlY29uZHNcbiAgICAgKi9cbiAgICBwcml2YXRlIHVwZGF0ZSgpIHtcbiAgICAgICAgdGhpcy5zZWNvbmRzLS07XG4gICAgICAgIHRoaXMuZWwucXVlcnlTZWxlY3RvcignLm1lc3NhZ2UtYm9keScpLmlubmVySFRNTCA9IGB0aW1lOiAke3RoaXMuc2Vjb25kc31gO1xuXG4gICAgICAgIGlmICh0aGlzLnNlY29uZHMgPT09IDApIHtcbiAgICAgICAgICAgIHdpbmRvdy5kaXNwYXRjaEV2ZW50KG5ldyBFdmVudCgndGltZXI6ZG9uZScpKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHB1YmxpYyBkZXN0cm95KCkge1xuICAgICAgICBjbGVhckludGVydmFsKHRoaXMuaW50ZXJ2YWxJZCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVGVtcGxhdGUgbmVlZGVkIHRvIHNob3cgbW9yZSBlbGVtZW50c1xuICAgICAqL1xuICAgIHByaXZhdGUgcmVuZGVyVGVtcGxhdGUoKSB7XG4gICAgICAgIHRoaXMuZWwuaW5uZXJIVE1MID0gYFxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cIm1lc3NhZ2UtYm9keVwiPjwvZGl2PlxuICAgICAgICBgO1xuICAgIH1cbn1cbiIsImltcG9ydCBEb21FbGVtZW50IGZyb20gXCIuLi9oZWxwZXJzL2RvbWVsZW1lbnRcIjtcbmltcG9ydCBCbG9jayBmcm9tIFwiLi9ibG9ja1wiO1xuaW1wb3J0IFBsYXllciBmcm9tIFwiLi9wbGF5ZXJcIjtcbmltcG9ydCBUaW1lciBmcm9tIFwiLi90aW1lclwiO1xuaW1wb3J0IFV0aWxzIGZyb20gXCIuLi9oZWxwZXJzL3V0aWxzXCI7XG5pbXBvcnQgV2luZG93RXZlbnRIYW5kbGVyIGZyb20gXCIuLi9oZWxwZXJzL3dpbmRvd2V2ZW50aGFuZGxlclwiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBMZXZlbCBleHRlbmRzIERvbUVsZW1lbnQge1xuICAgIHByaXZhdGUgcmVhZG9ubHkgdG90YWxCbG9ja3M6IG51bWJlcjtcbiAgICBwcml2YXRlIHJlYWRvbmx5IHNjb3JlUGVyQmxvY2s6IG51bWJlcjtcbiAgICBwcml2YXRlIGJsb2NrczogQmxvY2tbXSA9IFtdO1xuICAgIHByaXZhdGUgcGxheWVyOiBQbGF5ZXI7XG4gICAgcHJpdmF0ZSB0aW1lcjogVGltZXI7XG4gICAgcHVibGljIGZhaWxlZCA9IGZhbHNlO1xuXG4gICAgY29uc3RydWN0b3IodG90YWxCbG9ja3M6IG51bWJlciwgc2NvcmVQZXJCbG9jazogbnVtYmVyKSB7XG4gICAgICAgIHN1cGVyKCdsZXZlbCcsIDAsIDApO1xuXG4gICAgICAgIHRoaXMudG90YWxCbG9ja3MgPSB0b3RhbEJsb2NrcztcbiAgICAgICAgdGhpcy5zY29yZVBlckJsb2NrID0gc2NvcmVQZXJCbG9jaztcbiAgICAgICAgdGhpcy5wbGF5ZXIgPSBuZXcgUGxheWVyKCk7XG4gICAgICAgIHRoaXMudGltZXIgPSBuZXcgVGltZXIoKTtcblxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMudG90YWxCbG9ja3M7IGkrKykge1xuICAgICAgICAgICAgdGhpcy5ibG9ja3MucHVzaChuZXcgQmxvY2soVXRpbHMuZ2V0UmFuZG9tQ29sb3IoKSwgVXRpbHMuZ2V0UmFuZG9tSW50KDEsIDUpLCBVdGlscy5nZXRSYW5kb21JbnQoMTAsIDE1MCksIFV0aWxzLmdldFJhbmRvbUludCgxMCwgMTUwKSkpO1xuICAgICAgICB9XG5cbiAgICAgICAgV2luZG93RXZlbnRIYW5kbGVyLmFkZEV2ZW50TGlzdGVuZXIoJ3RpbWVyOmRvbmUnLCAoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmZhaWxlZCA9IHRydWU7XG4gICAgICAgICAgICB0aGlzLmRlc3Ryb3koJ2xldmVsOmZhaWxlZCcpO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDaGVja3MgZm9yIGNvbGxpc2lvbiBhbmQgcG90ZW50aWFsIHN1Y2Nlc3Mgb2YgdGhpcyBsZXZlbFxuICAgICAqL1xuICAgIHB1YmxpYyB1cGRhdGUoKSB7XG4gICAgICAgIHRoaXMucGxheWVyLnVwZGF0ZSgpO1xuICAgICAgICB0aGlzLmJsb2Nrcy5mb3JFYWNoKChibG9jaywgaW5kZXgpID0+IHtcbiAgICAgICAgICAgIGJsb2NrLnVwZGF0ZSgpO1xuXG4gICAgICAgICAgICBpZiAoVXRpbHMuY2hlY2tDb2xsaXNpb24odGhpcy5wbGF5ZXIuZ2V0Q2xpZW50UmVhY3QoKSwgYmxvY2suZ2V0Q2xpZW50UmVhY3QoKSkgJiYgdGhpcy5mYWlsZWQgPT09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wbGF5ZXIuYmxvY2tDYXVnaHQoYmxvY2spO1xuICAgICAgICAgICAgICAgIGJsb2NrLmRlc3Ryb3koKTtcbiAgICAgICAgICAgICAgICB0aGlzLmJsb2Nrcy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICAgICAgICAgIHdpbmRvdy5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgnbGV2ZWw6c2NvcmVVcGRhdGUnLCB7ZGV0YWlsOiB7c2NvcmU6IHRoaXMuc2NvcmVQZXJCbG9ja319KSk7XG5cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5ibG9ja3MubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZGVzdHJveSgnbGV2ZWw6c3VjY2VzcycpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRGVzdHJveSBvYmplY3QgJiB0aW1lciBhbmQgdHJpZ2dlciBldmVudCB0byBub3RpZnkgdGhlIHdvcmxkIGFib3V0IHRoZSBzdGF0dXMgb2YgdGhpcyBsZXZlbFxuICAgICAqXG4gICAgICogQHBhcmFtIGV2ZW50VHlwZVxuICAgICAqL1xuICAgIHByaXZhdGUgZGVzdHJveShldmVudFR5cGU6IHN0cmluZykge1xuICAgICAgICB0aGlzLnRpbWVyLmRlc3Ryb3koKTtcbiAgICAgICAgdGhpcy5wbGF5ZXIuZGVzdHJveSgpO1xuICAgICAgICB0aGlzLmJsb2Nrcy5mb3JFYWNoKChibG9jaywgaW5kZXgpID0+IHtcbiAgICAgICAgICAgIGJsb2NrLmRlc3Ryb3koKTtcbiAgICAgICAgICAgIHRoaXMuYmxvY2tzLnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgIH0pO1xuICAgICAgICBXaW5kb3dFdmVudEhhbmRsZXIucmVtb3ZlRXZlbnRMaXN0ZW5lcigndGltZXI6ZG9uZScpO1xuICAgICAgICB3aW5kb3cuZGlzcGF0Y2hFdmVudChuZXcgRXZlbnQoZXZlbnRUeXBlKSk7XG4gICAgICAgIHRoaXMuZWwucmVtb3ZlKCk7XG4gICAgfVxufVxuIiwiaW1wb3J0IGNvbmZpZyBmcm9tICcuL2NvbmZpZy5qc29uJztcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgRGF0YVNlcnZpY2Uge1xuICAgIHByaXZhdGUgZW5kUG9pbnRMaXN0OiBzdHJpbmcgPSBgL2RhdGFiYXNlcy8ke2NvbmZpZy5kYXRhU2VydmljZS5kYXRhYmFzZU5hbWV9L2NvbGxlY3Rpb25zLyR7Y29uZmlnLmRhdGFTZXJ2aWNlLmNvbGxlY3Rpb25OYW1lfT9hcGlLZXk9JHtjb25maWcuZGF0YVNlcnZpY2UuYXBpS2V5fWA7XG4gICAgcHJpdmF0ZSBlbmRQb2ludFNhdmU6IHN0cmluZyA9IGAvZGF0YWJhc2VzLyR7Y29uZmlnLmRhdGFTZXJ2aWNlLmRhdGFiYXNlTmFtZX0vY29sbGVjdGlvbnMvJHtjb25maWcuZGF0YVNlcnZpY2UuY29sbGVjdGlvbk5hbWV9P2FwaUtleT0ke2NvbmZpZy5kYXRhU2VydmljZS5hcGlLZXl9YDtcblxuICAgIC8qKlxuICAgICAqIFN0b3JlIHRoZSBsYXRlc3Qgc2NvcmUgaW4gdGhlIERCXG4gICAgICpcbiAgICAgKiBAcGFyYW0gc2NvcmVcbiAgICAgKiBAcmV0dXJucyB7UHJvbWlzZTx7fT59XG4gICAgICovXG4gICAgcHVibGljIHNhdmVTY29yZShzY29yZTogbnVtYmVyKSB7XG4gICAgICAgIGlmIChjb25maWcuZnVuY3Rpb25hbGl0aWVzLmRhdGFTZXJ2aWNlID09PSBmYWxzZSkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZGlzYWJsZWQoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGxldCB1cmwgPSBgJHtjb25maWcuZGF0YVNlcnZpY2UuYmFzZVVybH0ke3RoaXMuZW5kUG9pbnRTYXZlfWA7XG4gICAgICAgIHJldHVybiBmZXRjaCh1cmwsIHtcbiAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICAgICAgICBzY29yZTogc2NvcmVcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgICAgICdjb250ZW50LXR5cGUnOiAnYXBwbGljYXRpb24vanNvbidcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICAgIG1vZGU6ICdjb3JzJ1xuICAgICAgICB9KS50aGVuKHJlc3BvbnNlID0+IHJlc3BvbnNlLmpzb24oKSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IGFsbCB0aGUgY3VycmVudCBzY29yZXMgZnJvbSB0aGUgREJcbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHtQcm9taXNlPFtdPn1cbiAgICAgKi9cbiAgICBwdWJsaWMgZ2V0U2NvcmVzKCkge1xuICAgICAgICBpZiAoY29uZmlnLmZ1bmN0aW9uYWxpdGllcy5kYXRhU2VydmljZSA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmRpc2FibGVkKCk7XG4gICAgICAgIH1cblxuICAgICAgICBsZXQgdXJsID0gYCR7Y29uZmlnLmRhdGFTZXJ2aWNlLmJhc2VVcmx9JHt0aGlzLmVuZFBvaW50TGlzdH1gO1xuICAgICAgICByZXR1cm4gZmV0Y2godXJsLCB7XG4gICAgICAgICAgICBtb2RlOiAnY29ycydcbiAgICAgICAgfSkudGhlbihyZXNwb25zZSA9PiByZXNwb25zZS5qc29uKCkpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdlbmVyYWwgbWVzc2FnZSB3aGVuIHRoaXMgc2VydmljZSBpcyBpbmFjdGl2ZVxuICAgICAqXG4gICAgICogQHJldHVybnMge1Byb21pc2U8e30+fVxuICAgICAqL1xuICAgIHByaXZhdGUgZGlzYWJsZWQoKSB7XG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4ge1xuICAgICAgICAgICAgcmVzb2x2ZSh7XCJlcnJvclwiOiBcIkRhdGFzZXJ2aWNlIGlzIGRpc2FibGVkXCJ9KTtcbiAgICAgICAgfSk7XG4gICAgfVxufVxuIiwiaW1wb3J0IEdhbWUgZnJvbSAnLi9nYW1lJztcblxud2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJsb2FkXCIsICgpID0+IG5ldyBHYW1lKCkpO1xuIiwiaW1wb3J0IEdVSSBmcm9tICcuL2d1aS9ndWknO1xuaW1wb3J0IExldmVsIGZyb20gXCIuL2xldmVsL2xldmVsXCI7XG5pbXBvcnQgRGF0YVNlcnZpY2UgZnJvbSBcIi4vZGF0YXNlcnZpY2VcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgR2FtZSB7XG4gICAgcHJpdmF0ZSBsZXZlbCE6IExldmVsO1xuICAgIHByaXZhdGUgbGV2ZWxzUGVyR2FtZTogbnVtYmVyID0gMTA7XG4gICAgcHJpdmF0ZSBjdXJyZW50TGV2ZWxzUGxheWVkOiBudW1iZXIgPSAwO1xuICAgIHByaXZhdGUgZWxlbWVudHNQZXJMZXZlbDogbnVtYmVyID0gNTtcbiAgICBwcml2YXRlIGVsZW1lbnRzSW5jcmVhc2VQZXJMZXZlbDogbnVtYmVyID0gNTtcbiAgICBwcml2YXRlIHNjb3JlUGVyRWxlbWVudDogbnVtYmVyID0gMTA7XG4gICAgcHJpdmF0ZSByZWFkb25seSBtYXhTY29yZTogbnVtYmVyO1xuICAgIHByaXZhdGUgZ3VpOiBHVUk7XG4gICAgcHJpdmF0ZSBkYXRhU2VydmljZTogRGF0YVNlcnZpY2U7XG5cbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgdGhpcy5ndWkgPSBuZXcgR1VJKCk7XG4gICAgICAgIHRoaXMubWF4U2NvcmUgPSB0aGlzLmNhbGN1bGF0ZU1heFNjb3JlKCk7XG4gICAgICAgIHRoaXMuZ2FtZUxvb3AoKTtcbiAgICAgICAgdGhpcy5kYXRhU2VydmljZSA9IG5ldyBEYXRhU2VydmljZSgpO1xuICAgICAgICB0aGlzLmRhdGFTZXJ2aWNlLmdldFNjb3JlcygpLnRoZW4oKGRhdGEpID0+IHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdDdXJyZW50IHNjb3JlcycsIGRhdGEpO1xuICAgICAgICB9KTtcblxuICAgICAgICBbJ2xldmVsOnN1Y2Nlc3MnLCAnbGV2ZWw6ZmFpbGVkJ10ubWFwKChldmVudFR5cGUpID0+IHtcbiAgICAgICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKGV2ZW50VHlwZSwgKGUpID0+IHRoaXMudXBkYXRlKGUudHlwZSkpO1xuICAgICAgICB9KTtcbiAgICAgICAgWydnYW1lOnN0YXJ0OmNsaWNrJywgJ2xldmVsOnN1Y2Nlc3M6Y2xpY2snLCAnbGV2ZWw6ZmFpbGVkOmNsaWNrJ10ubWFwKChldmVudFR5cGUpID0+IHtcbiAgICAgICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKGV2ZW50VHlwZSwgKCkgPT4gdGhpcy5zdGFydE5ld0xldmVsKCkpO1xuICAgICAgICB9KTtcbiAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2dhbWU6ZW5kOmNsaWNrJywgKCkgPT4gdGhpcy5yZXN0YXJ0KCkpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENhbGN1bGF0ZSB0aGUgc2NvcmUgd2l0aCBhdmFpbGFibGUgcGFyYW1ldGVyc1xuICAgICAqXG4gICAgICogQHRvZG8gRG8gSSByZWFsbHkgbmVlZCB0byB0byB0aGlzIHNvIGluZWZmaWNpZW50Li4/XG4gICAgICogQHJldHVybnMge251bWJlcn1cbiAgICAgKi9cbiAgICBwcml2YXRlIGNhbGN1bGF0ZU1heFNjb3JlKCkge1xuICAgICAgICBsZXQgbWF4U2NvcmUgPSAwO1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubGV2ZWxzUGVyR2FtZTsgaSsrKSB7XG4gICAgICAgICAgICBsZXQgZWxlbWVudHMgPSB0aGlzLmVsZW1lbnRzUGVyTGV2ZWwgKyAoaSA9PT0gMCA/IDAgOiAodGhpcy5lbGVtZW50c0luY3JlYXNlUGVyTGV2ZWwgKiBpKSk7XG4gICAgICAgICAgICBtYXhTY29yZSArPSAoZWxlbWVudHMgKiB0aGlzLnNjb3JlUGVyRWxlbWVudCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG1heFNjb3JlO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRoZSBvbmx5IHBsYWNlIGZvciBhIHJlcXVlc3RBbmltYXRpb25GcmFtZVxuICAgICAqL1xuICAgIHByaXZhdGUgZ2FtZUxvb3AoKSB7XG4gICAgICAgIGlmICh0eXBlb2YgdGhpcy5sZXZlbCAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgIHRoaXMubGV2ZWwudXBkYXRlKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKCgpID0+IHRoaXMuZ2FtZUxvb3AoKSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVXBkYXRlIHRoZSBnYW1lIGJ5IGVpdGhlciB0aGUgZW5kIG9yIGFueXRoaW5nIGluIGJldHdlZW4gbGV2ZWxzXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gdHlwZVxuICAgICAqL1xuICAgIHByaXZhdGUgdXBkYXRlKHR5cGU6IHN0cmluZykge1xuICAgICAgICB0aGlzLmN1cnJlbnRMZXZlbHNQbGF5ZWQrKztcbiAgICAgICAgaWYgKHRoaXMuY3VycmVudExldmVsc1BsYXllZCA9PT0gdGhpcy5sZXZlbHNQZXJHYW1lKSB7XG4gICAgICAgICAgICB0aGlzLmd1aS5nYW1lRW5kKHRoaXMubWF4U2NvcmUpO1xuICAgICAgICAgICAgdGhpcy5zYXZlU2NvcmUoKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuZ3VpLmxldmVsRG9uZSh0eXBlKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUaW1lIHRvIHN0YXJ0IGEgbmV3IGxldmVsIHdpdGggbWFkbmVzc1xuICAgICAqL1xuICAgIHByaXZhdGUgc3RhcnROZXdMZXZlbCgpIHtcbiAgICAgICAgaWYgKHRoaXMubGV2ZWwgJiYgdGhpcy5sZXZlbC5mYWlsZWQgPT09IGZhbHNlKSB7XG4gICAgICAgICAgICB0aGlzLmVsZW1lbnRzUGVyTGV2ZWwgKz0gdGhpcy5lbGVtZW50c0luY3JlYXNlUGVyTGV2ZWw7XG4gICAgICAgIH1cblxuICAgICAgICBkZWxldGUgdGhpcy5sZXZlbDtcbiAgICAgICAgdGhpcy5ndWkubmV3TGV2ZWwoKTtcblxuICAgICAgICB0aGlzLmxldmVsID0gbmV3IExldmVsKHRoaXMuZWxlbWVudHNQZXJMZXZlbCwgdGhpcy5zY29yZVBlckVsZW1lbnQpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFN0YXJ0IGV2ZXJ5dGhpbmcgZnJvbSB0aGUgYmVnaW5uaW5nXG4gICAgICovXG4gICAgcHJpdmF0ZSByZXN0YXJ0KCkge1xuICAgICAgICB0aGlzLmd1aS5yZXN0YXJ0KCk7XG4gICAgICAgIHRoaXMuY3VycmVudExldmVsc1BsYXllZCA9IDA7XG4gICAgICAgIHRoaXMuZWxlbWVudHNQZXJMZXZlbCA9IDU7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2FsbCB0aGUgZGF0YSBzZXJ2aWNlIGFuZCBsZXQgaXQgZG8gaXRzIG1hZ2ljXG4gICAgICovXG4gICAgcHJpdmF0ZSBzYXZlU2NvcmUoKSB7XG4gICAgICAgIGxldCBzY29yZSA9IHRoaXMuZ3VpLmdldFNjb3JlKCk7XG4gICAgICAgIHRoaXMuZGF0YVNlcnZpY2Uuc2F2ZVNjb3JlKHNjb3JlKS50aGVuKChkYXRhKSA9PiB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnUmVzcG9uc2UgYWZ0ZXIgc2F2aW5nIHNjb3JlJywgZGF0YSk7XG4gICAgICAgIH0pO1xuICAgIH1cbn1cbiJdLCJzb3VyY2VSb290IjoiIn0=