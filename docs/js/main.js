!function(e){var t={};function s(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,s),r.l=!0,r.exports}s.m=e,s.c=t,s.d=function(e,t,i){s.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:i})},s.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s(s.s=1)}([function(e){e.exports={game:{levelsPerGame:10,startElementsPerLevel:5,elementsIncreasePerLevel:5,scorePerElement:10,secondsPerLevel:10,blockSpeed:{min:1,max:5},blockPixels:{min:10,max:150},player:{growthFactor:1.5,speed:3,speedIncreaseFactor:.2}},functionalities:{dataService:!0},dataService:{baseUrl:"https://api.mlab.com/api/1",apiKey:"X17utv1FH2dFTeUo4yhNGL54sA7CY2jS",databaseName:"typescript_scores",collectionName:"scores"}}},function(e,t,s){"use strict";s.r(t);var i=s(0);class r{constructor(e,t,s,i=""){this.x=t,this.y=s,this.el=document.createElement("div");let r=document.getElementById("main");if(null===r)throw new Error("<main> element doesn't exist!");if(this.x>-1&&this.y>-1&&(this.el.style.transform=`translate(${this.x}px, ${this.y}px)`),this.el.classList.add(`game-${e}`),""===i)r.appendChild(this.el);else{let e=document.querySelector(`.game-${i}`);if(null===e)throw new Error(`<.game-${i}> element doesn't exist!`);e.appendChild(this.el)}}getClientReact(){return this.el.getBoundingClientRect()}}class a extends r{constructor(){super("score",-1,-1,"gui"),this.score=0,this.renderTemplate(),this.el.querySelector(".score-count").innerHTML=this.score.toString(),this.el.classList.add("message","is-warning")}get(){return this.score}update(e,t=!1){this.score=t?e:this.score+e,this.el.querySelector(".score-count").innerHTML=this.score.toString()}renderTemplate(){this.el.innerHTML='\n            <div class="message-body">\n                <span>score: </span>\n                <span class="score-count"></span>\n            </div>\n        '}}class n{static addEventListener(e,t){n.functionMap[e]=t,window.addEventListener(e.split(".")[0],n.functionMap[e])}static removeEventListener(e){window.removeEventListener(e.split(".")[0],n.functionMap[e]),delete n.functionMap[e]}}n.functionMap={};class o extends r{constructor(){super("messagescreen",-1,-1,"gui"),this.isActive=!1,this.messages={"game:start":{header:"Welcome to Block-o-Block!",body:"It's time to catch them blocks!<br/><br/>Use your arrow keys to move your player around and press space to start.<br/><br/>Press -<strong>H</strong>- to view the highscore list",className:"is-info"},"game:end":{header:"Your game is over!",body:"You made it, your final score is __SCORE__ out of max __MAX_SCORE__ points.<br/><br/>Thanks for playing, press space to restart the madness.<br/><br/>Press -<strong>H</strong>- to view the highscore list",className:"is-success"},"level:success":{header:"YEAH! Level completed!",body:"Performing like a boss! Press space to proceed to the next level and catch even more blocks",className:"is-success"},"level:failed":{header:"AAH! Level failed!",body:"Try again and show us what you're made off! Press space to restart this level",className:"is-danger"}},this.el.classList.add("message"),this.renderTemplate(),this.show("game:start"),n.addEventListener("keyup.messagescreen",e=>this.keyBoardHandler(e))}keyBoardHandler(e){" "===e.key&&!0===this.isActive&&window.dispatchEvent(new Event(`${this.currentEvent}:click`))}show(e,t={}){let s=this.messages[e].header,i=this.messages[e].body;for(let e in t)i=i.replace(e,t[e]);this.el.querySelector(".message-header").innerHTML=s,this.el.querySelector(".message-body").innerHTML=i,this.el.classList.add("show",this.messages[e].className),this.currentEvent=e,this.isActive=!0}hide(){this.el.classList.remove("show","is-info","is-success","is-danger"),this.isActive=!1}renderTemplate(){this.el.innerHTML='\n            <div class="message-header"></div>\n            <div class="message-body"></div>\n        '}}class h{constructor(){this.endPointList=`/databases/${i.dataService.databaseName}/collections/${i.dataService.collectionName}?apiKey=${i.dataService.apiKey}`,this.endPointSave=`/databases/${i.dataService.databaseName}/collections/${i.dataService.collectionName}?apiKey=${i.dataService.apiKey}`}saveScore(e){if(!1===i.functionalities.dataService)return this.disabled();let t=`${i.dataService.baseUrl}${this.endPointSave}`;return fetch(t,{body:JSON.stringify({score:e}),headers:{"content-type":"application/json"},method:"POST",mode:"cors"}).then(e=>e.json())}getScores(){if(!1===i.functionalities.dataService)return this.disabled();let e=`${i.dataService.baseUrl}${this.endPointList}&s={"score": -1}&l=10`;return fetch(e,{mode:"cors"}).then(e=>e.json())}disabled(){return new Promise(e=>{e({error:"Dataservice is disabled"})})}}class l extends r{constructor(){super("highscorelist",-1,-1,"gui"),this.el.classList.add("message","is-warning"),this.renderTemplate(),this.dataService=new h}show(){this.dataService.getScores().then(e=>{this.el.querySelector(".tbody").innerHTML=this.getTbodyTemplate(e),this.el.classList.add("show")})}hide(){this.el.classList.remove("show")}getTbodyTemplate(e){return`\n            ${e.map((e,t)=>`<tr>\n                <td>${t+1}</td>\n                <td>${e._id.$oid}</td>\n                <td>${e.score.toString()}</td>\n            </tr>`).join("")}\n        `}renderTemplate(){this.el.innerHTML='\n            <div class="message-header">\n                <p>Top 10 High Scores (press -<strong>esc</strong>- to return)</p>\n            </div>\n            <div class="message-body">\n                <table class="table">\n                    <thead>\n                    <tr>\n                        <th>#</th>\n                        <th>MongoID</th>\n                        <th>Score</th>\n                    </tr>\n                    </thead>\n                    <tbody class="tbody"></tbody>\n                </table>\n            </div>\n        '}}class d extends r{constructor(){super("gui",-1,-1),this.highScoreListVisible=!1,this.score=new a,this.messageScreen=new o,window.addEventListener("level:scoreUpdate",e=>this.score.update(e.detail.score)),!0===i.functionalities.dataService&&(this.highScoreList=new l,n.addEventListener("keyup.highscorelist",e=>this.keyBoardHandler(e)))}keyBoardHandler(e){let t=e.key.toLowerCase();"h"===t&&!1===this.highScoreListVisible?(this.highScoreListVisible=!0,this.highScoreList.show()):"escape"===t&&!0===this.highScoreListVisible&&(this.highScoreListVisible=!1,this.highScoreList.hide())}levelDone(e){this.messageScreen.show(e)}newLevel(){this.messageScreen.hide()}gameEnd(e){this.messageScreen.show("game:end",{__SCORE__:this.score.get().toString(),__MAX_SCORE__:e.toString()})}restart(){this.messageScreen.hide(),this.messageScreen.show("game:start"),this.score.update(0,!0)}getScore(){return this.score.get()}}class c{static getRandomColor(){let e=Math.round,t=Math.random;return`rgba(${e(255*t())},${e(255*t())},${e(255*t())},1)`}static getRandomInt(e,t){return Math.floor(Math.random()*(t-e+1))+e}static checkCollision(e,t){return e.left<=t.right&&t.left<=e.right&&e.top<=t.bottom&&t.top<=e.bottom}}class m extends r{constructor(e,t,s,i){super("block",0,0,"level"),this.destination={x:0,y:0},this.speed=t,this.width=s,this.height=i,this.color=e,this.el.style.backgroundImage=`repeating-linear-gradient(${c.getRandomInt(0,360)}deg, #000000, #000000 ${c.getRandomInt(2,10)}px, ${this.color} 10px, ${this.color} ${c.getRandomInt(20,40)}px)`,this.el.style.width=`${this.width}px`,this.el.style.height=`${this.height}px`,this.x=c.getRandomInt(0,window.outerWidth-this.width),this.y=c.getRandomInt(0,document.documentElement.clientHeight-this.height),this.el.style.transform=`translate(${this.x}px, ${this.y}px)`}destroy(){this.el.remove()}update(){this.x>this.destination.x-this.speed&&this.x<this.destination.x+this.speed&&(this.destination.x=c.getRandomInt(0,window.outerWidth-this.width)),this.y>this.destination.y-this.speed&&this.y<this.destination.y+this.speed&&(this.destination.y=c.getRandomInt(0,document.documentElement.clientHeight-this.height)),this.destination.x>=this.x?this.x+=this.speed:this.x-=this.speed,this.destination.y>=this.y?this.y+=this.speed:this.y-=this.speed,this.el.style.transform=`translate(${this.x}px, ${this.y}px)`}}class p extends r{constructor(){super("player",0,0,"level"),this.height=10,this.width=10,this.growthFactor=i.game.player.growthFactor,this.speed=i.game.player.speed,this.speedIncreaseFactor=i.game.player.speedIncreaseFactor,this.keysAllowed=["arrowleft","arrowup","arrowright","arrowdown"],this.keysPressed=[],this.x=window.outerWidth/2-this.width/2,this.y=document.documentElement.clientHeight/2-this.height/2,this.el.style.width=`${this.width}px`,this.el.style.height=`${this.height}px`,this.el.style.borderRadius=`${this.width}px`,n.addEventListener("keydown.player",e=>this.keyDownHandler(e)),n.addEventListener("keyup.player",e=>this.keyUpHandler(e))}keyDownHandler(e){let t=e.key.toLowerCase();this.keysAllowed.indexOf(t)>-1&&-1===this.keysPressed.indexOf(t)&&this.keysPressed.push(t)}keyUpHandler(e){let t=e.key.toLowerCase(),s=this.keysPressed.indexOf(t);this.keysAllowed.indexOf(t)>-1&&s>-1&&this.keysPressed.splice(s,1)}update(){this.keysPressed.forEach(e=>{switch(e){case"arrowleft":this.x-=this.speed;break;case"arrowup":this.y-=this.speed;break;case"arrowright":this.x+=this.speed;break;case"arrowdown":this.y+=this.speed;break;default:return}}),this.x<0&&(this.x=0),this.y<0&&(this.y=0),this.x>window.outerWidth-this.width&&(this.x=window.outerWidth-this.width),this.y>document.documentElement.clientHeight-this.height&&(this.y=document.documentElement.clientHeight-this.height),this.el.style.transform=`translate(${this.x}px, ${this.y}px)`}blockCaught(e){this.speed+=this.speedIncreaseFactor,this.width+=this.growthFactor,this.height+=this.growthFactor,this.el.style.height=`${this.height}px`,this.el.style.width=`${this.width}px`,this.el.style.borderRadius=`${this.width}px`,this.el.style.backgroundColor=e.color}destroy(){n.removeEventListener("keydown.player"),n.removeEventListener("keyup.player")}}class g extends r{constructor(){super("timer",-1,-1,"level"),this.seconds=i.game.secondsPerLevel,this.renderTemplate(),this.el.classList.add("message","is-primary"),this.el.querySelector(".seconds").innerHTML=this.seconds.toString(),this.intervalId=setInterval(()=>this.update(),1e3)}update(){this.seconds--,this.el.querySelector(".seconds").innerHTML=this.seconds.toString(),this.seconds<=3?(this.el.classList.remove("is-primary"),this.el.classList.add("is-danger")):(this.el.classList.add("is-primary"),this.el.classList.remove("is-danger")),0===this.seconds&&window.dispatchEvent(new Event("timer:done"))}destroy(){clearInterval(this.intervalId)}renderTemplate(){this.el.innerHTML='\n            <div class="message-body">\n                <span>time: </span>\n                <span class="seconds"></span>\n            </div>\n        '}}class u extends r{constructor(e,t){super("level",0,0),this.blocks=[],this.failed=!1,this.totalBlocks=e,this.scorePerBlock=t,this.player=new p,this.timer=new g;for(let e=0;e<this.totalBlocks;e++)this.blocks.push(new m(c.getRandomColor(),c.getRandomInt(i.game.blockSpeed.min,i.game.blockSpeed.max),c.getRandomInt(i.game.blockPixels.min,i.game.blockPixels.max),c.getRandomInt(i.game.blockPixels.min,i.game.blockPixels.max)));n.addEventListener("timer:done",()=>{this.failed=!0,this.destroy("level:failed")})}update(){this.player.update(),this.blocks.forEach((e,t)=>{e.update(),c.checkCollision(this.player.getClientReact(),e.getClientReact())&&!1===this.failed&&(this.player.blockCaught(e),e.destroy(),this.blocks.splice(t,1),window.dispatchEvent(new CustomEvent("level:scoreUpdate",{detail:{score:this.scorePerBlock}})),0===this.blocks.length&&this.destroy("level:success"))})}destroy(e){this.timer.destroy(),this.player.destroy(),this.blocks.forEach((e,t)=>{e.destroy(),this.blocks.splice(t,1)}),n.removeEventListener("timer:done"),window.dispatchEvent(new Event(e)),this.el.remove()}}window.addEventListener("load",()=>new class{constructor(){this.levelsPerGame=i.game.levelsPerGame,this.currentLevelsPlayed=0,this.startElementsPerLevel=i.game.startElementsPerLevel,this.elementsIncreasePerLevel=i.game.elementsIncreasePerLevel,this.scorePerElement=i.game.scorePerElement,this.gui=new d,this.maxScore=this.calculateMaxScore(),this.gameLoop(),this.dataService=new h,["level:success","level:failed"].map(e=>{window.addEventListener(e,e=>this.update(e.type))}),["game:start:click","level:success:click","level:failed:click"].map(e=>{window.addEventListener(e,()=>this.startNewLevel())}),window.addEventListener("game:end:click",()=>this.restart())}calculateMaxScore(){let e=0;for(let t=0;t<this.levelsPerGame;t++)e+=(this.startElementsPerLevel+(0===t?0:this.elementsIncreasePerLevel*t))*this.scorePerElement;return e}gameLoop(){void 0!==this.level&&this.level.update(),requestAnimationFrame(()=>this.gameLoop())}update(e){if(this.currentLevelsPlayed++,this.currentLevelsPlayed===this.levelsPerGame)return this.gui.gameEnd(this.maxScore),void this.saveScore();this.gui.levelDone(e)}startNewLevel(){this.level&&!1===this.level.failed&&(this.startElementsPerLevel+=this.elementsIncreasePerLevel),delete this.level,this.gui.newLevel(),this.level=new u(this.startElementsPerLevel,this.scorePerElement)}restart(){this.gui.restart(),this.currentLevelsPlayed=0,this.startElementsPerLevel=i.game.startElementsPerLevel}saveScore(){let e=this.gui.getScore();this.dataService.saveScore(e).then(e=>{console.log("Response after saving score",e)})}})}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vZGV2L2hlbHBlcnMvZG9tZWxlbWVudC50cyIsIndlYnBhY2s6Ly8vLi9kZXYvZ3VpL3Njb3JlLnRzIiwid2VicGFjazovLy8uL2Rldi9oZWxwZXJzL3dpbmRvd2V2ZW50aGFuZGxlci50cyIsIndlYnBhY2s6Ly8vLi9kZXYvZ3VpL21lc3NhZ2VzY3JlZW4udHMiLCJ3ZWJwYWNrOi8vLy4vZGV2L2RhdGFzZXJ2aWNlLnRzIiwid2VicGFjazovLy8uL2Rldi9ndWkvaGlnaHNjb3JlbGlzdC50cyIsIndlYnBhY2s6Ly8vLi9kZXYvZ3VpL2d1aS50cyIsIndlYnBhY2s6Ly8vLi9kZXYvaGVscGVycy91dGlscy50cyIsIndlYnBhY2s6Ly8vLi9kZXYvbGV2ZWwvYmxvY2sudHMiLCJ3ZWJwYWNrOi8vLy4vZGV2L2xldmVsL3BsYXllci50cyIsIndlYnBhY2s6Ly8vLi9kZXYvbGV2ZWwvdGltZXIudHMiLCJ3ZWJwYWNrOi8vLy4vZGV2L2xldmVsL2xldmVsLnRzIiwid2VicGFjazovLy8uL2Rldi9tYWluLnRzIiwid2VicGFjazovLy8uL2Rldi9nYW1lLnRzIl0sIm5hbWVzIjpbImluc3RhbGxlZE1vZHVsZXMiLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJleHBvcnRzIiwibW9kdWxlIiwiaSIsImwiLCJtb2R1bGVzIiwiY2FsbCIsIm0iLCJjIiwiZCIsIm5hbWUiLCJnZXR0ZXIiLCJvIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJjb25maWd1cmFibGUiLCJlbnVtZXJhYmxlIiwiZ2V0IiwiciIsInZhbHVlIiwibiIsIl9fZXNNb2R1bGUiLCJvYmplY3QiLCJwcm9wZXJ0eSIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwicCIsInMiLCJEb21FbGVtZW50IiwiW29iamVjdCBPYmplY3RdIiwidHlwZSIsIngiLCJ5IiwicGFyZW50Q2xhc3MiLCJ0aGlzIiwiZWwiLCJkb2N1bWVudCIsImNyZWF0ZUVsZW1lbnQiLCJtYWluIiwiZ2V0RWxlbWVudEJ5SWQiLCJFcnJvciIsInN0eWxlIiwidHJhbnNmb3JtIiwiY2xhc3NMaXN0IiwiYWRkIiwiYXBwZW5kQ2hpbGQiLCJwYXJlbnRFbCIsInF1ZXJ5U2VsZWN0b3IiLCJnZXRCb3VuZGluZ0NsaWVudFJlY3QiLCJzY29yZV9TY29yZSIsInN1cGVyIiwic2NvcmUiLCJyZW5kZXJUZW1wbGF0ZSIsImlubmVySFRNTCIsInRvU3RyaW5nIiwicmVzZXQiLCJXaW5kb3dFdmVudEhhbmRsZXIiLCJldmVudCIsImZ1bmMiLCJmdW5jdGlvbk1hcCIsIndpbmRvdyIsImFkZEV2ZW50TGlzdGVuZXIiLCJzcGxpdCIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJtZXNzYWdlc2NyZWVuX01lc3NhZ2VTY3JlZW4iLCJpc0FjdGl2ZSIsIm1lc3NhZ2VzIiwiZ2FtZTpzdGFydCIsImhlYWRlciIsImJvZHkiLCJjbGFzc05hbWUiLCJnYW1lOmVuZCIsImxldmVsOnN1Y2Nlc3MiLCJsZXZlbDpmYWlsZWQiLCJzaG93IiwiZSIsImtleUJvYXJkSGFuZGxlciIsImtleSIsImRpc3BhdGNoRXZlbnQiLCJFdmVudCIsImN1cnJlbnRFdmVudCIsImJvZHlSZXBsYWNlbWVudHMiLCJtZXNzYWdlSGVhZGVyIiwibWVzc2FnZUJvZHkiLCJyZXBsYWNlbWVudCIsInJlcGxhY2UiLCJyZW1vdmUiLCJkYXRhc2VydmljZV9EYXRhU2VydmljZSIsImVuZFBvaW50TGlzdCIsImNvbmZpZyIsImRhdGFTZXJ2aWNlIiwiZGF0YWJhc2VOYW1lIiwiY29sbGVjdGlvbk5hbWUiLCJhcGlLZXkiLCJlbmRQb2ludFNhdmUiLCJmdW5jdGlvbmFsaXRpZXMiLCJkaXNhYmxlZCIsInVybCIsImJhc2VVcmwiLCJmZXRjaCIsIkpTT04iLCJzdHJpbmdpZnkiLCJoZWFkZXJzIiwiY29udGVudC10eXBlIiwibWV0aG9kIiwibW9kZSIsInRoZW4iLCJyZXNwb25zZSIsImpzb24iLCJQcm9taXNlIiwicmVzb2x2ZSIsImVycm9yIiwiaGlnaHNjb3JlbGlzdF9IaWdoU2NvcmVMaXN0IiwiZ2V0U2NvcmVzIiwiZGF0YSIsImdldFRib2R5VGVtcGxhdGUiLCJtYXAiLCJpdGVtIiwiaW5kZXgiLCJfaWQiLCIkb2lkIiwiam9pbiIsImd1aV9HVUkiLCJoaWdoU2NvcmVMaXN0VmlzaWJsZSIsIm1lc3NhZ2VTY3JlZW4iLCJ1cGRhdGUiLCJkZXRhaWwiLCJoaWdoU2NvcmVMaXN0IiwidG9Mb3dlckNhc2UiLCJoaWRlIiwibWF4U2NvcmUiLCJfX1NDT1JFX18iLCJfX01BWF9TQ09SRV9fIiwiVXRpbHMiLCJNYXRoIiwicm91bmQiLCJyYW5kb20iLCJtaW4iLCJtYXgiLCJmbG9vciIsImEiLCJiIiwibGVmdCIsInJpZ2h0IiwidG9wIiwiYm90dG9tIiwiYmxvY2tfQmxvY2siLCJjb2xvciIsInNwZWVkIiwid2lkdGgiLCJoZWlnaHQiLCJkZXN0aW5hdGlvbiIsImJhY2tncm91bmRJbWFnZSIsImdldFJhbmRvbUludCIsIm91dGVyV2lkdGgiLCJkb2N1bWVudEVsZW1lbnQiLCJjbGllbnRIZWlnaHQiLCJwbGF5ZXJfUGxheWVyIiwiZ3Jvd3RoRmFjdG9yIiwiZ2FtZSIsInBsYXllciIsInNwZWVkSW5jcmVhc2VGYWN0b3IiLCJrZXlzQWxsb3dlZCIsImtleXNQcmVzc2VkIiwiYm9yZGVyUmFkaXVzIiwia2V5RG93bkhhbmRsZXIiLCJrZXlVcEhhbmRsZXIiLCJpbmRleE9mIiwicHVzaCIsImtleVByZXNzZWRQb3NpdGlvbiIsInNwbGljZSIsImZvckVhY2giLCJibG9jayIsImJhY2tncm91bmRDb2xvciIsInRpbWVyX1RpbWVyIiwic2Vjb25kcyIsInNlY29uZHNQZXJMZXZlbCIsImludGVydmFsSWQiLCJzZXRJbnRlcnZhbCIsImNsZWFySW50ZXJ2YWwiLCJsZXZlbF9MZXZlbCIsInRvdGFsQmxvY2tzIiwic2NvcmVQZXJCbG9jayIsImJsb2NrcyIsImZhaWxlZCIsInRpbWVyIiwiZ2V0UmFuZG9tQ29sb3IiLCJibG9ja1NwZWVkIiwiYmxvY2tQaXhlbHMiLCJkZXN0cm95IiwiY2hlY2tDb2xsaXNpb24iLCJnZXRDbGllbnRSZWFjdCIsImJsb2NrQ2F1Z2h0IiwiQ3VzdG9tRXZlbnQiLCJsZW5ndGgiLCJldmVudFR5cGUiLCJsZXZlbHNQZXJHYW1lIiwiY3VycmVudExldmVsc1BsYXllZCIsInN0YXJ0RWxlbWVudHNQZXJMZXZlbCIsImVsZW1lbnRzSW5jcmVhc2VQZXJMZXZlbCIsInNjb3JlUGVyRWxlbWVudCIsImd1aSIsImNhbGN1bGF0ZU1heFNjb3JlIiwiZ2FtZUxvb3AiLCJzdGFydE5ld0xldmVsIiwicmVzdGFydCIsImxldmVsIiwicmVxdWVzdEFuaW1hdGlvbkZyYW1lIiwiZ2FtZUVuZCIsInNhdmVTY29yZSIsImxldmVsRG9uZSIsIm5ld0xldmVsIiwiZ2V0U2NvcmUiLCJjb25zb2xlIiwibG9nIl0sIm1hcHBpbmdzIjoiYUFDQSxJQUFBQSxLQUdBLFNBQUFDLEVBQUFDLEdBR0EsR0FBQUYsRUFBQUUsR0FDQSxPQUFBRixFQUFBRSxHQUFBQyxRQUdBLElBQUFDLEVBQUFKLEVBQUFFLElBQ0FHLEVBQUFILEVBQ0FJLEdBQUEsRUFDQUgsWUFVQSxPQU5BSSxFQUFBTCxHQUFBTSxLQUFBSixFQUFBRCxRQUFBQyxJQUFBRCxRQUFBRixHQUdBRyxFQUFBRSxHQUFBLEVBR0FGLEVBQUFELFFBS0FGLEVBQUFRLEVBQUFGLEVBR0FOLEVBQUFTLEVBQUFWLEVBR0FDLEVBQUFVLEVBQUEsU0FBQVIsRUFBQVMsRUFBQUMsR0FDQVosRUFBQWEsRUFBQVgsRUFBQVMsSUFDQUcsT0FBQUMsZUFBQWIsRUFBQVMsR0FDQUssY0FBQSxFQUNBQyxZQUFBLEVBQ0FDLElBQUFOLEtBTUFaLEVBQUFtQixFQUFBLFNBQUFqQixHQUNBWSxPQUFBQyxlQUFBYixFQUFBLGNBQWlEa0IsT0FBQSxLQUlqRHBCLEVBQUFxQixFQUFBLFNBQUFsQixHQUNBLElBQUFTLEVBQUFULEtBQUFtQixXQUNBLFdBQTJCLE9BQUFu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S3VLLElBQUlVLFdBRVRqTCxLQUFLNEssTUFBUSxJQUFJMUIsRUFBTWxKLEtBQUtvSyxzQkFBdUJwSyxLQUFLc0ssaUJBTXBEM0ssVUFDSkssS0FBS3VLLElBQUlJLFVBQ1QzSyxLQUFLbUssb0JBQXNCLEVBQzNCbkssS0FBS29LLHNCQUF3QjdHLEVBQU9zRSxLQUFLdUMsc0JBTXJDekssWUFDSixJQUFJc0IsRUFBUWpCLEtBQUt1SyxJQUFJVyxXQUNyQmxMLEtBQUt3RCxZQUFZdUgsVUFBVTlKLEdBQU91RCxLQUFNUSxJQUNwQ21HLFFBQVFDLElBQUksOEJBQStCcEciLCJmaWxlIjoibWFpbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIiBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbiBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG5cbiBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbiBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKSB7XG4gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4gXHRcdH1cbiBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbiBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuIFx0XHRcdGk6IG1vZHVsZUlkLFxuIFx0XHRcdGw6IGZhbHNlLFxuIFx0XHRcdGV4cG9ydHM6IHt9XG4gXHRcdH07XG5cbiBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG4gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbiBcdFx0bW9kdWxlLmwgPSB0cnVlO1xuXG4gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbiBcdH1cblxuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbiBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG5cbiBcdC8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb24gZm9yIGhhcm1vbnkgZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7XG4gXHRcdGlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwge1xuIFx0XHRcdFx0Y29uZmlndXJhYmxlOiBmYWxzZSxcbiBcdFx0XHRcdGVudW1lcmFibGU6IHRydWUsXG4gXHRcdFx0XHRnZXQ6IGdldHRlclxuIFx0XHRcdH0pO1xuIFx0XHR9XG4gXHR9O1xuXG4gXHQvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSBmdW5jdGlvbihleHBvcnRzKSB7XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG4gXHR9O1xuXG4gXHQvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlc1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5uID0gZnVuY3Rpb24obW9kdWxlKSB7XG4gXHRcdHZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgP1xuIFx0XHRcdGZ1bmN0aW9uIGdldERlZmF1bHQoKSB7IHJldHVybiBtb2R1bGVbJ2RlZmF1bHQnXTsgfSA6XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0TW9kdWxlRXhwb3J0cygpIHsgcmV0dXJuIG1vZHVsZTsgfTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgJ2EnLCBnZXR0ZXIpO1xuIFx0XHRyZXR1cm4gZ2V0dGVyO1xuIFx0fTtcblxuIFx0Ly8gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbihvYmplY3QsIHByb3BlcnR5KSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSk7IH07XG5cbiBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuXG5cbiBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuIFx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oX193ZWJwYWNrX3JlcXVpcmVfXy5zID0gMSk7XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBEb21FbGVtZW50IHtcbiAgICBwcm90ZWN0ZWQgZWw6IEhUTUxFbGVtZW50O1xuICAgIHByb3RlY3RlZCB4OiBudW1iZXI7XG4gICAgcHJvdGVjdGVkIHk6IG51bWJlcjtcblxuICAgIGNvbnN0cnVjdG9yKHR5cGU6IHN0cmluZywgeDogbnVtYmVyLCB5OiBudW1iZXIsIHBhcmVudENsYXNzOiBzdHJpbmcgPSAnJykge1xuICAgICAgICB0aGlzLnggPSB4O1xuICAgICAgICB0aGlzLnkgPSB5O1xuXG4gICAgICAgIHRoaXMuZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgbGV0IG1haW4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFpbicpO1xuICAgICAgICBpZiAobWFpbiA9PT0gbnVsbCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiPG1haW4+IGVsZW1lbnQgZG9lc24ndCBleGlzdCFcIik7XG4gICAgICAgIH1cblxuICAgICAgICAvLy0xIGNoZWNrIGlzIHRvIGxldCBDU1MgZG8gaXRzIG93biBqb2IgQHRvZG8gY2xlYW5lciBzb2x1dGlvbj9cbiAgICAgICAgaWYgKHRoaXMueCA+IC0xICYmIHRoaXMueSA+IC0xKSB7XG4gICAgICAgICAgICB0aGlzLmVsLnN0eWxlLnRyYW5zZm9ybSA9IGB0cmFuc2xhdGUoJHt0aGlzLnh9cHgsICR7dGhpcy55fXB4KWA7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5lbC5jbGFzc0xpc3QuYWRkKGBnYW1lLSR7dHlwZX1gKTtcblxuICAgICAgICBpZiAocGFyZW50Q2xhc3MgPT09ICcnKSB7XG4gICAgICAgICAgICBtYWluLmFwcGVuZENoaWxkKHRoaXMuZWwpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgbGV0IHBhcmVudEVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgLmdhbWUtJHtwYXJlbnRDbGFzc31gKTtcbiAgICAgICAgICAgIGlmIChwYXJlbnRFbCA9PT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgPC5nYW1lLSR7cGFyZW50Q2xhc3N9PiBlbGVtZW50IGRvZXNuJ3QgZXhpc3QhYCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBwYXJlbnRFbC5hcHBlbmRDaGlsZCh0aGlzLmVsKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEByZXR1cm5zIENsaWVudFJlY3RcbiAgICAgKi9cbiAgICBwdWJsaWMgZ2V0Q2xpZW50UmVhY3QoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmVsLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICAgIH1cbn1cbiIsImltcG9ydCBEb21FbGVtZW50IGZyb20gXCIuLi9oZWxwZXJzL2RvbWVsZW1lbnRcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2NvcmUgZXh0ZW5kcyBEb21FbGVtZW50IHtcbiAgICBwcml2YXRlIHNjb3JlOiBudW1iZXIgPSAwO1xuXG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHN1cGVyKCdzY29yZScsIC0xLCAtMSwgJ2d1aScpO1xuXG4gICAgICAgIHRoaXMucmVuZGVyVGVtcGxhdGUoKTtcbiAgICAgICAgdGhpcy5lbC5xdWVyeVNlbGVjdG9yKCcuc2NvcmUtY291bnQnKS5pbm5lckhUTUwgPSB0aGlzLnNjb3JlLnRvU3RyaW5nKCk7XG4gICAgICAgIHRoaXMuZWwuY2xhc3NMaXN0LmFkZCgnbWVzc2FnZScsICdpcy13YXJuaW5nJyk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmV0cmlldmUgY3VycmVudCBzY29yZVxuICAgICAqXG4gICAgICogQHJldHVybnMge251bWJlcn1cbiAgICAgKi9cbiAgICBwdWJsaWMgZ2V0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5zY29yZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBVcGRhdGUgdGhlIHNjb3JlIGJhc2VkIG9uIGEgQ3VzdG9tIEV2ZW50IGZyb20gdGhlIEJsb2NrIG9iamVjdFxuICAgICAqXG4gICAgICogQHBhcmFtIHNjb3JlXG4gICAgICogQHBhcmFtIFtyZXNldF1cbiAgICAgKi9cbiAgICBwdWJsaWMgdXBkYXRlKHNjb3JlOiBudW1iZXIsIHJlc2V0OiBib29sZWFuID0gZmFsc2UpIHtcbiAgICAgICAgdGhpcy5zY29yZSA9IHJlc2V0ID8gc2NvcmUgOiB0aGlzLnNjb3JlICsgc2NvcmU7XG4gICAgICAgIHRoaXMuZWwucXVlcnlTZWxlY3RvcignLnNjb3JlLWNvdW50JykuaW5uZXJIVE1MID0gdGhpcy5zY29yZS50b1N0cmluZygpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRlbXBsYXRlIG5lZWRlZCB0byBzaG93IG1vcmUgZWxlbWVudHNcbiAgICAgKi9cbiAgICBwcml2YXRlIHJlbmRlclRlbXBsYXRlKCkge1xuICAgICAgICB0aGlzLmVsLmlubmVySFRNTCA9IGBcbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJtZXNzYWdlLWJvZHlcIj5cbiAgICAgICAgICAgICAgICA8c3Bhbj5zY29yZTogPC9zcGFuPlxuICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPVwic2NvcmUtY291bnRcIj48L3NwYW4+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgYDtcbiAgICB9XG59XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBXaW5kb3dFdmVudEhhbmRsZXIge1xuICAgIHByaXZhdGUgc3RhdGljIGZ1bmN0aW9uTWFwOiB7IFtrOiBzdHJpbmddOiBhbnkgfSA9IHt9O1xuXG4gICAgcHVibGljIHN0YXRpYyBhZGRFdmVudExpc3RlbmVyKGV2ZW50OiBzdHJpbmcsIGZ1bmM6IGFueSkge1xuICAgICAgICBXaW5kb3dFdmVudEhhbmRsZXIuZnVuY3Rpb25NYXBbZXZlbnRdID0gZnVuYztcbiAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoZXZlbnQuc3BsaXQoJy4nKVswXSwgV2luZG93RXZlbnRIYW5kbGVyLmZ1bmN0aW9uTWFwW2V2ZW50XSk7XG4gICAgfVxuXG4gICAgcHVibGljIHN0YXRpYyByZW1vdmVFdmVudExpc3RlbmVyKGV2ZW50OiBzdHJpbmcpIHtcbiAgICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoZXZlbnQuc3BsaXQoJy4nKVswXSwgV2luZG93RXZlbnRIYW5kbGVyLmZ1bmN0aW9uTWFwW2V2ZW50XSk7XG4gICAgICAgIGRlbGV0ZSBXaW5kb3dFdmVudEhhbmRsZXIuZnVuY3Rpb25NYXBbZXZlbnRdO1xuICAgIH1cbn1cbiIsImltcG9ydCBEb21FbGVtZW50IGZyb20gXCIuLi9oZWxwZXJzL2RvbWVsZW1lbnRcIjtcbmltcG9ydCBXaW5kb3dFdmVudEhhbmRsZXIgZnJvbSBcIi4uL2hlbHBlcnMvd2luZG93ZXZlbnRoYW5kbGVyXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIE1lc3NhZ2VTY3JlZW4gZXh0ZW5kcyBEb21FbGVtZW50IHtcbiAgICBwcml2YXRlIGN1cnJlbnRFdmVudCE6IHN0cmluZztcbiAgICBwcml2YXRlIGlzQWN0aXZlOiBib29sZWFuID0gZmFsc2U7XG5cbiAgICBwcml2YXRlIG1lc3NhZ2VzOiB7IFtrOiBzdHJpbmddOiB7ICdoZWFkZXInOiBzdHJpbmcsICdib2R5Jzogc3RyaW5nLCAnY2xhc3NOYW1lJzogc3RyaW5nIH0gfSA9IHtcbiAgICAgICAgJ2dhbWU6c3RhcnQnOiB7XG4gICAgICAgICAgICAnaGVhZGVyJzogJ1dlbGNvbWUgdG8gQmxvY2stby1CbG9jayEnLFxuICAgICAgICAgICAgJ2JvZHknOiAnSXRcXCdzIHRpbWUgdG8gY2F0Y2ggdGhlbSBibG9ja3MhPGJyLz48YnIvPlVzZSB5b3VyIGFycm93IGtleXMgdG8gbW92ZSB5b3VyIHBsYXllciBhcm91bmQgYW5kIHByZXNzIHNwYWNlIHRvIHN0YXJ0Ljxici8+PGJyLz5QcmVzcyAtPHN0cm9uZz5IPC9zdHJvbmc+LSB0byB2aWV3IHRoZSBoaWdoc2NvcmUgbGlzdCcsXG4gICAgICAgICAgICAnY2xhc3NOYW1lJzogJ2lzLWluZm8nXG4gICAgICAgIH0sXG4gICAgICAgICdnYW1lOmVuZCc6IHtcbiAgICAgICAgICAgICdoZWFkZXInOiAnWW91ciBnYW1lIGlzIG92ZXIhJyxcbiAgICAgICAgICAgICdib2R5JzogJ1lvdSBtYWRlIGl0LCB5b3VyIGZpbmFsIHNjb3JlIGlzIF9fU0NPUkVfXyBvdXQgb2YgbWF4IF9fTUFYX1NDT1JFX18gcG9pbnRzLjxici8+PGJyLz5UaGFua3MgZm9yIHBsYXlpbmcsIHByZXNzIHNwYWNlIHRvIHJlc3RhcnQgdGhlIG1hZG5lc3MuPGJyLz48YnIvPlByZXNzIC08c3Ryb25nPkg8L3N0cm9uZz4tIHRvIHZpZXcgdGhlIGhpZ2hzY29yZSBsaXN0JyxcbiAgICAgICAgICAgICdjbGFzc05hbWUnOiAnaXMtc3VjY2VzcydcbiAgICAgICAgfSxcbiAgICAgICAgJ2xldmVsOnN1Y2Nlc3MnOiB7XG4gICAgICAgICAgICAnaGVhZGVyJzogJ1lFQUghIExldmVsIGNvbXBsZXRlZCEnLFxuICAgICAgICAgICAgJ2JvZHknOiAnUGVyZm9ybWluZyBsaWtlIGEgYm9zcyEgUHJlc3Mgc3BhY2UgdG8gcHJvY2VlZCB0byB0aGUgbmV4dCBsZXZlbCBhbmQgY2F0Y2ggZXZlbiBtb3JlIGJsb2NrcycsXG4gICAgICAgICAgICAnY2xhc3NOYW1lJzogJ2lzLXN1Y2Nlc3MnXG4gICAgICAgIH0sXG4gICAgICAgICdsZXZlbDpmYWlsZWQnOiB7XG4gICAgICAgICAgICAnaGVhZGVyJzogJ0FBSCEgTGV2ZWwgZmFpbGVkIScsXG4gICAgICAgICAgICAnYm9keSc6ICdUcnkgYWdhaW4gYW5kIHNob3cgdXMgd2hhdCB5b3VcXCdyZSBtYWRlIG9mZiEgUHJlc3Mgc3BhY2UgdG8gcmVzdGFydCB0aGlzIGxldmVsJyxcbiAgICAgICAgICAgICdjbGFzc05hbWUnOiAnaXMtZGFuZ2VyJ1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICBzdXBlcignbWVzc2FnZXNjcmVlbicsIC0xLCAtMSwgJ2d1aScpO1xuICAgICAgICB0aGlzLmVsLmNsYXNzTGlzdC5hZGQoJ21lc3NhZ2UnKTtcblxuICAgICAgICB0aGlzLnJlbmRlclRlbXBsYXRlKCk7XG4gICAgICAgIHRoaXMuc2hvdygnZ2FtZTpzdGFydCcpO1xuICAgICAgICBXaW5kb3dFdmVudEhhbmRsZXIuYWRkRXZlbnRMaXN0ZW5lcigna2V5dXAubWVzc2FnZXNjcmVlbicsIChlOiBLZXlib2FyZEV2ZW50KSA9PiB0aGlzLmtleUJvYXJkSGFuZGxlcihlKSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogSGFuZGxlIHRoZSBzcGFjZWJhclxuICAgICAqXG4gICAgICogQHBhcmFtIHtLZXlib2FyZEV2ZW50fSBlXG4gICAgICovXG4gICAga2V5Qm9hcmRIYW5kbGVyKGU6IEtleWJvYXJkRXZlbnQpIHtcbiAgICAgICAgaWYgKGUua2V5ID09PSAnICcgJiYgdGhpcy5pc0FjdGl2ZSA9PT0gdHJ1ZSkge1xuICAgICAgICAgICAgd2luZG93LmRpc3BhdGNoRXZlbnQobmV3IEV2ZW50KGAke3RoaXMuY3VycmVudEV2ZW50fTpjbGlja2ApKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFNob3cgdGhlIGRlc2lyZWQgbWVzc2FnZSAodHlwZSBtYXRjaGVzIGluZGV4IGluIG9iamVjdClcbiAgICAgKlxuICAgICAqIEBwYXJhbSB0eXBlXG4gICAgICogQHBhcmFtIFtib2R5UmVwbGFjZW1lbnRzXVxuICAgICAqL1xuICAgIHB1YmxpYyBzaG93KHR5cGU6IHN0cmluZywgYm9keVJlcGxhY2VtZW50czogeyBbazogc3RyaW5nXTogc3RyaW5nIH0gPSB7fSkge1xuICAgICAgICBsZXQgbWVzc2FnZUhlYWRlciA9IHRoaXMubWVzc2FnZXNbdHlwZV0uaGVhZGVyO1xuICAgICAgICBsZXQgbWVzc2FnZUJvZHkgPSB0aGlzLm1lc3NhZ2VzW3R5cGVdLmJvZHk7XG4gICAgICAgIGZvciAobGV0IHJlcGxhY2VtZW50IGluIGJvZHlSZXBsYWNlbWVudHMpIHtcbiAgICAgICAgICAgIG1lc3NhZ2VCb2R5ID0gbWVzc2FnZUJvZHkucmVwbGFjZShyZXBsYWNlbWVudCwgYm9keVJlcGxhY2VtZW50c1tyZXBsYWNlbWVudF0pO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5lbC5xdWVyeVNlbGVjdG9yKCcubWVzc2FnZS1oZWFkZXInKS5pbm5lckhUTUwgPSBtZXNzYWdlSGVhZGVyO1xuICAgICAgICB0aGlzLmVsLnF1ZXJ5U2VsZWN0b3IoJy5tZXNzYWdlLWJvZHknKS5pbm5lckhUTUwgPSBtZXNzYWdlQm9keTtcblxuICAgICAgICB0aGlzLmVsLmNsYXNzTGlzdC5hZGQoJ3Nob3cnLCB0aGlzLm1lc3NhZ2VzW3R5cGVdLmNsYXNzTmFtZSk7XG4gICAgICAgIHRoaXMuY3VycmVudEV2ZW50ID0gdHlwZTtcbiAgICAgICAgdGhpcy5pc0FjdGl2ZSA9IHRydWU7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogSGlkZSBtZXNzYWdlIG9uIHNjcmVlblxuICAgICAqL1xuICAgIHB1YmxpYyBoaWRlKCkge1xuICAgICAgICB0aGlzLmVsLmNsYXNzTGlzdC5yZW1vdmUoJ3Nob3cnLCAnaXMtaW5mbycsICdpcy1zdWNjZXNzJywgJ2lzLWRhbmdlcicpO1xuICAgICAgICB0aGlzLmlzQWN0aXZlID0gZmFsc2U7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVGVtcGxhdGUgbmVlZGVkIHRvIHNob3cgbW9yZSBlbGVtZW50c1xuICAgICAqL1xuICAgIHByaXZhdGUgcmVuZGVyVGVtcGxhdGUoKSB7XG4gICAgICAgIHRoaXMuZWwuaW5uZXJIVE1MID0gYFxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cIm1lc3NhZ2UtaGVhZGVyXCI+PC9kaXY+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVwibWVzc2FnZS1ib2R5XCI+PC9kaXY+XG4gICAgICAgIGA7XG4gICAgfVxufVxuIiwiaW1wb3J0IGNvbmZpZyBmcm9tICcuL2NvbmZpZy5qc29uJztcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgRGF0YVNlcnZpY2Uge1xuICAgIHByaXZhdGUgZW5kUG9pbnRMaXN0OiBzdHJpbmcgPSBgL2RhdGFiYXNlcy8ke2NvbmZpZy5kYXRhU2VydmljZS5kYXRhYmFzZU5hbWV9L2NvbGxlY3Rpb25zLyR7Y29uZmlnLmRhdGFTZXJ2aWNlLmNvbGxlY3Rpb25OYW1lfT9hcGlLZXk9JHtjb25maWcuZGF0YVNlcnZpY2UuYXBpS2V5fWA7XG4gICAgcHJpdmF0ZSBlbmRQb2ludFNhdmU6IHN0cmluZyA9IGAvZGF0YWJhc2VzLyR7Y29uZmlnLmRhdGFTZXJ2aWNlLmRhdGFiYXNlTmFtZX0vY29sbGVjdGlvbnMvJHtjb25maWcuZGF0YVNlcnZpY2UuY29sbGVjdGlvbk5hbWV9P2FwaUtleT0ke2NvbmZpZy5kYXRhU2VydmljZS5hcGlLZXl9YDtcblxuICAgIC8qKlxuICAgICAqIFN0b3JlIHRoZSBsYXRlc3Qgc2NvcmUgaW4gdGhlIERCXG4gICAgICpcbiAgICAgKiBAcGFyYW0gc2NvcmVcbiAgICAgKiBAcmV0dXJucyB7UHJvbWlzZTx7fT59XG4gICAgICovXG4gICAgcHVibGljIHNhdmVTY29yZShzY29yZTogbnVtYmVyKSB7XG4gICAgICAgIGlmIChjb25maWcuZnVuY3Rpb25hbGl0aWVzLmRhdGFTZXJ2aWNlID09PSBmYWxzZSkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZGlzYWJsZWQoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGxldCB1cmwgPSBgJHtjb25maWcuZGF0YVNlcnZpY2UuYmFzZVVybH0ke3RoaXMuZW5kUG9pbnRTYXZlfWA7XG4gICAgICAgIHJldHVybiBmZXRjaCh1cmwsIHtcbiAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICAgICAgICBzY29yZTogc2NvcmVcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgICAgICdjb250ZW50LXR5cGUnOiAnYXBwbGljYXRpb24vanNvbidcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICAgIG1vZGU6ICdjb3JzJ1xuICAgICAgICB9KS50aGVuKHJlc3BvbnNlID0+IHJlc3BvbnNlLmpzb24oKSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IGFsbCB0aGUgY3VycmVudCBzY29yZXMgZnJvbSB0aGUgREJcbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHtQcm9taXNlPFtdPn1cbiAgICAgKi9cbiAgICBwdWJsaWMgZ2V0U2NvcmVzKCkge1xuICAgICAgICBpZiAoY29uZmlnLmZ1bmN0aW9uYWxpdGllcy5kYXRhU2VydmljZSA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmRpc2FibGVkKCk7XG4gICAgICAgIH1cblxuICAgICAgICBsZXQgdXJsID0gYCR7Y29uZmlnLmRhdGFTZXJ2aWNlLmJhc2VVcmx9JHt0aGlzLmVuZFBvaW50TGlzdH0mcz17XCJzY29yZVwiOiAtMX0mbD0xMGA7XG4gICAgICAgIHJldHVybiBmZXRjaCh1cmwsIHtcbiAgICAgICAgICAgIG1vZGU6ICdjb3JzJ1xuICAgICAgICB9KS50aGVuKHJlc3BvbnNlID0+IHJlc3BvbnNlLmpzb24oKSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2VuZXJhbCBtZXNzYWdlIHdoZW4gdGhpcyBzZXJ2aWNlIGlzIGluYWN0aXZlXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyB7UHJvbWlzZTx7fT59XG4gICAgICovXG4gICAgcHJpdmF0ZSBkaXNhYmxlZCgpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7XG4gICAgICAgICAgICByZXNvbHZlKHtcImVycm9yXCI6IFwiRGF0YXNlcnZpY2UgaXMgZGlzYWJsZWRcIn0pO1xuICAgICAgICB9KTtcbiAgICB9XG59XG4iLCJpbXBvcnQgRG9tRWxlbWVudCBmcm9tIFwiLi4vaGVscGVycy9kb21lbGVtZW50XCI7XG5pbXBvcnQgRGF0YVNlcnZpY2UgZnJvbSBcIi4uL2RhdGFzZXJ2aWNlXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEhpZ2hTY29yZUxpc3QgZXh0ZW5kcyBEb21FbGVtZW50IHtcbiAgICBwcml2YXRlIGRhdGFTZXJ2aWNlOiBEYXRhU2VydmljZTtcblxuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICBzdXBlcignaGlnaHNjb3JlbGlzdCcsIC0xLCAtMSwgJ2d1aScpO1xuICAgICAgICB0aGlzLmVsLmNsYXNzTGlzdC5hZGQoJ21lc3NhZ2UnLCAnaXMtd2FybmluZycpO1xuXG4gICAgICAgIHRoaXMucmVuZGVyVGVtcGxhdGUoKTtcbiAgICAgICAgdGhpcy5kYXRhU2VydmljZSA9IG5ldyBEYXRhU2VydmljZSgpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFNob3cgdGhlIGhpZ2ggc2NvcmUgbGlzdFxuICAgICAqL1xuICAgIHB1YmxpYyBzaG93KCkge1xuICAgICAgICB0aGlzLmRhdGFTZXJ2aWNlLmdldFNjb3JlcygpLnRoZW4oKGRhdGEpID0+IHtcbiAgICAgICAgICAgIGxldCB0Qm9keSA9IHRoaXMuZWwucXVlcnlTZWxlY3RvcignLnRib2R5Jyk7XG4gICAgICAgICAgICB0Qm9keS5pbm5lckhUTUwgPSB0aGlzLmdldFRib2R5VGVtcGxhdGUoZGF0YSk7XG4gICAgICAgICAgICB0aGlzLmVsLmNsYXNzTGlzdC5hZGQoJ3Nob3cnKTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogSGlkZSBpdCBwZXJpb2RcbiAgICAgKi9cbiAgICBwdWJsaWMgaGlkZSgpIHtcbiAgICAgICAgdGhpcy5lbC5jbGFzc0xpc3QucmVtb3ZlKCdzaG93Jyk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmV0dXJuIHRoZSBtYXBwZWQgSFRNTCA8dHI+IGxpc3QgZm9yIGFwcGVuZGluZyBpbiA8dGJvZHk+XG4gICAgICpcbiAgICAgKiBAcGFyYW0ge1t7fV19IGRhdGFcbiAgICAgKiBAcmV0dXJucyB7c3RyaW5nfVxuICAgICAqL1xuICAgIHByaXZhdGUgZ2V0VGJvZHlUZW1wbGF0ZShkYXRhOiB7IHNjb3JlOiBudW1iZXIsIF9pZDogeyAkb2lkOiBzdHJpbmcgfSB9W10pIHtcbiAgICAgICAgcmV0dXJuIGBcbiAgICAgICAgICAgICR7ZGF0YS5tYXAoKGl0ZW0sIGluZGV4KSA9PiBgPHRyPlxuICAgICAgICAgICAgICAgIDx0ZD4ke2luZGV4ICsgMX08L3RkPlxuICAgICAgICAgICAgICAgIDx0ZD4ke2l0ZW0uX2lkLiRvaWR9PC90ZD5cbiAgICAgICAgICAgICAgICA8dGQ+JHtpdGVtLnNjb3JlLnRvU3RyaW5nKCl9PC90ZD5cbiAgICAgICAgICAgIDwvdHI+YCkuam9pbignJyl9XG4gICAgICAgIGA7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVGVtcGxhdGUgbmVlZGVkIHRvIHNob3cgbW9yZSBlbGVtZW50c1xuICAgICAqL1xuICAgIHByaXZhdGUgcmVuZGVyVGVtcGxhdGUoKSB7XG4gICAgICAgIHRoaXMuZWwuaW5uZXJIVE1MID0gYFxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cIm1lc3NhZ2UtaGVhZGVyXCI+XG4gICAgICAgICAgICAgICAgPHA+VG9wIDEwIEhpZ2ggU2NvcmVzIChwcmVzcyAtPHN0cm9uZz5lc2M8L3N0cm9uZz4tIHRvIHJldHVybik8L3A+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJtZXNzYWdlLWJvZHlcIj5cbiAgICAgICAgICAgICAgICA8dGFibGUgY2xhc3M9XCJ0YWJsZVwiPlxuICAgICAgICAgICAgICAgICAgICA8dGhlYWQ+XG4gICAgICAgICAgICAgICAgICAgIDx0cj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDx0aD4jPC90aD5cbiAgICAgICAgICAgICAgICAgICAgICAgIDx0aD5Nb25nb0lEPC90aD5cbiAgICAgICAgICAgICAgICAgICAgICAgIDx0aD5TY29yZTwvdGg+XG4gICAgICAgICAgICAgICAgICAgIDwvdHI+XG4gICAgICAgICAgICAgICAgICAgIDwvdGhlYWQ+XG4gICAgICAgICAgICAgICAgICAgIDx0Ym9keSBjbGFzcz1cInRib2R5XCI+PC90Ym9keT5cbiAgICAgICAgICAgICAgICA8L3RhYmxlPlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgIGA7XG4gICAgfVxufVxuIiwiaW1wb3J0IFNjb3JlIGZyb20gJy4vc2NvcmUnO1xuaW1wb3J0IE1lc3NhZ2VTY3JlZW4gZnJvbSAnLi9tZXNzYWdlc2NyZWVuJztcbmltcG9ydCBEb21FbGVtZW50IGZyb20gXCIuLi9oZWxwZXJzL2RvbWVsZW1lbnRcIjtcbmltcG9ydCBIaWdoU2NvcmVMaXN0IGZyb20gXCIuL2hpZ2hzY29yZWxpc3RcIjtcbmltcG9ydCBXaW5kb3dFdmVudEhhbmRsZXIgZnJvbSBcIi4uL2hlbHBlcnMvd2luZG93ZXZlbnRoYW5kbGVyXCI7XG5pbXBvcnQgY29uZmlnIGZyb20gJy4uL2NvbmZpZy5qc29uJztcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgR1VJIGV4dGVuZHMgRG9tRWxlbWVudCB7XG4gICAgcHJpdmF0ZSBzY29yZTogU2NvcmU7XG4gICAgcHJpdmF0ZSBtZXNzYWdlU2NyZWVuOiBNZXNzYWdlU2NyZWVuO1xuICAgIHByaXZhdGUgaGlnaFNjb3JlTGlzdDogSGlnaFNjb3JlTGlzdDtcbiAgICBwcml2YXRlIGhpZ2hTY29yZUxpc3RWaXNpYmxlOiBib29sZWFuID0gZmFsc2U7XG5cbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgc3VwZXIoJ2d1aScsIC0xLCAtMSk7XG5cbiAgICAgICAgdGhpcy5zY29yZSA9IG5ldyBTY29yZSgpO1xuICAgICAgICB0aGlzLm1lc3NhZ2VTY3JlZW4gPSBuZXcgTWVzc2FnZVNjcmVlbigpO1xuICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignbGV2ZWw6c2NvcmVVcGRhdGUnLCAoZSkgPT4gdGhpcy5zY29yZS51cGRhdGUoKGUgYXMgQ3VzdG9tRXZlbnQpLmRldGFpbC5zY29yZSkpO1xuXG4gICAgICAgIGlmIChjb25maWcuZnVuY3Rpb25hbGl0aWVzLmRhdGFTZXJ2aWNlID09PSB0cnVlKSB7XG4gICAgICAgICAgICB0aGlzLmhpZ2hTY29yZUxpc3QgPSBuZXcgSGlnaFNjb3JlTGlzdCgpO1xuICAgICAgICAgICAgV2luZG93RXZlbnRIYW5kbGVyLmFkZEV2ZW50TGlzdGVuZXIoJ2tleXVwLmhpZ2hzY29yZWxpc3QnLCAoZTogS2V5Ym9hcmRFdmVudCkgPT4gdGhpcy5rZXlCb2FyZEhhbmRsZXIoZSkpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogSGFuZGxlIHRoZSBzcGFjZWJhclxuICAgICAqXG4gICAgICogQHBhcmFtIHtLZXlib2FyZEV2ZW50fSBlXG4gICAgICovXG4gICAga2V5Qm9hcmRIYW5kbGVyKGU6IEtleWJvYXJkRXZlbnQpIHtcbiAgICAgICAgbGV0IGtleSA9IGUua2V5LnRvTG93ZXJDYXNlKCk7XG4gICAgICAgIGlmIChrZXkgPT09ICdoJyAmJiB0aGlzLmhpZ2hTY29yZUxpc3RWaXNpYmxlID09PSBmYWxzZSkge1xuICAgICAgICAgICAgdGhpcy5oaWdoU2NvcmVMaXN0VmlzaWJsZSA9IHRydWU7XG4gICAgICAgICAgICB0aGlzLmhpZ2hTY29yZUxpc3Quc2hvdygpO1xuICAgICAgICB9IGVsc2UgaWYgKGtleSA9PT0gJ2VzY2FwZScgJiYgdGhpcy5oaWdoU2NvcmVMaXN0VmlzaWJsZSA9PT0gdHJ1ZSkge1xuICAgICAgICAgICAgdGhpcy5oaWdoU2NvcmVMaXN0VmlzaWJsZSA9IGZhbHNlO1xuICAgICAgICAgICAgdGhpcy5oaWdoU2NvcmVMaXN0LmhpZGUoKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRyaWdnZXJlZCB3aGVuIGEgbGV2ZWwgaXMgZG9uZVxuICAgICAqXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHR5cGVcbiAgICAgKi9cbiAgICBwdWJsaWMgbGV2ZWxEb25lKHR5cGU6IHN0cmluZykge1xuICAgICAgICB0aGlzLm1lc3NhZ2VTY3JlZW4uc2hvdyh0eXBlKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUcmlnZ2VyZWQgd2hlbiBhIG5ldyBsZXZlbCBzdGFydHNcbiAgICAgKi9cbiAgICBwdWJsaWMgbmV3TGV2ZWwoKSB7XG4gICAgICAgIHRoaXMubWVzc2FnZVNjcmVlbi5oaWRlKCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVHJpZ2dlcmVkIHdoZW4gdGhlIGdhbWUgaXMgZG9uZVxuICAgICAqXG4gICAgICogQHBhcmFtIG1heFNjb3JlXG4gICAgICovXG4gICAgcHVibGljIGdhbWVFbmQobWF4U2NvcmU6IG51bWJlcikge1xuICAgICAgICB0aGlzLm1lc3NhZ2VTY3JlZW4uc2hvdygnZ2FtZTplbmQnLCB7XG4gICAgICAgICAgICAnX19TQ09SRV9fJzogdGhpcy5zY29yZS5nZXQoKS50b1N0cmluZygpLFxuICAgICAgICAgICAgJ19fTUFYX1NDT1JFX18nOiBtYXhTY29yZS50b1N0cmluZygpXG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRyaWdnZXJlZCB3aGVuIHdlIG5lZWQgdG8gcmVzdGFydCwgZ28gdG8gZmlyc3Qgc2NyZWVuIGFuZCBzZXQgc2NvcmUgdG8gMFxuICAgICAqL1xuICAgIHB1YmxpYyByZXN0YXJ0KCkge1xuICAgICAgICB0aGlzLm1lc3NhZ2VTY3JlZW4uaGlkZSgpO1xuICAgICAgICB0aGlzLm1lc3NhZ2VTY3JlZW4uc2hvdygnZ2FtZTpzdGFydCcpO1xuICAgICAgICB0aGlzLnNjb3JlLnVwZGF0ZSgwLCB0cnVlKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBAcmV0dXJucyB7bnVtYmVyfVxuICAgICAqL1xuICAgIHB1YmxpYyBnZXRTY29yZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc2NvcmUuZ2V0KCk7XG4gICAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgVXRpbHMge1xuICAgIHN0YXRpYyBnZXRSYW5kb21Db2xvcigpIHtcbiAgICAgICAgbGV0IG8gPSBNYXRoLnJvdW5kLCByID0gTWF0aC5yYW5kb20sIHMgPSAyNTU7XG4gICAgICAgIHJldHVybiBgcmdiYSgke28ocigpICogcyl9LCR7byhyKCkgKiBzKX0sJHtvKHIoKSAqIHMpfSwxKWA7XG4gICAgfVxuXG4gICAgc3RhdGljIGdldFJhbmRvbUludChtaW46IG51bWJlciwgbWF4OiBudW1iZXIpIHtcbiAgICAgICAgcmV0dXJuIE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIChtYXggLSBtaW4gKyAxKSkgKyBtaW47XG4gICAgfVxuXG4gICAgc3RhdGljIGNoZWNrQ29sbGlzaW9uKGE6IENsaWVudFJlY3QsIGI6IENsaWVudFJlY3QpIHtcbiAgICAgICAgcmV0dXJuIChhLmxlZnQgPD0gYi5yaWdodCAmJlxuICAgICAgICAgICAgYi5sZWZ0IDw9IGEucmlnaHQgJiZcbiAgICAgICAgICAgIGEudG9wIDw9IGIuYm90dG9tICYmXG4gICAgICAgICAgICBiLnRvcCA8PSBhLmJvdHRvbSk7XG4gICAgfVxufVxuIiwiaW1wb3J0IERvbUVsZW1lbnQgZnJvbSBcIi4uL2hlbHBlcnMvZG9tZWxlbWVudFwiO1xuaW1wb3J0IFV0aWxzIGZyb20gXCIuLi9oZWxwZXJzL3V0aWxzXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEJsb2NrIGV4dGVuZHMgRG9tRWxlbWVudCB7XG4gICAgcHJpdmF0ZSByZWFkb25seSBzcGVlZDogbnVtYmVyO1xuICAgIHByaXZhdGUgcmVhZG9ubHkgd2lkdGg6IG51bWJlcjtcbiAgICBwcml2YXRlIHJlYWRvbmx5IGhlaWdodDogbnVtYmVyO1xuICAgIHB1YmxpYyBjb2xvcjogc3RyaW5nO1xuICAgIHByaXZhdGUgZGVzdGluYXRpb24gPSB7eDogMCwgeTogMH07XG5cbiAgICBjb25zdHJ1Y3Rvcihjb2xvcjogc3RyaW5nLCBzcGVlZDogbnVtYmVyLCB3aWR0aDogbnVtYmVyLCBoZWlnaHQ6IG51bWJlcikge1xuICAgICAgICBzdXBlcignYmxvY2snLCAwLCAwLCAnbGV2ZWwnKTtcblxuICAgICAgICB0aGlzLnNwZWVkID0gc3BlZWQ7XG4gICAgICAgIHRoaXMud2lkdGggPSB3aWR0aDtcbiAgICAgICAgdGhpcy5oZWlnaHQgPSBoZWlnaHQ7XG4gICAgICAgIHRoaXMuY29sb3IgPSBjb2xvcjtcblxuICAgICAgICB0aGlzLmVsLnN0eWxlLmJhY2tncm91bmRJbWFnZSA9IGByZXBlYXRpbmctbGluZWFyLWdyYWRpZW50KCR7VXRpbHMuZ2V0UmFuZG9tSW50KDAsMzYwKX1kZWcsICMwMDAwMDAsICMwMDAwMDAgJHtVdGlscy5nZXRSYW5kb21JbnQoMiwxMCl9cHgsICR7dGhpcy5jb2xvcn0gMTBweCwgJHt0aGlzLmNvbG9yfSAke1V0aWxzLmdldFJhbmRvbUludCgyMCw0MCl9cHgpYDtcbiAgICAgICAgdGhpcy5lbC5zdHlsZS53aWR0aCA9IGAke3RoaXMud2lkdGh9cHhgO1xuICAgICAgICB0aGlzLmVsLnN0eWxlLmhlaWdodCA9IGAke3RoaXMuaGVpZ2h0fXB4YDtcblxuICAgICAgICB0aGlzLnggPSBVdGlscy5nZXRSYW5kb21JbnQoMCwgKHdpbmRvdy5vdXRlcldpZHRoIC0gdGhpcy53aWR0aCkpO1xuICAgICAgICB0aGlzLnkgPSBVdGlscy5nZXRSYW5kb21JbnQoMCwgKGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRIZWlnaHQgLSB0aGlzLmhlaWdodCkpO1xuICAgICAgICB0aGlzLmVsLnN0eWxlLnRyYW5zZm9ybSA9IGB0cmFuc2xhdGUoJHt0aGlzLnh9cHgsICR7dGhpcy55fXB4KWA7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogSGFuZGxlciBmb3IgY2xpY2tpbmcgdGhlIGJsb2Nrc1xuICAgICAqL1xuICAgIHB1YmxpYyBkZXN0cm95KCkge1xuICAgICAgICB0aGlzLmVsLnJlbW92ZSgpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIE1haW4gdXBkYXRlIGhhbmRsZXIgZm9yIHRoZSBnYW1lIGZvciBtb3Zpbmcgb3VyIGJsb2NrIHJhbmRvbWx5IG92ZXIgdGhlIHNjcmVlblxuICAgICAqL1xuICAgIHB1YmxpYyB1cGRhdGUoKSB7XG4gICAgICAgIGlmICh0aGlzLnggPiAodGhpcy5kZXN0aW5hdGlvbi54IC0gdGhpcy5zcGVlZCkgJiYgdGhpcy54IDwgKHRoaXMuZGVzdGluYXRpb24ueCArIHRoaXMuc3BlZWQpKSB7XG4gICAgICAgICAgICB0aGlzLmRlc3RpbmF0aW9uLnggPSBVdGlscy5nZXRSYW5kb21JbnQoMCwgKHdpbmRvdy5vdXRlcldpZHRoIC0gdGhpcy53aWR0aCkpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnkgPiAodGhpcy5kZXN0aW5hdGlvbi55IC0gdGhpcy5zcGVlZCkgJiYgdGhpcy55IDwgKHRoaXMuZGVzdGluYXRpb24ueSArIHRoaXMuc3BlZWQpKSB7XG4gICAgICAgICAgICB0aGlzLmRlc3RpbmF0aW9uLnkgPSBVdGlscy5nZXRSYW5kb21JbnQoMCwgKGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRIZWlnaHQgLSB0aGlzLmhlaWdodCkpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHRoaXMuZGVzdGluYXRpb24ueCA+PSB0aGlzLngpIHtcbiAgICAgICAgICAgIHRoaXMueCArPSB0aGlzLnNwZWVkO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy54IC09IHRoaXMuc3BlZWQ7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGhpcy5kZXN0aW5hdGlvbi55ID49IHRoaXMueSkge1xuICAgICAgICAgICAgdGhpcy55ICs9IHRoaXMuc3BlZWQ7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnkgLT0gdGhpcy5zcGVlZDtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuZWwuc3R5bGUudHJhbnNmb3JtID0gYHRyYW5zbGF0ZSgke3RoaXMueH1weCwgJHt0aGlzLnl9cHgpYDtcbiAgICB9XG59XG4iLCJpbXBvcnQgY29uZmlnIGZyb20gJy4uL2NvbmZpZy5qc29uJztcbmltcG9ydCBEb21FbGVtZW50IGZyb20gXCIuLi9oZWxwZXJzL2RvbWVsZW1lbnRcIjtcbmltcG9ydCBCbG9jayBmcm9tIFwiLi9ibG9ja1wiO1xuaW1wb3J0IFdpbmRvd0V2ZW50SGFuZGxlciBmcm9tIFwiLi4vaGVscGVycy93aW5kb3dldmVudGhhbmRsZXJcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUGxheWVyIGV4dGVuZHMgRG9tRWxlbWVudCB7XG4gICAgcHJpdmF0ZSBoZWlnaHQ6IG51bWJlciA9IDEwO1xuICAgIHByaXZhdGUgd2lkdGg6IG51bWJlciA9IDEwO1xuICAgIHByaXZhdGUgZ3Jvd3RoRmFjdG9yOiBudW1iZXIgPSBjb25maWcuZ2FtZS5wbGF5ZXIuZ3Jvd3RoRmFjdG9yO1xuICAgIHByaXZhdGUgc3BlZWQ6IG51bWJlciA9IGNvbmZpZy5nYW1lLnBsYXllci5zcGVlZDtcbiAgICBwcml2YXRlIHNwZWVkSW5jcmVhc2VGYWN0b3I6IG51bWJlciA9IGNvbmZpZy5nYW1lLnBsYXllci5zcGVlZEluY3JlYXNlRmFjdG9yO1xuICAgIHByaXZhdGUga2V5c0FsbG93ZWQ6IHN0cmluZ1tdID0gWydhcnJvd2xlZnQnLCAnYXJyb3d1cCcsICdhcnJvd3JpZ2h0JywgJ2Fycm93ZG93biddO1xuICAgIHByaXZhdGUga2V5c1ByZXNzZWQ6IHN0cmluZ1tdID0gW107XG5cbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgc3VwZXIoJ3BsYXllcicsIDAsIDAsICdsZXZlbCcpO1xuICAgICAgICB0aGlzLnggPSB3aW5kb3cub3V0ZXJXaWR0aCAvIDIgLSB0aGlzLndpZHRoIC8gMjtcbiAgICAgICAgdGhpcy55ID0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudEhlaWdodCAvIDIgLSB0aGlzLmhlaWdodCAvIDI7XG5cbiAgICAgICAgdGhpcy5lbC5zdHlsZS53aWR0aCA9IGAke3RoaXMud2lkdGh9cHhgO1xuICAgICAgICB0aGlzLmVsLnN0eWxlLmhlaWdodCA9IGAke3RoaXMuaGVpZ2h0fXB4YDtcbiAgICAgICAgdGhpcy5lbC5zdHlsZS5ib3JkZXJSYWRpdXMgPSBgJHt0aGlzLndpZHRofXB4YDtcblxuICAgICAgICBXaW5kb3dFdmVudEhhbmRsZXIuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bi5wbGF5ZXInLCAoZTogS2V5Ym9hcmRFdmVudCkgPT4gdGhpcy5rZXlEb3duSGFuZGxlcihlKSk7XG4gICAgICAgIFdpbmRvd0V2ZW50SGFuZGxlci5hZGRFdmVudExpc3RlbmVyKCdrZXl1cC5wbGF5ZXInLCAoZTogS2V5Ym9hcmRFdmVudCkgPT4gdGhpcy5rZXlVcEhhbmRsZXIoZSkpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEtleSBkb3duIGhhbmRsZXIgZm9yIG1vdmluZyB0aGUgcGxheWVyXG4gICAgICpcbiAgICAgKiBAcGFyYW0gZVxuICAgICAqL1xuICAgIHByaXZhdGUga2V5RG93bkhhbmRsZXIoZTogS2V5Ym9hcmRFdmVudCkge1xuICAgICAgICBsZXQga2V5ID0gZS5rZXkudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgaWYgKHRoaXMua2V5c0FsbG93ZWQuaW5kZXhPZihrZXkpID4gLTEgJiYgdGhpcy5rZXlzUHJlc3NlZC5pbmRleE9mKGtleSkgPT09IC0xKSB7XG4gICAgICAgICAgICB0aGlzLmtleXNQcmVzc2VkLnB1c2goa2V5KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEtleSBkb3duIGhhbmRsZXIgZm9yIG1vdmluZyB0aGUgcGxheWVyXG4gICAgICpcbiAgICAgKiBAcGFyYW0gZVxuICAgICAqL1xuICAgIHByaXZhdGUga2V5VXBIYW5kbGVyKGU6IEtleWJvYXJkRXZlbnQpIHtcbiAgICAgICAgbGV0IGtleSA9IGUua2V5LnRvTG93ZXJDYXNlKCk7XG4gICAgICAgIGxldCBrZXlQcmVzc2VkUG9zaXRpb24gPSB0aGlzLmtleXNQcmVzc2VkLmluZGV4T2Yoa2V5KTtcbiAgICAgICAgaWYgKHRoaXMua2V5c0FsbG93ZWQuaW5kZXhPZihrZXkpID4gLTEgJiYga2V5UHJlc3NlZFBvc2l0aW9uID4gLTEpIHtcbiAgICAgICAgICAgIHRoaXMua2V5c1ByZXNzZWQuc3BsaWNlKGtleVByZXNzZWRQb3NpdGlvbiwgMSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBVcGRhdGUgdGhlIGFjdHVhbCBwb3NpdGlvbiBiYXNlZCBvbiBlYXJsaWVyIGV2ZW50c1xuICAgICAqL1xuICAgIHB1YmxpYyB1cGRhdGUoKSB7XG4gICAgICAgIHRoaXMua2V5c1ByZXNzZWQuZm9yRWFjaCgoa2V5KSA9PiB7XG4gICAgICAgICAgICBzd2l0Y2ggKGtleSkge1xuICAgICAgICAgICAgICAgIGNhc2UgJ2Fycm93bGVmdCc6XG4gICAgICAgICAgICAgICAgICAgIHRoaXMueCAtPSB0aGlzLnNwZWVkO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgIGNhc2UgJ2Fycm93dXAnOlxuICAgICAgICAgICAgICAgICAgICB0aGlzLnkgLT0gdGhpcy5zcGVlZDtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICBjYXNlICdhcnJvd3JpZ2h0JzpcbiAgICAgICAgICAgICAgICAgICAgdGhpcy54ICs9IHRoaXMuc3BlZWQ7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgY2FzZSAnYXJyb3dkb3duJzpcbiAgICAgICAgICAgICAgICAgICAgdGhpcy55ICs9IHRoaXMuc3BlZWQ7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICAvL0NoZWNrcyB0byBzdGF5IGluIGJvdW5kc1xuICAgICAgICBpZiAodGhpcy54IDwgMCkge1xuICAgICAgICAgICAgdGhpcy54ID0gMDtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy55IDwgMCkge1xuICAgICAgICAgICAgdGhpcy55ID0gMDtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy54ID4gKHdpbmRvdy5vdXRlcldpZHRoIC0gdGhpcy53aWR0aCkpIHtcbiAgICAgICAgICAgIHRoaXMueCA9ICh3aW5kb3cub3V0ZXJXaWR0aCAtIHRoaXMud2lkdGgpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnkgPiAoZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudEhlaWdodCAtIHRoaXMuaGVpZ2h0KSkge1xuICAgICAgICAgICAgdGhpcy55ID0gKGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRIZWlnaHQgLSB0aGlzLmhlaWdodCk7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLmVsLnN0eWxlLnRyYW5zZm9ybSA9IGB0cmFuc2xhdGUoJHt0aGlzLnh9cHgsICR7dGhpcy55fXB4KWA7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVXBkYXRlIHBsYXllciB3aGVuIGEgYmxvY2sgZ290IGNhdWdodFxuICAgICAqXG4gICAgICogQHBhcmFtIGJsb2NrXG4gICAgICovXG4gICAgcHVibGljIGJsb2NrQ2F1Z2h0KGJsb2NrOiBCbG9jaykge1xuICAgICAgICB0aGlzLnNwZWVkICs9IHRoaXMuc3BlZWRJbmNyZWFzZUZhY3RvcjtcbiAgICAgICAgdGhpcy53aWR0aCArPSB0aGlzLmdyb3d0aEZhY3RvcjtcbiAgICAgICAgdGhpcy5oZWlnaHQgKz0gdGhpcy5ncm93dGhGYWN0b3I7XG5cbiAgICAgICAgdGhpcy5lbC5zdHlsZS5oZWlnaHQgPSBgJHt0aGlzLmhlaWdodH1weGA7XG4gICAgICAgIHRoaXMuZWwuc3R5bGUud2lkdGggPSBgJHt0aGlzLndpZHRofXB4YDtcbiAgICAgICAgdGhpcy5lbC5zdHlsZS5ib3JkZXJSYWRpdXMgPSBgJHt0aGlzLndpZHRofXB4YDtcbiAgICAgICAgdGhpcy5lbC5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBibG9jay5jb2xvcjtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDbGVhbiB1cCFcbiAgICAgKi9cbiAgICBwdWJsaWMgZGVzdHJveSgpIHtcbiAgICAgICAgV2luZG93RXZlbnRIYW5kbGVyLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2tleWRvd24ucGxheWVyJyk7XG4gICAgICAgIFdpbmRvd0V2ZW50SGFuZGxlci5yZW1vdmVFdmVudExpc3RlbmVyKCdrZXl1cC5wbGF5ZXInKTtcbiAgICB9XG59XG4iLCJpbXBvcnQgY29uZmlnIGZyb20gJy4uL2NvbmZpZy5qc29uJztcbmltcG9ydCBEb21FbGVtZW50IGZyb20gXCIuLi9oZWxwZXJzL2RvbWVsZW1lbnRcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgVGltZXIgZXh0ZW5kcyBEb21FbGVtZW50IHtcbiAgICBzZWNvbmRzOiBudW1iZXIgPSBjb25maWcuZ2FtZS5zZWNvbmRzUGVyTGV2ZWw7XG4gICAgaW50ZXJ2YWxJZDogbnVtYmVyO1xuXG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHN1cGVyKCd0aW1lcicsIC0xLCAtMSwgJ2xldmVsJyk7XG5cbiAgICAgICAgdGhpcy5yZW5kZXJUZW1wbGF0ZSgpO1xuICAgICAgICB0aGlzLmVsLmNsYXNzTGlzdC5hZGQoJ21lc3NhZ2UnLCAnaXMtcHJpbWFyeScpO1xuICAgICAgICB0aGlzLmVsLnF1ZXJ5U2VsZWN0b3IoJy5zZWNvbmRzJykuaW5uZXJIVE1MID0gdGhpcy5zZWNvbmRzLnRvU3RyaW5nKCk7XG5cbiAgICAgICAgdGhpcy5pbnRlcnZhbElkID0gc2V0SW50ZXJ2YWwoKCkgPT4gdGhpcy51cGRhdGUoKSwgMTAwMCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ291bnRkb3duIG9mIHNlY29uZHNcbiAgICAgKi9cbiAgICBwcml2YXRlIHVwZGF0ZSgpIHtcbiAgICAgICAgdGhpcy5zZWNvbmRzLS07XG4gICAgICAgIHRoaXMuZWwucXVlcnlTZWxlY3RvcignLnNlY29uZHMnKS5pbm5lckhUTUwgPSB0aGlzLnNlY29uZHMudG9TdHJpbmcoKTtcblxuICAgICAgICBpZiAodGhpcy5zZWNvbmRzIDw9IDMpIHtcbiAgICAgICAgICAgIHRoaXMuZWwuY2xhc3NMaXN0LnJlbW92ZSgnaXMtcHJpbWFyeScpO1xuICAgICAgICAgICAgdGhpcy5lbC5jbGFzc0xpc3QuYWRkKCdpcy1kYW5nZXInKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuZWwuY2xhc3NMaXN0LmFkZCgnaXMtcHJpbWFyeScpO1xuICAgICAgICAgICAgdGhpcy5lbC5jbGFzc0xpc3QucmVtb3ZlKCdpcy1kYW5nZXInKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0aGlzLnNlY29uZHMgPT09IDApIHtcbiAgICAgICAgICAgIHdpbmRvdy5kaXNwYXRjaEV2ZW50KG5ldyBFdmVudCgndGltZXI6ZG9uZScpKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHB1YmxpYyBkZXN0cm95KCkge1xuICAgICAgICBjbGVhckludGVydmFsKHRoaXMuaW50ZXJ2YWxJZCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVGVtcGxhdGUgbmVlZGVkIHRvIHNob3cgbW9yZSBlbGVtZW50c1xuICAgICAqL1xuICAgIHByaXZhdGUgcmVuZGVyVGVtcGxhdGUoKSB7XG4gICAgICAgIHRoaXMuZWwuaW5uZXJIVE1MID0gYFxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cIm1lc3NhZ2UtYm9keVwiPlxuICAgICAgICAgICAgICAgIDxzcGFuPnRpbWU6IDwvc3Bhbj5cbiAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz1cInNlY29uZHNcIj48L3NwYW4+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgYDtcbiAgICB9XG59XG4iLCJpbXBvcnQgY29uZmlnIGZyb20gJy4uL2NvbmZpZy5qc29uJztcbmltcG9ydCBEb21FbGVtZW50IGZyb20gXCIuLi9oZWxwZXJzL2RvbWVsZW1lbnRcIjtcbmltcG9ydCBCbG9jayBmcm9tIFwiLi9ibG9ja1wiO1xuaW1wb3J0IFBsYXllciBmcm9tIFwiLi9wbGF5ZXJcIjtcbmltcG9ydCBUaW1lciBmcm9tIFwiLi90aW1lclwiO1xuaW1wb3J0IFV0aWxzIGZyb20gXCIuLi9oZWxwZXJzL3V0aWxzXCI7XG5pbXBvcnQgV2luZG93RXZlbnRIYW5kbGVyIGZyb20gXCIuLi9oZWxwZXJzL3dpbmRvd2V2ZW50aGFuZGxlclwiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBMZXZlbCBleHRlbmRzIERvbUVsZW1lbnQge1xuICAgIHByaXZhdGUgcmVhZG9ubHkgdG90YWxCbG9ja3M6IG51bWJlcjtcbiAgICBwcml2YXRlIHJlYWRvbmx5IHNjb3JlUGVyQmxvY2s6IG51bWJlcjtcbiAgICBwcml2YXRlIGJsb2NrczogQmxvY2tbXSA9IFtdO1xuICAgIHByaXZhdGUgcGxheWVyOiBQbGF5ZXI7XG4gICAgcHJpdmF0ZSB0aW1lcjogVGltZXI7XG4gICAgcHVibGljIGZhaWxlZCA9IGZhbHNlO1xuXG4gICAgY29uc3RydWN0b3IodG90YWxCbG9ja3M6IG51bWJlciwgc2NvcmVQZXJCbG9jazogbnVtYmVyKSB7XG4gICAgICAgIHN1cGVyKCdsZXZlbCcsIDAsIDApO1xuXG4gICAgICAgIHRoaXMudG90YWxCbG9ja3MgPSB0b3RhbEJsb2NrcztcbiAgICAgICAgdGhpcy5zY29yZVBlckJsb2NrID0gc2NvcmVQZXJCbG9jaztcbiAgICAgICAgdGhpcy5wbGF5ZXIgPSBuZXcgUGxheWVyKCk7XG4gICAgICAgIHRoaXMudGltZXIgPSBuZXcgVGltZXIoKTtcblxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMudG90YWxCbG9ja3M7IGkrKykge1xuICAgICAgICAgICAgdGhpcy5ibG9ja3MucHVzaChuZXcgQmxvY2soVXRpbHMuZ2V0UmFuZG9tQ29sb3IoKSwgVXRpbHMuZ2V0UmFuZG9tSW50KGNvbmZpZy5nYW1lLmJsb2NrU3BlZWQubWluLCBjb25maWcuZ2FtZS5ibG9ja1NwZWVkLm1heCksIFV0aWxzLmdldFJhbmRvbUludChjb25maWcuZ2FtZS5ibG9ja1BpeGVscy5taW4sIGNvbmZpZy5nYW1lLmJsb2NrUGl4ZWxzLm1heCksIFV0aWxzLmdldFJhbmRvbUludChjb25maWcuZ2FtZS5ibG9ja1BpeGVscy5taW4sIGNvbmZpZy5nYW1lLmJsb2NrUGl4ZWxzLm1heCkpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIFdpbmRvd0V2ZW50SGFuZGxlci5hZGRFdmVudExpc3RlbmVyKCd0aW1lcjpkb25lJywgKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5mYWlsZWQgPSB0cnVlO1xuICAgICAgICAgICAgdGhpcy5kZXN0cm95KCdsZXZlbDpmYWlsZWQnKTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2hlY2tzIGZvciBjb2xsaXNpb24gYW5kIHBvdGVudGlhbCBzdWNjZXNzIG9mIHRoaXMgbGV2ZWxcbiAgICAgKi9cbiAgICBwdWJsaWMgdXBkYXRlKCkge1xuICAgICAgICB0aGlzLnBsYXllci51cGRhdGUoKTtcbiAgICAgICAgdGhpcy5ibG9ja3MuZm9yRWFjaCgoYmxvY2ssIGluZGV4KSA9PiB7XG4gICAgICAgICAgICBibG9jay51cGRhdGUoKTtcblxuICAgICAgICAgICAgaWYgKFV0aWxzLmNoZWNrQ29sbGlzaW9uKHRoaXMucGxheWVyLmdldENsaWVudFJlYWN0KCksIGJsb2NrLmdldENsaWVudFJlYWN0KCkpICYmIHRoaXMuZmFpbGVkID09PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgIHRoaXMucGxheWVyLmJsb2NrQ2F1Z2h0KGJsb2NrKTtcbiAgICAgICAgICAgICAgICBibG9jay5kZXN0cm95KCk7XG4gICAgICAgICAgICAgICAgdGhpcy5ibG9ja3Muc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgICAgICAgICAgICB3aW5kb3cuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoJ2xldmVsOnNjb3JlVXBkYXRlJywge2RldGFpbDoge3Njb3JlOiB0aGlzLnNjb3JlUGVyQmxvY2t9fSkpO1xuXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuYmxvY2tzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmRlc3Ryb3koJ2xldmVsOnN1Y2Nlc3MnKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIERlc3Ryb3kgb2JqZWN0ICYgdGltZXIgYW5kIHRyaWdnZXIgZXZlbnQgdG8gbm90aWZ5IHRoZSB3b3JsZCBhYm91dCB0aGUgc3RhdHVzIG9mIHRoaXMgbGV2ZWxcbiAgICAgKlxuICAgICAqIEBwYXJhbSBldmVudFR5cGVcbiAgICAgKi9cbiAgICBwcml2YXRlIGRlc3Ryb3koZXZlbnRUeXBlOiBzdHJpbmcpIHtcbiAgICAgICAgdGhpcy50aW1lci5kZXN0cm95KCk7XG4gICAgICAgIHRoaXMucGxheWVyLmRlc3Ryb3koKTtcbiAgICAgICAgdGhpcy5ibG9ja3MuZm9yRWFjaCgoYmxvY2ssIGluZGV4KSA9PiB7XG4gICAgICAgICAgICBibG9jay5kZXN0cm95KCk7XG4gICAgICAgICAgICB0aGlzLmJsb2Nrcy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICB9KTtcbiAgICAgICAgV2luZG93RXZlbnRIYW5kbGVyLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3RpbWVyOmRvbmUnKTtcbiAgICAgICAgd2luZG93LmRpc3BhdGNoRXZlbnQobmV3IEV2ZW50KGV2ZW50VHlwZSkpO1xuICAgICAgICB0aGlzLmVsLnJlbW92ZSgpO1xuICAgIH1cbn1cbiIsImltcG9ydCBHYW1lIGZyb20gJy4vZ2FtZSc7XG5cbndpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwibG9hZFwiLCAoKSA9PiBuZXcgR2FtZSgpKTtcbiIsImltcG9ydCBjb25maWcgZnJvbSAnLi9jb25maWcuanNvbic7XG5pbXBvcnQgR1VJIGZyb20gJy4vZ3VpL2d1aSc7XG5pbXBvcnQgTGV2ZWwgZnJvbSBcIi4vbGV2ZWwvbGV2ZWxcIjtcbmltcG9ydCBEYXRhU2VydmljZSBmcm9tIFwiLi9kYXRhc2VydmljZVwiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBHYW1lIHtcbiAgICBwcml2YXRlIGxldmVsITogTGV2ZWw7XG4gICAgcHJpdmF0ZSBsZXZlbHNQZXJHYW1lOiBudW1iZXIgPSBjb25maWcuZ2FtZS5sZXZlbHNQZXJHYW1lO1xuICAgIHByaXZhdGUgY3VycmVudExldmVsc1BsYXllZDogbnVtYmVyID0gMDtcbiAgICBwcml2YXRlIHN0YXJ0RWxlbWVudHNQZXJMZXZlbDogbnVtYmVyID0gY29uZmlnLmdhbWUuc3RhcnRFbGVtZW50c1BlckxldmVsO1xuICAgIHByaXZhdGUgZWxlbWVudHNJbmNyZWFzZVBlckxldmVsOiBudW1iZXIgPSBjb25maWcuZ2FtZS5lbGVtZW50c0luY3JlYXNlUGVyTGV2ZWw7XG4gICAgcHJpdmF0ZSBzY29yZVBlckVsZW1lbnQ6IG51bWJlciA9IGNvbmZpZy5nYW1lLnNjb3JlUGVyRWxlbWVudDtcbiAgICBwcml2YXRlIHJlYWRvbmx5IG1heFNjb3JlOiBudW1iZXI7XG4gICAgcHJpdmF0ZSBndWk6IEdVSTtcbiAgICBwcml2YXRlIGRhdGFTZXJ2aWNlOiBEYXRhU2VydmljZTtcblxuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICB0aGlzLmd1aSA9IG5ldyBHVUkoKTtcbiAgICAgICAgdGhpcy5tYXhTY29yZSA9IHRoaXMuY2FsY3VsYXRlTWF4U2NvcmUoKTtcbiAgICAgICAgdGhpcy5nYW1lTG9vcCgpO1xuICAgICAgICB0aGlzLmRhdGFTZXJ2aWNlID0gbmV3IERhdGFTZXJ2aWNlKCk7XG5cbiAgICAgICAgWydsZXZlbDpzdWNjZXNzJywgJ2xldmVsOmZhaWxlZCddLm1hcCgoZXZlbnRUeXBlKSA9PiB7XG4gICAgICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihldmVudFR5cGUsIChlKSA9PiB0aGlzLnVwZGF0ZShlLnR5cGUpKTtcbiAgICAgICAgfSk7XG4gICAgICAgIFsnZ2FtZTpzdGFydDpjbGljaycsICdsZXZlbDpzdWNjZXNzOmNsaWNrJywgJ2xldmVsOmZhaWxlZDpjbGljayddLm1hcCgoZXZlbnRUeXBlKSA9PiB7XG4gICAgICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihldmVudFR5cGUsICgpID0+IHRoaXMuc3RhcnROZXdMZXZlbCgpKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdnYW1lOmVuZDpjbGljaycsICgpID0+IHRoaXMucmVzdGFydCgpKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDYWxjdWxhdGUgdGhlIHNjb3JlIHdpdGggYXZhaWxhYmxlIHBhcmFtZXRlcnNcbiAgICAgKlxuICAgICAqIEB0b2RvIERvIEkgcmVhbGx5IG5lZWQgdG8gdG8gdGhpcyBzbyBpbmVmZmljaWVudC4uP1xuICAgICAqIEByZXR1cm5zIHtudW1iZXJ9XG4gICAgICovXG4gICAgcHJpdmF0ZSBjYWxjdWxhdGVNYXhTY29yZSgpIHtcbiAgICAgICAgbGV0IG1heFNjb3JlID0gMDtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmxldmVsc1BlckdhbWU7IGkrKykge1xuICAgICAgICAgICAgbGV0IGVsZW1lbnRzID0gdGhpcy5zdGFydEVsZW1lbnRzUGVyTGV2ZWwgKyAoaSA9PT0gMCA/IDAgOiAodGhpcy5lbGVtZW50c0luY3JlYXNlUGVyTGV2ZWwgKiBpKSk7XG4gICAgICAgICAgICBtYXhTY29yZSArPSAoZWxlbWVudHMgKiB0aGlzLnNjb3JlUGVyRWxlbWVudCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG1heFNjb3JlO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRoZSBvbmx5IHBsYWNlIGZvciBhIHJlcXVlc3RBbmltYXRpb25GcmFtZVxuICAgICAqL1xuICAgIHByaXZhdGUgZ2FtZUxvb3AoKSB7XG4gICAgICAgIGlmICh0eXBlb2YgdGhpcy5sZXZlbCAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgIHRoaXMubGV2ZWwudXBkYXRlKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKCgpID0+IHRoaXMuZ2FtZUxvb3AoKSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVXBkYXRlIHRoZSBnYW1lIGJ5IGVpdGhlciB0aGUgZW5kIG9yIGFueXRoaW5nIGluIGJldHdlZW4gbGV2ZWxzXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gdHlwZVxuICAgICAqL1xuICAgIHByaXZhdGUgdXBkYXRlKHR5cGU6IHN0cmluZykge1xuICAgICAgICB0aGlzLmN1cnJlbnRMZXZlbHNQbGF5ZWQrKztcbiAgICAgICAgaWYgKHRoaXMuY3VycmVudExldmVsc1BsYXllZCA9PT0gdGhpcy5sZXZlbHNQZXJHYW1lKSB7XG4gICAgICAgICAgICB0aGlzLmd1aS5nYW1lRW5kKHRoaXMubWF4U2NvcmUpO1xuICAgICAgICAgICAgdGhpcy5zYXZlU2NvcmUoKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuZ3VpLmxldmVsRG9uZSh0eXBlKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUaW1lIHRvIHN0YXJ0IGEgbmV3IGxldmVsIHdpdGggbWFkbmVzc1xuICAgICAqL1xuICAgIHByaXZhdGUgc3RhcnROZXdMZXZlbCgpIHtcbiAgICAgICAgaWYgKHRoaXMubGV2ZWwgJiYgdGhpcy5sZXZlbC5mYWlsZWQgPT09IGZhbHNlKSB7XG4gICAgICAgICAgICB0aGlzLnN0YXJ0RWxlbWVudHNQZXJMZXZlbCArPSB0aGlzLmVsZW1lbnRzSW5jcmVhc2VQZXJMZXZlbDtcbiAgICAgICAgfVxuXG4gICAgICAgIGRlbGV0ZSB0aGlzLmxldmVsO1xuICAgICAgICB0aGlzLmd1aS5uZXdMZXZlbCgpO1xuXG4gICAgICAgIHRoaXMubGV2ZWwgPSBuZXcgTGV2ZWwodGhpcy5zdGFydEVsZW1lbnRzUGVyTGV2ZWwsIHRoaXMuc2NvcmVQZXJFbGVtZW50KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTdGFydCBldmVyeXRoaW5nIGZyb20gdGhlIGJlZ2lubmluZ1xuICAgICAqL1xuICAgIHByaXZhdGUgcmVzdGFydCgpIHtcbiAgICAgICAgdGhpcy5ndWkucmVzdGFydCgpO1xuICAgICAgICB0aGlzLmN1cnJlbnRMZXZlbHNQbGF5ZWQgPSAwO1xuICAgICAgICB0aGlzLnN0YXJ0RWxlbWVudHNQZXJMZXZlbCA9IGNvbmZpZy5nYW1lLnN0YXJ0RWxlbWVudHNQZXJMZXZlbDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDYWxsIHRoZSBkYXRhIHNlcnZpY2UgYW5kIGxldCBpdCBkbyBpdHMgbWFnaWNcbiAgICAgKi9cbiAgICBwcml2YXRlIHNhdmVTY29yZSgpIHtcbiAgICAgICAgbGV0IHNjb3JlID0gdGhpcy5ndWkuZ2V0U2NvcmUoKTtcbiAgICAgICAgdGhpcy5kYXRhU2VydmljZS5zYXZlU2NvcmUoc2NvcmUpLnRoZW4oKGRhdGEpID0+IHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdSZXNwb25zZSBhZnRlciBzYXZpbmcgc2NvcmUnLCBkYXRhKTtcbiAgICAgICAgfSk7XG4gICAgfVxufVxuIl0sInNvdXJjZVJvb3QiOiIifQ==